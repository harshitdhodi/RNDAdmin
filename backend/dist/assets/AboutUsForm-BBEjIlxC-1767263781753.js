import{a as A,f as D,dO as l,r as d,dP as V,dQ as N,dR as q,j as e,dk as T,dS as k,dT as m,be as b,as as S,dU as L,dV as P,dn as g}from"./index-6ENpBTB9-1767263781753.js";const M=()=>{const{id:n}=A(),p=D(),[r]=l.useForm(),[h,f]=d.useState([]),[E,u]=d.useState(""),[o,x]=d.useState(!1),{data:t,isLoading:U}=V(n),[I]=N(),[y]=q();d.useEffect(()=>{t&&(r.setFieldsValue({title:t.title,shortDescription:t.shortDescription,description:t.description,imageTitle:t.imageTitle,altName:t.altName,section:t.section,slug:t.slug}),u(t.slug),x(t.slug!==(t.section?t.section.toLowerCase().replace(/\s+/g,"-"):"")),t.image&&f([{uid:"-1",name:"Current Image",status:"done",url:`/api/image/download/${t.image}`}]))},[t,r]),d.useEffect(()=>{const s=r.getFieldValue("section");if(s&&!o){const i=s.toLowerCase().replace(/\s+/g,"-");u(i),r.setFieldsValue({slug:i})}},[r.getFieldValue("section"),o]);const j={toolbar:[[{header:[1,2,3,4,5,6,!1]}],["bold","italic","underline","strike"],[{list:"ordered"},{list:"bullet"}],[{color:[]},{background:[]}],[{align:["","center","right","justify"]}],["link","image"],["clean"]]},C=async s=>{var i,c;try{const a=new FormData;a.append("title",s.title),a.append("shortDescription",s.shortDescription),a.append("description",s.description),a.append("imageTitle",s.imageTitle),a.append("altName",s.altName),a.append("section",s.section),a.append("slug",s.slug),(i=h[0])!=null&&i.originFileObj&&a.append("image",h[0].originFileObj),n?(await y({id:n,formData:a}).unwrap(),g.success("About Us updated successfully")):(await I(a).unwrap(),g.success("About Us created successfully")),p("/about-us-table")}catch(a){const w=((c=a.data)==null?void 0:c.error)||`Failed to ${n?"update":"create"} About Us entry`;g.error(w)}},F={beforeUpload:s=>(s.type.startsWith("image/")||g.error("You can only upload image files!"),!1),onChange:({fileList:s})=>f(s),fileList:h};return U&&n?e.jsx(T,{size:"large"}):e.jsxs(e.Fragment,{children:[e.jsx(k,{items:[{title:"Dashboard",onClick:()=>p("/dashboard")},{title:"About Us",onClick:()=>p("/about-us-table")},{title:n?"Edit About Us":"Create About Us"}],className:"mb-[1rem]"}),e.jsxs(l,{form:r,layout:"vertical",onFinish:C,children:[e.jsx(l.Item,{name:"section",label:"Section",rules:[{required:!0,message:"Please input a section!"}],children:e.jsx(m,{placeholder:"Enter a section",onChange:s=>{const{value:i}=s.target;if(!o){const c=i.toLowerCase().replace(/\s+/g,"-");u(c),r.setFieldsValue({slug:c})}}})}),e.jsx(l.Item,{name:"slug",label:e.jsxs("span",{children:["Slug",e.jsx(b,{type:"link",size:"small",onClick:()=>{if(x(!o),o){const i=(r.getFieldValue("section")||"").toLowerCase().replace(/\s+/g,"-");u(i),r.setFieldsValue({slug:i})}else{const s=r.getFieldValue("slug");u(s)}},className:"ml-2",children:o?"Use Auto Slug":"Customize Slug"})]}),rules:[{required:!0,message:"Slug is required!"},{pattern:/^[a-z0-9]+(?:-[a-z0-9]+)*$/,message:"Slug can only contain lowercase letters, numbers, and hyphens"}],children:e.jsx(m,{disabled:!o,onChange:s=>{o&&u(s.target.value)}})}),e.jsx(l.Item,{name:"title",label:"Title",rules:[{required:!1,message:"Please input the title!"}],children:e.jsx(m,{})}),e.jsx(l.Item,{name:"shortDescription",label:"Short Description",rules:[{required:!1,message:"Please input the short description!"}],children:e.jsx(S,{modules:j,theme:"snow",className:"custom-quill-editor h-[150px] mb-[50px]"})}),e.jsx(l.Item,{name:"description",label:"Description",rules:[{required:!1,message:"Please input the description!"}],children:e.jsx(S,{modules:j,theme:"snow",className:"custom-quill-editor h-[600px] mb-[50px]"})}),e.jsx(l.Item,{label:"Image",children:e.jsx(L,{...F,listType:"picture",children:e.jsx(b,{icon:e.jsx(P,{}),children:n?"Change Image":"Click to Upload"})})}),e.jsx(l.Item,{name:"imageTitle",label:"Image Title",rules:[{required:!1,message:"Please input the image title!"}],children:e.jsx(m,{})}),e.jsx(l.Item,{name:"altName",label:"Alt Name",rules:[{required:!1,message:"Please input the alt name!"}],children:e.jsx(m,{})}),e.jsx(l.Item,{children:e.jsx(b,{type:"primary",htmlType:"submit",children:n?"Update":"Submit"})})]})]})};export{M as default};
