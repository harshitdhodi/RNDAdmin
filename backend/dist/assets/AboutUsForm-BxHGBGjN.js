import{by as e,bz as s,bA as i,j as a,bp as t,B as r,I as l,L as n}from"./main-BcUd3ASm.js";import{g as o,d as c,r as d}from"./vendor-router-CaZtIe2_.js";import{b as m}from"./index.esm-CJw2PcRb.js";import{C as u,b as j,c as h,a as x}from"./card-DKPCnjx_.js";import{F as p,a as g,b as f,c as b,d as v,e as N}from"./form-ChijvnbD.js";import{S as w,a as C,b as y,c as S,d as U}from"./select-Dc7LnXRO.js";import{B as D,b as L,d as A}from"./breadcrumb-DEvmmGzh.js";import{B as k}from"./react-toastify.esm-CrOn1nFw.js";import{R as V}from"./index-BEyUZcsN.js";/* empty css                   */import{U as I}from"./upload-CioWvAMz.js";import{L as T}from"./loader-circle-Bvow6UU1.js";import"./vendor-react-DD_RYU77.js";import"./vendor-utils-CfKmydC0.js";import"./index-CMYgmcqM.js";import"./index-BY97PVuz.js";import"./check-CxfHQWmE.js";import"./chevron-up-BAx2OvKy.js";import"./chevron-right-C95tp0e6.js";import"./isEqual-DwlFmuh_.js";const z=()=>{const{id:z}=o(),E=c(),[F,q]=d.useState([]),[R,M]=d.useState(""),[$,B]=d.useState(!1),J=m({defaultValues:{title:"",shortDescription:"",description:"",imageTitle:"",altName:"",section:"",slug:""}}),{data:K,isLoading:O}=e(z,{skip:!z}),[P,{isLoading:Q}]=s(),[W,{isLoading:Y}]=i(),Z=Q||Y;d.useEffect((()=>{K&&(J.reset({title:K.title,shortDescription:K.shortDescription,description:K.description,imageTitle:K.imageTitle,altName:K.altName,section:K.section,slug:K.slug}),M(K.slug),B(K.slug!==K.section.toLowerCase().replace(/\s+/g,"-")),K.image&&q([{id:K.image,name:"Current Image",preview:`/api/image/download/${K.image}`}]))}),[K,J]),d.useEffect((()=>{const e=J.watch("section");if(e&&!$){const s=e.toLowerCase().replace(/\s+/g,"-");M(s),J.setValue("slug",s)}}),[J.watch("section"),$,J]);const _={toolbar:[[{header:[1,2,3,4,5,6,!1]}],["bold","italic","underline","strike"],[{list:"ordered"},{list:"bullet"}],[{color:[]},{background:[]}],[{align:["","center","right","justify"]}],["link","image"],["clean"]]};return O&&z?a.jsx("div",{className:"flex justify-center items-center h-64",children:a.jsx(t,{className:"w-8 h-8"})}):a.jsxs(u,{className:"max-w-4xl mx-auto",children:[a.jsxs(j,{children:[a.jsx("div",{className:"mb-4",children:a.jsxs(D,{children:[a.jsx(L,{children:a.jsx(A,{onClick:()=>E("/dashboard"),children:"Dashboard"})}),a.jsx(L,{children:a.jsx(A,{onClick:()=>E("/about-us-table"),children:"About Us"})}),a.jsx(L,{children:a.jsx(A,{children:z?"Edit About Us":"Create About Us"})})]})}),a.jsx(h,{children:z?"Edit About Us":"Create About Us"})]}),a.jsx(x,{children:a.jsx(p,{...J,children:a.jsxs("form",{onSubmit:J.handleSubmit((async e=>{try{const s=new FormData;s.append("title",e.title),s.append("shortDescription",e.shortDescription),s.append("description",e.description),s.append("imageTitle",e.imageTitle),s.append("altName",e.altName),s.append("section",e.section),s.append("slug",e.slug),F[0]?.file&&s.append("image",F[0].file),z?(await W({id:z,formData:s}).unwrap(),k({title:"Success",description:"About Us updated successfully"})):(await P(s).unwrap(),k({title:"Success",description:"About Us created successfully"})),E("/about-us-table")}catch(s){const e=s.data?.error||`Failed to ${z?"update":"create"} About Us entry`;k({title:"Error",description:e,variant:"destructive"})}})),className:"space-y-6",children:[a.jsx(g,{control:J.control,name:"section",render:({field:e})=>a.jsxs(f,{children:[a.jsx(b,{children:"Section"}),a.jsxs(w,{onValueChange:s=>{if(e.onChange(s),!$){const e=s.toLowerCase().replace(/\s+/g,"-");M(e),J.setValue("slug",e)}},defaultValue:e.value,children:[a.jsx(v,{children:a.jsx(C,{children:a.jsx(y,{placeholder:"Select a section"})})}),a.jsxs(S,{children:[a.jsx(U,{value:"Introduction",children:"Introduction"}),a.jsx(U,{value:"Mission Vision",children:"Mission Vision"})]})]}),a.jsx(N,{})]})}),a.jsx(g,{control:J.control,name:"slug",rules:{required:"Slug is required",pattern:{value:/^[a-z0-9]+(?:-[a-z0-9]+)*$/,message:"Slug can only contain lowercase letters, numbers, and hyphens"}},render:({field:e})=>a.jsxs(f,{children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx(b,{children:"Slug"}),a.jsx(r,{variant:"outline",size:"sm",type:"button",onClick:()=>{if(B(!$),$){const e=J.getValues("section");if(e){const s=e.toLowerCase().replace(/\s+/g,"-");M(s),J.setValue("slug",s)}}else{const e=J.getValues("slug");M(e)}},children:$?"Use Auto Slug":"Customize Slug"})]}),a.jsx(v,{children:a.jsx(l,{...e,disabled:!$,onChange:s=>{e.onChange(s.target.value),$&&M(s.target.value)}})}),a.jsx(N,{})]})}),a.jsx(g,{control:J.control,name:"title",render:({field:e})=>a.jsxs(f,{children:[a.jsx(b,{children:"Title"}),a.jsx(v,{children:a.jsx(l,{...e})}),a.jsx(N,{})]})}),a.jsx(g,{control:J.control,name:"shortDescription",render:({field:e})=>a.jsxs(f,{children:[a.jsx(b,{children:"Short Description"}),a.jsx(v,{children:a.jsx("div",{className:"mb-12",children:a.jsx(V,{modules:_,theme:"snow",value:e.value,onChange:e.onChange,className:"h-32"})})}),a.jsx(N,{})]})}),a.jsx(g,{control:J.control,name:"description",render:({field:e})=>a.jsxs(f,{children:[a.jsx(b,{children:"Description"}),a.jsx(v,{children:a.jsx("div",{className:"mb-12",children:a.jsx(V,{modules:_,theme:"snow",value:e.value,onChange:e.onChange,className:"h-64"})})}),a.jsx(N,{})]})}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(n,{htmlFor:"image",children:"Image"}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsxs(n,{htmlFor:"image-upload",className:"cursor-pointer flex items-center gap-2 border rounded-md px-3 py-2 hover:bg-gray-100",children:[a.jsx(I,{className:"w-4 h-4"}),a.jsx("span",{children:z?"Change Image":"Click to Upload"})]}),a.jsx("input",{id:"image-upload",type:"file",accept:"image/*",className:"hidden",onChange:e=>{const s=e.target.files[0];s&&(s.type.startsWith("image/")?q([{id:Date.now().toString(),name:s.name,file:s,preview:URL.createObjectURL(s)}]):k({title:"Invalid file",description:"You can only upload image files!",variant:"destructive"}))}})]}),F.length>0&&a.jsx("div",{className:"mt-2 flex items-center gap-2",children:a.jsxs("div",{className:"relative border rounded-md p-2 flex items-center",children:[a.jsx("img",{src:F[0].preview,alt:"Preview",className:"h-12 w-auto object-contain"}),a.jsxs("div",{className:"ml-2",children:[a.jsx("p",{className:"text-sm font-medium",children:F[0].name}),a.jsx(r,{variant:"ghost",size:"sm",onClick:()=>{q([])},className:"text-xs text-red-600",children:"Remove"})]})]})})]}),a.jsx(g,{control:J.control,name:"imageTitle",render:({field:e})=>a.jsxs(f,{children:[a.jsx(b,{children:"Image Title"}),a.jsx(v,{children:a.jsx(l,{...e})}),a.jsx(N,{})]})}),a.jsx(g,{control:J.control,name:"altName",render:({field:e})=>a.jsxs(f,{children:[a.jsx(b,{children:"Alt Name"}),a.jsx(v,{children:a.jsx(l,{...e})}),a.jsx(N,{})]})}),a.jsxs(r,{type:"submit",disabled:Z,className:"w-full sm:w-auto",children:[Z&&a.jsx(T,{className:"mr-2 h-4 w-4 animate-spin"}),z?"Update":"Submit"]})]})})})]})};export{z as default};
//# sourceMappingURL=AboutUsForm-BxHGBGjN.js.map
