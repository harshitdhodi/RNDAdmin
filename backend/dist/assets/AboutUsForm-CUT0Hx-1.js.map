{"version":3,"file":"AboutUsForm-CUT0Hx-1.js","sources":["../../src/websiteBackend/aboutus/AboutUsForm.jsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { Form, Input, Button, Upload, message, Breadcrumb, Spin, Select } from 'antd';\nimport { UploadOutlined } from '@ant-design/icons';\nimport ReactQuill from 'react-quill';\nimport 'react-quill/dist/quill.snow.css';\nimport { \n  useCreateAboutUsMutation, \n  useUpdateAboutUsMutation,\n  useGetAboutUsByIdQuery \n} from '../../slice/aboutUs/aboutUs';\nimport { useNavigate, useParams } from 'react-router-dom';\n\nconst AboutUsForm = () => {\n  const { id } = useParams(); // Get ID from URL\n  const navigate = useNavigate();\n  const [form] = Form.useForm();\n  const [fileList, setFileList] = useState([]);\n  const [autoSlug, setAutoSlug] = useState('');\n  const [isCustomSlug, setIsCustomSlug] = useState(false);\n\n  // Fetch data if ID exists\n  const { \n    data: aboutUsData, \n    isLoading: isLoadingData \n  } = useGetAboutUsByIdQuery(id);\n\n  const [createAboutUs] = useCreateAboutUsMutation();\n  const [updateAboutUs] = useUpdateAboutUsMutation();\n\n  // Set form values when data is fetched\n  useEffect(() => {\n    if (aboutUsData) {\n      form.setFieldsValue({\n        title: aboutUsData.title,\n        shortDescription: aboutUsData.shortDescription,\n        description: aboutUsData.description,\n        imageTitle: aboutUsData.imageTitle,\n        altName: aboutUsData.altName,\n        section: aboutUsData.section,\n        slug: aboutUsData.slug,\n      });\n      setAutoSlug(aboutUsData.slug);\n      setIsCustomSlug(aboutUsData.slug !== aboutUsData.section.toLowerCase().replace(/\\s+/g, '-'));\n\n      // Set existing image\n      if (aboutUsData.image) {\n        setFileList([{\n          uid: '-1',\n          name: 'Current Image',\n          status: 'done',\n          url: `/api/image/download/${aboutUsData.image}`,\n        }]);\n      }\n    }\n  }, [aboutUsData, form]);\n\n  // Add this effect to auto-generate slug when section changes\n  useEffect(() => {\n    const sectionValue = form.getFieldValue('section');\n    if (sectionValue && !isCustomSlug) {\n      const generatedSlug = sectionValue.toLowerCase().replace(/\\s+/g, '-');\n      setAutoSlug(generatedSlug);\n      form.setFieldsValue({ slug: generatedSlug });\n    }\n  }, [form.getFieldValue('section'), isCustomSlug]);\n\n  const modules = {\n    toolbar: [\n      [{ 'header': [1, 2, 3, 4, 5, 6, false] }],\n      ['bold', 'italic', 'underline', 'strike'],\n      [{ 'list': 'ordered'}, { 'list': 'bullet' }],\n      [{ 'color': [] }, { 'background': [] }],\n      [{ 'align': ['', 'center', 'right', 'justify'] }],\n      ['link', 'image'],\n      ['clean']\n    ]\n  };\n\n  const handleSubmit = async (values) => {\n    try {\n      const formData = new FormData();\n      formData.append('title', values.title);\n      formData.append('shortDescription', values.shortDescription);\n      formData.append('description', values.description);\n      formData.append('imageTitle', values.imageTitle);\n      formData.append('altName', values.altName);\n      formData.append('section', values.section);\n      formData.append('slug', values.slug);\n      \n      if (fileList[0]?.originFileObj) {\n        formData.append('image', fileList[0].originFileObj);\n      }\n\n      if (id) {\n        await updateAboutUs({ id, formData }).unwrap();\n        message.success('About Us updated successfully');\n      } else {\n        await createAboutUs(formData).unwrap();\n        message.success('About Us created successfully');\n      }\n\n      navigate('/about-us-table');\n    } catch (error) {\n      const errorMessage = error.data?.error || `Failed to ${id ? 'update' : 'create'} About Us entry`;\n      message.error(errorMessage);\n    }\n  };\n\n  const uploadProps = {\n    beforeUpload: (file) => {\n      const isImage = file.type.startsWith('image/');\n      if (!isImage) {\n        message.error('You can only upload image files!');\n        return false;\n      }\n      return false;\n    },\n    onChange: ({ fileList }) => setFileList(fileList),\n    fileList,\n  };\n\n  if (isLoadingData && id) {\n    return <Spin size=\"large\" />;\n  }\n\n  return (\n    <>\n      <Breadcrumb\n        items={[\n          { title: 'Dashboard', onClick: () => navigate('/dashboard') },\n          { title: 'About Us', onClick: () => navigate('/about-us-table') },\n          { title: id ? 'Edit About Us' : 'Create About Us' },\n        ]}\n        style={{ marginBottom: '1rem' }}\n      />\n      \n      <Form\n        form={form}\n        layout=\"vertical\"\n        onFinish={handleSubmit}\n      >\n        <Form.Item\n          name=\"section\"\n          label=\"Section\"\n          rules={[{ required: true, message: 'Please select a section!' }]}\n        >\n          <Select \n            placeholder=\"Select a section\"\n            onChange={(value) => {\n              if (!isCustomSlug) {\n                const newSlug = value.toLowerCase().replace(/\\s+/g, '-');\n                setAutoSlug(newSlug);\n                form.setFieldsValue({ slug: newSlug });\n              }\n            }}\n          >\n            <Select.Option value=\"Introduction\">Introduction</Select.Option>\n            <Select.Option value=\"Mission Vision\">Mission Vision</Select.Option>\n          </Select>\n        </Form.Item>\n\n        <Form.Item\n          name=\"slug\"\n          label={\n            <span>\n              Slug\n              <Button \n                type=\"link\" \n                size=\"small\" \n                onClick={() => {\n                  setIsCustomSlug(!isCustomSlug);\n                  if (!isCustomSlug) {\n                    // If switching to custom, keep current value\n                    const currentSlug = form.getFieldValue('slug');\n                    setAutoSlug(currentSlug);\n                  } else {\n                    // If switching back to auto, regenerate from section\n                    const sectionValue = form.getFieldValue('section');\n                    const newSlug = sectionValue.toLowerCase().replace(/\\s+/g, '-');\n                    setAutoSlug(newSlug);\n                    form.setFieldsValue({ slug: newSlug });\n                  }\n                }}\n                style={{ marginLeft: 8 }}\n              >\n                {isCustomSlug ? 'Use Auto Slug' : 'Customize Slug'}\n              </Button>\n            </span>\n          }\n          rules={[\n            { required: true, message: 'Slug is required!' },\n            {\n              pattern: /^[a-z0-9]+(?:-[a-z0-9]+)*$/,\n              message: 'Slug can only contain lowercase letters, numbers, and hyphens'\n            }\n          ]}\n        >\n          <Input \n            disabled={!isCustomSlug}\n            onChange={(e) => {\n              if (isCustomSlug) {\n                setAutoSlug(e.target.value);\n              }\n            }}\n          />\n        </Form.Item>\n\n        <Form.Item\n          name=\"title\"\n          label=\"Title\"\n          rules={[{ required: false, message: 'Please input the title!' }]}\n        >\n          <Input />\n        </Form.Item>\n\n        <Form.Item\n          name=\"shortDescription\"\n          label=\"Short Description\"\n          rules={[{ required: false, message: 'Please input the short description!' }]}\n        >\n          <ReactQuill \n            modules={modules}\n            theme=\"snow\"\n            style={{ height: '150px', marginBottom: '50px' }}\n            className=\"custom-quill-editor\"\n          />\n        </Form.Item>\n\n        <Form.Item\n          name=\"description\"\n          label=\"Description\"\n          rules={[{ required: false, message: 'Please input the description!' }]}\n        >\n          <ReactQuill \n            modules={modules}\n            theme=\"snow\"\n            style={{ height: '600px', marginBottom: '50px' }}\n            className=\"custom-quill-editor\"\n          />\n        </Form.Item>\n\n        <Form.Item\n          name=\"image\"\n          label=\"Image\"\n          rules={[{ required: false, message: 'Please upload an image!' }]}\n        >\n          <Upload {...uploadProps} listType=\"picture\">\n            <Button icon={<UploadOutlined />}>\n              {id ? 'Change Image' : 'Click to Upload'}\n            </Button>\n          </Upload>\n        </Form.Item>\n\n        <Form.Item\n          name=\"imageTitle\"\n          label=\"Image Title\"\n          rules={[{ required: false, message: 'Please input the image title!' }]}\n        >\n          <Input />\n        </Form.Item>\n\n        <Form.Item\n          name=\"altName\"\n          label=\"Alt Name\"\n          rules={[{ required: false, message: 'Please input the alt name!' }]}\n        >\n          <Input />\n        </Form.Item>\n\n        <Form.Item>\n          <Button type=\"primary\" htmlType=\"submit\">\n            {id ? 'Update' : 'Submit'}\n          </Button>\n        </Form.Item>\n      </Form>\n    </>\n  );\n};\n\nexport default AboutUsForm;\n"],"names":["AboutUsForm","id","useParams","navigate","useNavigate","form","Form","useForm","fileList","setFileList","useState","autoSlug","setAutoSlug","isCustomSlug","setIsCustomSlug","data","aboutUsData","isLoading","isLoadingData","useGetAboutUsByIdQuery","createAboutUs","useCreateAboutUsMutation","updateAboutUs","useUpdateAboutUsMutation","useEffect","setFieldsValue","title","shortDescription","description","imageTitle","altName","section","slug","toLowerCase","replace","image","uid","name","status","url","sectionValue","getFieldValue","generatedSlug","modules","toolbar","header","list","color","background","align","uploadProps","beforeUpload","file","type","startsWith","message","error","onChange","jsx","Spin","size","jsxs","Fragment","children","Breadcrumb","items","onClick","style","marginBottom","layout","onFinish","async","values","formData","FormData","append","originFileObj","unwrap","success","errorMessage","Item","label","rules","required","Select","placeholder","value","newSlug","Option","Button","currentSlug","marginLeft","pattern","Input","disabled","e","target","ReactQuill","theme","height","className","Upload","listType","icon","UploadOutlined","htmlType"],"mappings":"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"}