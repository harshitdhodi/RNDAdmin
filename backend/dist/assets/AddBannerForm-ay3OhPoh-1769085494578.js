import{f as C,dP as r,d_ as w,r as o,j as e,dT as m,L as b,dZ as M,bl as f,dV as T,be as d,dW as R,dU as i,dm as h,as as A,c as O,dp as c}from"./index-DYP9jOq_-1769085494578.js";import{R as p}from"./MinusCircleOutlined-D6sOaqvE-1769085494578.js";const{Option:u}=f,{TextArea:P}=i,v=()=>{const y=C(),[x]=r.useForm(),[I]=w(),[E,g]=o.useState(null),[N,k]=o.useState([]),[S,L]=o.useState(!0);o.useEffect(()=>{(async()=>{try{const n=await O.get("/api/menulist/get-menu");n.data.success?k(n.data.data):c.error("Failed to load menu list")}catch(n){console.error("Error fetching menu list:",n),c.error("Error fetching menu list")}finally{L(!1)}})()},[]);const F=async s=>{var n,t;try{const a=new FormData;if((t=(n=s.image)==null?void 0:n[0])!=null&&t.originFileObj)a.append("image",s.image[0].originFileObj),a.append("imgName",s.imgName);else{c.error("Please select an image");return}a.append("title",JSON.stringify(s.title||[])),a.append("altName",s.altName),a.append("details",s.details),a.append("pageSlug",s.pageSlug),a.append("heading",JSON.stringify(s.heading||[])),a.append("subheading",s.subheading||""),a.append("description",s.description||""),a.append("marque",s.marque||""),a.append("link",JSON.stringify(s.link||[])),await I(a),c.success("Banner created successfully"),y("/banner-table")}catch(a){console.error(a),c.error("Failed to create banner")}},B=s=>{const n=s.fileList[0];if(n!=null&&n.originFileObj){const t=new FileReader;t.onload=()=>{g(t.result)},t.readAsDataURL(n.originFileObj),x.setFieldsValue({image:s.fileList})}else g(null)},q=s=>{const n=[];return s.forEach(t=>{n.push(e.jsx(u,{value:t.parent.path,className:"font-bold",children:t.parent.name},t._id)),t.children&&t.children.forEach(a=>{n.push(e.jsxs(u,{value:a.path,className:"pl-5",children:[e.jsx("span",{children:" ├── "}),a.name]},a._id)),a.subChildren&&a.subChildren.forEach(l=>{n.push(e.jsxs(u,{value:l.path,className:"pl-10",children:[e.jsx("span",{children:"├────"})," ",l.name]},l._id))})})}),n};return e.jsxs("div",{children:[e.jsxs(m,{className:"px-4 py-6",children:[e.jsx(m.Item,{children:e.jsxs(b,{to:"/dashboard",children:[e.jsx(M,{})," Dashboard"]})}),e.jsx(m.Item,{children:e.jsx(b,{to:"/banner-table",children:"Banner Management"})}),e.jsx(m.Item,{children:"Add New Banner"})]}),e.jsxs("div",{className:"p-6",children:[e.jsx("h1",{className:"text-2xl font-bold mb-6",children:"Add New Banner"}),e.jsxs(r,{form:x,layout:"vertical",onFinish:F,children:[e.jsx(r.Item,{name:"pageSlug",label:"Page Slug",rules:[{required:!0,message:"Please select a page slug!"}],children:e.jsx(f,{placeholder:"Select a menu item",loading:S,children:q(N)})}),e.jsx(r.Item,{name:"image",label:"Banner Image",rules:[{required:!0,message:"Please upload an image!"}],children:e.jsx(T,{maxCount:1,listType:"picture",beforeUpload:()=>!1,onChange:B,children:e.jsx(d,{icon:e.jsx(R,{}),children:"Upload Image"})})}),e.jsx(r.Item,{name:"imgName",label:"Image Name",rules:[{required:!0,message:"Please input image name!"}],children:e.jsx(i,{})}),e.jsx(r.List,{name:"title",children:(s,{add:n,remove:t})=>e.jsxs(e.Fragment,{children:[s.map((a,l)=>e.jsx(r.Item,{label:l===0?"Title":"",required:!1,children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[e.jsx(r.Item,{...a,validateTrigger:["onChange","onBlur"],rules:[{required:!0,whitespace:!0,message:"Please input title or delete this field."}],noStyle:!0,children:e.jsx(i,{placeholder:"Title"})}),e.jsx(p,{className:"dynamic-delete-button",onClick:()=>t(a.name)})]})},a.key)),e.jsx(r.Item,{label:s.length===0?"Title":"",children:e.jsx(d,{type:"dashed",onClick:()=>n(),block:!0,icon:e.jsx(h,{}),children:"Add Title"})})]})}),e.jsx(r.Item,{name:"altName",label:"Alt Name",rules:[{required:!0,message:"Please input alt name!"}],children:e.jsx(i,{})}),e.jsx(r.List,{name:"heading",children:(s,{add:n,remove:t})=>e.jsxs(e.Fragment,{children:[s.map((a,l)=>e.jsx(r.Item,{label:l===0?"Heading":"",required:!1,children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[e.jsx(r.Item,{...a,validateTrigger:["onChange","onBlur"],noStyle:!0,children:e.jsx(i,{placeholder:"Heading"})}),e.jsx(p,{className:"dynamic-delete-button",onClick:()=>t(a.name)})]})},a.key)),e.jsx(r.Item,{label:s.length===0?"Heading":"",children:e.jsx(d,{type:"dashed",onClick:()=>n(),block:!0,icon:e.jsx(h,{}),children:"Add Heading"})})]})}),e.jsx(r.Item,{name:"subheading",label:"Subheading",children:e.jsx(i,{})}),e.jsx(r.Item,{name:"marque",label:"Marque Text",children:e.jsx(i,{})}),e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Social Media Links"}),e.jsx(r.List,{name:"link",children:(s,{add:n,remove:t})=>e.jsxs(e.Fragment,{children:[s.map(({key:a,name:l,...j})=>e.jsxs("div",{style:{display:"flex",gap:"8px",marginBottom:"8px",alignItems:"center"},children:[e.jsx(r.Item,{...j,name:[l,"name"],rules:[{required:!0,message:"Missing name"}],style:{marginBottom:0,flex:1},children:e.jsx(i,{placeholder:"Link Name (e.g. Facebook)"})}),e.jsx(r.Item,{...j,name:[l,"url"],rules:[{required:!0,message:"Missing url"}],style:{marginBottom:0,flex:2},children:e.jsx(i,{placeholder:"URL"})}),e.jsx(p,{onClick:()=>t(l)})]},a)),e.jsx(r.Item,{children:e.jsx(d,{type:"dashed",onClick:()=>n(),block:!0,icon:e.jsx(h,{}),children:"Add Social Link"})})]})}),e.jsx(r.Item,{name:"description",label:"Description",children:e.jsx(P,{rows:4})}),e.jsx(r.Item,{name:"details",label:"Details",children:e.jsx(A,{theme:"snow"})}),e.jsx(r.Item,{children:e.jsx(d,{type:"primary",htmlType:"submit",children:"Submit"})})]})]})]})};export{v as default};
