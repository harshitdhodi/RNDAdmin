{"version":3,"file":"BlogCard-C2aQniil.js","sources":["../../src/websiteBackend/blogCard/BlogCard.jsx"],"sourcesContent":["import React, { useState, useRef, useEffect } from 'react';\r\nimport axios from 'axios';\r\nimport { Form, Button, message } from 'antd';\r\nimport JoditEditor from 'jodit-react';\r\n\r\nconst BlogCardForm = () => {\r\n  const [form] = Form.useForm();\r\n  const [blogCard, setBlogCard] = useState('');\r\n  const [displayContent, setDisplayContent] = useState(''); // New state for display\r\n  const [blogCardId, setBlogCardId] = useState(null);\r\n\r\n  const editorRef = useRef(null);\r\n\r\n  const config = {\r\n    uploader: { insertImageAsBase64URI: true },\r\n    toolbarAdaptive: false,\r\n    toolbarSticky: false,\r\n    buttons: [\r\n      'bold',\r\n      'italic',\r\n      'underline',\r\n      'ul',\r\n      'ol',\r\n      'fontsize',\r\n      'paragraph',\r\n      'link',\r\n      'image',\r\n      'video',\r\n      'table',\r\n      'align',\r\n      'undo',\r\n      'redo',\r\n      'font',\r\n      'fontsize',\r\n      'brush',\r\n      'foreColor',\r\n      'backColor',\r\n    ],\r\n    // Force black text in editor display\r\n    style: {\r\n      color: 'black'\r\n    }\r\n  };\r\n\r\n  const fetchBlogCard = async () => {\r\n    try {\r\n      const response = await axios.get('/api/blogCard/getCard');\r\n      const blogCardData = response.data[0];\r\n      console.log(response);\r\n      setBlogCardId(blogCardData._id);\r\n      \r\n      // Store original content (with white text)\r\n      setBlogCard(blogCardData.blogCard);\r\n      \r\n      // Convert white text to black for display\r\n      const parser = new DOMParser();\r\n      const doc = parser.parseFromString(blogCardData.blogCard, 'text/html');\r\n      const elements = doc.getElementsByTagName('*');\r\n      for (let element of elements) {\r\n        if (element.style.color === 'white' || element.style.color === '#ffffff') {\r\n          element.style.color = 'black';\r\n        }\r\n      }\r\n      setDisplayContent(doc.body.innerHTML);\r\n      form.setFieldsValue({ blogCard: blogCardData.blogCard });\r\n    } catch (error) {\r\n      console.error('Failed to fetch blog card:', error);\r\n      message.error('Failed to fetch blog card.');\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    fetchBlogCard();\r\n  }, [form]);\r\n\r\n  const handleEditorChange = (newContent) => {\r\n    // Keep the original content with white text in blogCard state\r\n    setBlogCard(newContent);\r\n    \r\n    // Convert white text to black for display\r\n    const parser = new DOMParser();\r\n    const doc = parser.parseFromString(newContent, 'text/html');\r\n    const elements = doc.getElementsByTagName('*');\r\n    for (let element of elements) {\r\n      if (element.style.color === 'white' || element.style.color === '#ffffff') {\r\n        element.style.color = 'black';\r\n      }\r\n    }\r\n    setDisplayContent(doc.body.innerHTML);\r\n  };\r\n\r\n  const onFinish = async (values) => {\r\n    try {\r\n      if (blogCardId) {\r\n        // Update existing blog card\r\n        await axios.put(`/api/blogCard/editCard/${blogCardId}`, {\r\n          blogCard: blogCard,\r\n        });\r\n        message.success('Blog card updated successfully!');\r\n      } else {\r\n        // Add new blog card\r\n        await axios.post('/api/blogCard/addCard', {\r\n          blogCard: blogCard,\r\n        });\r\n        message.success('Blog card added successfully!');\r\n      }\r\n      form.resetFields();\r\n      setBlogCard('');\r\n      setDisplayContent('');\r\n      fetchBlogCard(); // Fetch the updated data\r\n    } catch (error) {\r\n      console.error('Failed to save blog card:', error);\r\n      message.error('Failed to save blog card.');\r\n    }\r\n  };\r\n\r\n  return (\r\n    <Form \r\n      form={form} \r\n      layout=\"vertical\" \r\n      onFinish={onFinish}\r\n      name=\"blog_card_form\"\r\n    >\r\n      <Form.Item\r\n        name=\"blogCard\"\r\n        label=\"Blog Card Content\"\r\n        rules={[{ required: true, message: 'Please input the blog card content!' }]}\r\n      >\r\n        <JoditEditor \r\n          ref={editorRef} \r\n          value={displayContent || blogCard} // Use displayContent if available\r\n          config={config} \r\n          onChange={handleEditorChange}\r\n        />\r\n      </Form.Item>\r\n\r\n      <Form.Item>\r\n        <Button type=\"primary\" htmlType=\"submit\">\r\n          {blogCardId ? 'Update Blog Card' : 'Add Blog Card'}\r\n        </Button>\r\n      </Form.Item>\r\n    </Form>\r\n  );\r\n};\r\n\r\nexport default BlogCardForm;"],"names":["BlogCardForm","form","Form","useForm","blogCard","setBlogCard","useState","displayContent","setDisplayContent","blogCardId","setBlogCardId","editorRef","useRef","fetchBlogCard","async","blogCardData","axios","get","data","_id","doc","DOMParser","parseFromString","elements","getElementsByTagName","element","style","color","body","innerHTML","setFieldsValue","error","message","useEffect","jsxs","layout","onFinish","values","put","success","post","resetFields","name","children","jsx","Item","label","rules","required","JoditEditor","ref","value","config","uploader","insertImageAsBase64URI","toolbarAdaptive","toolbarSticky","buttons","onChange","newContent","Button","type","htmlType"],"mappings":"4fAKA,MAAMA,EAAe,KACnB,MAAOC,GAAQC,EAAKC,WACbC,EAAUC,GAAeC,EAAAA,SAAS,KAClCC,EAAgBC,GAAqBF,EAAAA,SAAS,KAC9CG,EAAYC,GAAiBJ,EAAAA,SAAS,MAEvCK,EAAYC,SAAO,MAiCnBC,EAAgBC,UAChB,IACF,MACMC,SADiBC,EAAMC,IAAI,0BACHC,KAAK,GAEnCR,EAAcK,EAAaI,KAG3Bd,EAAYU,EAAaX,UAGnB,MACAgB,GADS,IAAIC,WACAC,gBAAgBP,EAAaX,SAAU,aACpDmB,EAAWH,EAAII,qBAAqB,KAC1C,IAAA,IAASC,KAAWF,EACU,UAAxBE,EAAQC,MAAMC,OAA6C,YAAxBF,EAAQC,MAAMC,QACnDF,EAAQC,MAAMC,MAAQ,SAGRnB,EAAAY,EAAIQ,KAAKC,WAC3B5B,EAAK6B,eAAe,CAAE1B,SAAUW,EAAaX,iBACtC2B,GAEPC,EAAQD,MAAM,6BAA4B,GAI9CE,EAAAA,WAAU,KACMpB,GAAA,GACb,CAACZ,IA4CF,OAAAiC,EAAAA,KAAChC,EAAA,CACCD,OACAkC,OAAO,WACPC,SA7BatB,MAAOuB,IAClB,IACE5B,SAEIO,EAAMsB,IAAI,0BAA0B7B,IAAc,CACtDL,aAEF4B,EAAQO,QAAQ,2CAGVvB,EAAMwB,KAAK,wBAAyB,CACxCpC,aAEF4B,EAAQO,QAAQ,kCAElBtC,EAAKwC,cACLpC,EAAY,IACZG,EAAkB,IACJK,UACPkB,GAEPC,EAAQD,MAAM,4BAA2B,GASzCW,KAAK,iBAELC,SAAA,CAAAC,EAAAA,IAAC1C,EAAK2C,KAAL,CACCH,KAAK,WACLI,MAAM,oBACNC,MAAO,CAAC,CAAEC,UAAU,EAAMhB,QAAS,wCAEnCW,SAAAC,EAAAA,IAACK,EAAA,CACCC,IAAKvC,EACLwC,MAAO5C,GAAkBH,EACzBgD,OAtHO,CACbC,SAAU,CAAEC,wBAAwB,GACpCC,iBAAiB,EACjBC,eAAe,EACfC,QAAS,CACP,OACA,SACA,YACA,KACA,KACA,WACA,YACA,OACA,QACA,QACA,QACA,QACA,OACA,OACA,OACA,WACA,QACA,YACA,aAGF/B,MAAO,CACLC,MAAO,UA4FH+B,SAzDoBC,IAE1BtD,EAAYsD,GAGN,MACAvC,GADS,IAAIC,WACAC,gBAAgBqC,EAAY,aACzCpC,EAAWH,EAAII,qBAAqB,KAC1C,IAAA,IAASC,KAAWF,EACU,UAAxBE,EAAQC,MAAMC,OAA6C,YAAxBF,EAAQC,MAAMC,QACnDF,EAAQC,MAAMC,MAAQ,SAGRnB,EAAAY,EAAIQ,KAAKC,UAAS,MAgDjCe,EAAAA,IAAA1C,EAAK2C,KAAL,CACCF,SAACC,EAAAA,IAAAgB,EAAA,CAAOC,KAAK,UAAUC,SAAS,SAC7BnB,SAAalC,EAAA,mBAAqB,sBAGzC"}