import{r as e,j as t}from"./react-BfBsRgn0.js";import{aH as a,aI as s,aJ as r,a0 as i,I as l,B as o}from"./index-mCSb4W1J.js";import{R as m}from"./react-quill-O9LY_HeH.js";import{l as c}from"./lucide-D6BDVLHE.js";import{b as d,a as n}from"./react-router-DUJjWq5j.js";import"./classnames-C3ovBj6j.js";import"./react-dom-DwrudmHt.js";import"./scheduler-BFk34ZWe.js";import"./react-redux-DbBiFgqA.js";import"./use-sync-external-store-DdeJV4gQ.js";import"./@reduxjs-UCSEaN3g.js";import"./redux-C5Huw2aR.js";import"./immer-DgfQkf_7.js";import"./redux-thunk-B3S1iNVp.js";import"./reselect-BSOs5pU1.js";import"./js-cookie-BXEMiIsG.js";import"./@radix-ui-BWjeGzol.js";import"./aria-hidden-BHUiN-rI.js";import"./react-remove-scroll-yauc81_r.js";import"./tslib-Bc9CN1Ef.js";import"./react-remove-scroll-bar-BcxDecei.js";import"./react-style-singleton-C1QVuB2c.js";import"./get-nonce-BYiZHLe3.js";import"./use-sidecar-BA4C4RS7.js";import"./use-callback-ref-Cvx1xcTX.js";import"./@floating-ui-BSChQBl3.js";import"./class-variance-authority-DeOWI0hf.js";import"./clsx-BeLtu-UY.js";import"./tailwind-merge-D2VJQb_v.js";import"./axios-BoylL8Pu.js";import"./cookie-BUTH-fPQ.js";import"./lodash-CtK3uT03.js";import"./quill-CMG--X-K.js";function p(){const{id:p}=d(),u=n(),[g,j]=e.useState({title:"",date:"",details:"",image:[],alt:[],imageTitle:[],slug:"",postedBy:"",visits:0,metatitle:"",metadescription:"",metakeywords:"",metacanonical:"",metalanguage:"",metaschema:"",otherMeta:"",url:"",priority:0,changeFreq:"",lastmod:new Date,status:"",category:"",createdAt:new Date,updatedAt:new Date}),[h,x]=e.useState([]),{data:y,isLoading:b,error:f}=a(p,{skip:!p}),[v,{isLoading:w}]=s(),[k,{isLoading:N}]=r(),{data:C}=i(),[D,A]=e.useState({}),q=e=>{const{name:t,value:a}=e.target;A((e=>({...e,[t]:""}))),j((e=>{const s={...e,[t]:a};return"title"===t&&(s.slug=a.toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/^-+|-+$/g,"")),s}))};return e.useEffect((()=>{var e;y&&(j({title:y.title||"",date:y.date||"",details:y.details||"",image:[],alt:y.alt||[],imageTitle:y.imageTitle||[],slug:y.slug||"",postedBy:y.postedBy||"",visits:y.visits||0,metatitle:y.metatitle||"",metadescription:y.metadescription||"",metakeywords:y.metakeywords||"",metacanonical:y.metacanonical||"",metalanguage:y.metalanguage||"",metaschema:y.metaschema||"",otherMeta:y.otherMeta||"",url:y.url||"",priority:y.priority||0,changeFreq:y.changeFreq||"",lastmod:y.lastmod||new Date,status:y.status||"",category:(null==(e=y.category)?void 0:e._id)||"",createdAt:y.createdAt||new Date,updatedAt:y.updatedAt||new Date}),y.image&&Array.isArray(y.image)&&x(y.image.map((e=>`/api/image/download/${e}`))))}),[y]),e.useEffect((()=>()=>{h.forEach((e=>URL.revokeObjectURL(e)))}),[h]),p&&b?t.jsx("div",{children:"Loading..."}):f?t.jsxs("div",{children:["Error: ",f.message||"An error occurred"]}):t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"flex items-center gap-2 mb-4 text-sm",children:[t.jsx("span",{onClick:()=>u("/dashboard"),className:"cursor-pointer hover:text-primary",children:"Dashboard"}),t.jsx(c,{className:"h-4 w-4"}),t.jsx("span",{onClick:()=>u("/blog-table"),className:"cursor-pointer hover:text-primary",children:"Blogs"}),t.jsx(c,{className:"h-4 w-4"}),t.jsx("span",{className:"text-muted-foreground",children:p?"Edit Blog":"Create Blog"})]}),t.jsxs("form",{onSubmit:async e=>{e.preventDefault();const t={};if(g.title.trim()||(t.title="Title is required"),g.category||(t.category="Category is required"),g.date||(t.date="Date is required"),g.details.trim()||(t.details="Details are required"),Object.keys(t).length>0)return void A(t);const a=new FormData;Object.entries(g).forEach((([e,t])=>{"image"===e?t.forEach((e=>{a.append("image",e)})):Array.isArray(t)?t.forEach((t=>{a.append(e,t)})):a.append(e,t.toString())})),p&&a.append("id",p);try{p?await k({id:p,formData:a}).unwrap():await v(a).unwrap(),u("/blog-table")}catch(s){}},className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium",children:"Blog Category"}),t.jsxs("select",{name:"category",value:g.category,onChange:e=>j((t=>({...t,category:e.target.value}))),className:`w-full rounded-md border ${D.category?"border-red-500":"border-gray-300"} p-2`,required:!0,children:[t.jsx("option",{value:"",children:"Select a category"}),null==C?void 0:C.map((e=>t.jsx("option",{value:e._id,children:e.category},e._id)))]}),D.category&&t.jsx("p",{className:"text-red-500 text-sm mt-1",children:D.category})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium",children:"Title"}),t.jsx(l,{name:"title",value:g.title,onChange:q,placeholder:"Enter blog title",required:!0,className:D.title?"border-red-500":""}),D.title&&t.jsx("p",{className:"text-red-500 text-sm mt-1",children:D.title})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium",children:"Date"}),t.jsx(l,{type:"date",name:"date",value:g.date,onChange:q,required:!0})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium",children:"Details"}),t.jsx(m,{theme:"snow",value:g.details,onChange:e=>{j((t=>({...t,details:e})))},placeholder:"Enter blog details"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium",children:"Images"}),t.jsx(l,{type:"file",multiple:!0,onChange:e=>{const t=Array.from(e.target.files||[]);j((e=>({...e,image:t})));const a=t.map((e=>URL.createObjectURL(e)));x(a)}}),t.jsx("div",{className:"mt-2 flex flex-wrap gap-2",children:h.map(((e,a)=>t.jsx("img",{src:e,alt:`Preview ${a+1}`,className:"h-16 w-16 object-cover rounded"},a)))})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium",children:"Slug"}),t.jsx(l,{name:"slug",value:g.slug,onChange:q,placeholder:"Slug will be generated automatically",readOnly:!0})]},"slug"),["alt","imageTitle","postedBy","metatitle","metadescription","metakeywords","metacanonical","metalanguage","metaschema","otherMeta","priority","status"].map((e=>t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium",children:e.charAt(0).toUpperCase()+e.slice(1)}),t.jsx(l,{name:e,value:g[e],onChange:q,placeholder:`Enter ${e}`})]},e))),t.jsxs("div",{className:"flex justify-end space-x-4",children:[t.jsx(o,{type:"button",variant:"ghost",onClick:()=>u("/blogs"),children:"Cancel"}),t.jsx(o,{type:"submit",disabled:w||N,children:p?"Update Blog":"Create Blog"})]})]})]})}export{p as default};
