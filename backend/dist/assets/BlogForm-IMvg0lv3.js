import{bq as e,br as a,bs as t,a5 as s,j as r,I as l,B as i}from"./main-BcUd3ASm.js";import{g as o,d,r as n}from"./vendor-router-CaZtIe2_.js";import{R as c}from"./index-BEyUZcsN.js";import{C as m}from"./chevron-right-C95tp0e6.js";import"./vendor-react-DD_RYU77.js";import"./vendor-utils-CfKmydC0.js";import"./isEqual-DwlFmuh_.js";function g(){const{id:g}=o(),u=d(),[p,h]=n.useState({title:"",date:"",details:"",image:[],alt:[],imageTitle:[],slug:"",postedBy:"",visits:0,metatitle:"",metadescription:"",metakeywords:"",metacanonical:"",metalanguage:"",metaschema:"",otherMeta:"",url:"",priority:0,changeFreq:"",lastmod:new Date,status:"",category:"",createdAt:new Date,updatedAt:new Date}),[x,j]=n.useState([]),{data:y,isLoading:b,error:v}=e(g,{skip:!g}),[f,{isLoading:w}]=a(),[N,{isLoading:C}]=t(),{data:k}=s(),[D,A]=n.useState({}),q=e=>{const{name:a,value:t}=e.target;A((e=>({...e,[a]:""}))),h((e=>{const s={...e,[a]:t};return"title"===a&&(s.slug=t.toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/^-+|-+$/g,"")),s}))};return n.useEffect((()=>{y&&(h({title:y.title||"",date:y.date||"",details:y.details||"",image:[],alt:y.alt||[],imageTitle:y.imageTitle||[],slug:y.slug||"",postedBy:y.postedBy||"",visits:y.visits||0,metatitle:y.metatitle||"",metadescription:y.metadescription||"",metakeywords:y.metakeywords||"",metacanonical:y.metacanonical||"",metalanguage:y.metalanguage||"",metaschema:y.metaschema||"",otherMeta:y.otherMeta||"",url:y.url||"",priority:y.priority||0,changeFreq:y.changeFreq||"",lastmod:y.lastmod||new Date,status:y.status||"",category:y.category?._id||"",createdAt:y.createdAt||new Date,updatedAt:y.updatedAt||new Date}),y.image&&Array.isArray(y.image)&&j(y.image.map((e=>`/api/image/download/${e}`))))}),[y]),n.useEffect((()=>()=>{x.forEach((e=>URL.revokeObjectURL(e)))}),[x]),g&&b?r.jsx("div",{children:"Loading..."}):v?r.jsxs("div",{children:["Error: ",v.message||"An error occurred"]}):r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"flex items-center gap-2 mb-4 text-sm",children:[r.jsx("span",{onClick:()=>u("/dashboard"),className:"cursor-pointer hover:text-primary",children:"Dashboard"}),r.jsx(m,{className:"h-4 w-4"}),r.jsx("span",{onClick:()=>u("/blog-table"),className:"cursor-pointer hover:text-primary",children:"Blogs"}),r.jsx(m,{className:"h-4 w-4"}),r.jsx("span",{className:"text-muted-foreground",children:g?"Edit Blog":"Create Blog"})]}),r.jsxs("form",{onSubmit:async e=>{e.preventDefault();const a={};if(p.title.trim()||(a.title="Title is required"),p.category||(a.category="Category is required"),p.date||(a.date="Date is required"),p.details.trim()||(a.details="Details are required"),Object.keys(a).length>0)return void A(a);const t=new FormData;Object.entries(p).forEach((([e,a])=>{"image"===e?a.forEach((e=>{t.append("image",e)})):Array.isArray(a)?a.forEach((a=>{t.append(e,a)})):t.append(e,a.toString())})),g&&t.append("id",g);try{g?await N({id:g,formData:t}).unwrap():await f(t).unwrap(),u("/blog-table")}catch(s){}},className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium",children:"Blog Category"}),r.jsxs("select",{name:"category",value:p.category,onChange:e=>h((a=>({...a,category:e.target.value}))),className:`w-full rounded-md border ${D.category?"border-red-500":"border-gray-300"} p-2`,required:!0,children:[r.jsx("option",{value:"",children:"Select a category"}),k?.map((e=>r.jsx("option",{value:e._id,children:e.category},e._id)))]}),D.category&&r.jsx("p",{className:"text-red-500 text-sm mt-1",children:D.category})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium",children:"Title"}),r.jsx(l,{name:"title",value:p.title,onChange:q,placeholder:"Enter blog title",required:!0,className:D.title?"border-red-500":""}),D.title&&r.jsx("p",{className:"text-red-500 text-sm mt-1",children:D.title})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium",children:"Date"}),r.jsx(l,{type:"date",name:"date",value:p.date,onChange:q,required:!0})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium",children:"Details"}),r.jsx(c,{theme:"snow",value:p.details,onChange:e=>{h((a=>({...a,details:e})))},placeholder:"Enter blog details"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium",children:"Images"}),r.jsx(l,{type:"file",multiple:!0,onChange:e=>{const a=Array.from(e.target.files||[]);h((e=>({...e,image:a})));const t=a.map((e=>URL.createObjectURL(e)));j(t)}}),r.jsx("div",{className:"mt-2 flex flex-wrap gap-2",children:x.map(((e,a)=>r.jsx("img",{src:e,alt:`Preview ${a+1}`,className:"h-16 w-16 object-cover rounded"},a)))})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium",children:"Slug"}),r.jsx(l,{name:"slug",value:p.slug,onChange:q,placeholder:"Slug will be generated automatically",readOnly:!0})]},"slug"),["alt","imageTitle","postedBy","metatitle","metadescription","metakeywords","metacanonical","metalanguage","metaschema","otherMeta","priority","status"].map((e=>r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium",children:e.charAt(0).toUpperCase()+e.slice(1)}),r.jsx(l,{name:e,value:p[e],onChange:q,placeholder:`Enter ${e}`})]},e))),r.jsxs("div",{className:"flex justify-end space-x-4",children:[r.jsx(i,{type:"button",variant:"ghost",onClick:()=>u("/blogs"),children:"Cancel"}),r.jsx(i,{type:"submit",disabled:w||C,children:g?"Update Blog":"Create Blog"})]})]})]})}export{g as default};
//# sourceMappingURL=BlogForm-IMvg0lv3.js.map
