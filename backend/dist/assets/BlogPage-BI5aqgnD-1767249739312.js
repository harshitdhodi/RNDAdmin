import{ds as F,dt as R,f as $,r as t,c as f,dn as l,j as e,L as D,be as d,dl as z,bc as A,du as M,cX as O,dm as P,cY as Y}from"./index-LUFGk0ex-1767249739312.js";import{I as G}from"./index-D5k71Dxb-1767249739312.js";import"./index-xtP99Nnj-1767249739312.js";const{Text:y}=M,q=()=>{const{data:j=[],error:v,isLoading:w,refetch:N}=F(),[S,{isLoading:g}]=R(),H=$(),[h,k]=t.useState({}),[o,u]=t.useState(""),[r,x]=t.useState(""),[I,p]=t.useState(""),[T,m]=t.useState(""),[i,c]=t.useState(!1);t.useEffect(()=>{B()},[]);const B=async()=>{c(!0);try{const a=await f.get("/api/pageHeading/heading?pageType=blogtitle",{withCredentials:!0}),{heading:s="",subheading:n=""}=a.data||{};u(s),x(n),p(s),m(n)}catch(a){console.error("Failed to fetch headings:",a),l.error("Failed to load page headings")}finally{c(!1)}},C=async()=>{c(!0);try{await f.put("/api/pageHeading/updateHeading?pageType=blogtitle",{pageType:"blogtitle",heading:o,subheading:r},{withCredentials:!0}),p(o),m(r),l.success("Headings saved successfully!")}catch(a){console.error("Failed to save headings:",a),l.error("Failed to save headings")}finally{c(!1)}},b=o!==I||r!==T,_=async a=>{try{await S(a).unwrap(),l.success("Blog deleted successfully"),N()}catch(s){console.error("Failed to delete blog:",s),l.error("Failed to delete blog")}},E=a=>{k(s=>({...s,[a]:!s[a]}))},L=[{title:"Title",dataIndex:"title",key:"title",width:200,render:a=>e.jsx(y,{strong:!0,children:a})},{title:"Date",dataIndex:"date",key:"date",width:120},{title:"Details",dataIndex:"details",key:"details",render:(a,s)=>e.jsxs("div",{children:[e.jsx("div",{className:`relative overflow-hidden transition-all duration-300 ${h[s._id]?"max-h-none":"max-h-20"}`,dangerouslySetInnerHTML:{__html:a}}),a&&a.length>100&&e.jsx(d,{type:"link",onClick:()=>E(s._id),size:"small",className:"p-0 mt-1",children:h[s._id]?"Show Less":"Read More"})]})},{title:"Images",dataIndex:"image",key:"image",width:150,render:a=>a&&a.length>0?e.jsx("div",{className:"flex flex-wrap gap-2",children:a.map((s,n)=>e.jsx(G,{src:`/api/image/download/${s}`,alt:`Blog Image ${n+1}`,width:60,height:60,className:"object-cover border-2 border-gray-300 rounded",preview:{src:`/api/image/download/${s}`}},n))}):e.jsx(y,{type:"secondary",children:"No Image"})},{title:"Actions",key:"actions",width:120,fixed:"right",render:(a,s)=>e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(d,{icon:e.jsx(O,{}),onClick:()=>H(`/edit-blog-form/${s._id}`),size:"small"}),e.jsx(P,{title:"Are you sure you want to delete this blog?",onConfirm:()=>_(s._id),okText:"Yes",cancelText:"No",disabled:g,children:e.jsx(d,{danger:!0,icon:e.jsx(Y,{}),size:"small",loading:g})})]})}];return w?e.jsx("div",{className:"p-8 text-center",children:"Loading blogs..."}):v?e.jsx("div",{className:"p-8 text-center text-red-600",children:"Error loading blogs"}):e.jsxs("div",{className:"space-y-6 p-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h2",{className:"text-3xl font-bold",children:"Blogs"}),e.jsx(D,{to:"/blog-form",children:e.jsx(d,{type:"primary",icon:e.jsx(z,{}),children:"Add Blog"})})]}),e.jsxs("div",{className:"border border-gray-300 shadow-lg rounded-lg p-6 bg-white",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Edit Page Headings"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 font-bold mb-2 uppercase tracking-wider",children:"Heading"}),e.jsx("input",{type:"text",value:o,onChange:a=>u(a.target.value),disabled:i,className:"w-full px-4 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter main heading"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 font-bold mb-2 uppercase tracking-wider",children:"Subheading"}),e.jsx("input",{type:"text",value:r,onChange:a=>x(a.target.value),disabled:i,className:"w-full px-4 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter subheading"})]})]}),e.jsxs("div",{className:"mt-6 flex items-center gap-4",children:[e.jsx(d,{onClick:C,type:"primary",loading:i,disabled:!b||i,children:i?"Saving...":"Save Headings"}),!b&&!i&&e.jsx("span",{className:"text-gray-500 text-sm",children:"No changes to save"})]})]}),e.jsx(A,{columns:L,dataSource:j,rowKey:"_id",pagination:{pageSize:5},scroll:{x:1e3}})]})};export{q as default};
