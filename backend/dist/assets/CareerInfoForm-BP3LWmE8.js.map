{"version":3,"file":"CareerInfoForm-BP3LWmE8.js","sources":["../../src/websiteBackend/career/CareerInfoForm.jsx"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\r\nimport axios from \"axios\";\r\nimport { Form } from \"@/components/ui/form\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { Label } from \"@/components/ui/label\";\r\nimport { Card, CardHeader, CardContent } from \"@/components/ui/card\";\r\nimport ReactQuill from \"react-quill\";\r\nimport \"react-quill/dist/quill.snow.css\";\r\n\r\nconst CareerInfoForm = () => {\r\n  const [form] = Form.useForm();\r\n  const [info, setInfo] = useState(\"\");\r\n  const [image, setImage] = useState(null);\r\n  const [imageUrl, setImageUrl] = useState(null);\r\n  const [careerInfo, setCareerInfo] = useState(null);\r\n\r\n  const fetchCareerInfo = async () => {\r\n    try {\r\n      const response = await axios.get(\"/api/careerInfo\");\r\n      if (response.data.length > 0) {\r\n        const data = response.data[0];\r\n        setCareerInfo(data);\r\n        setInfo(data.info);\r\n        form.setFieldsValue({ info: data.info });\r\n        if (data.image) {\r\n          setImageUrl(`/api/image/download/${data.image}`);\r\n        }\r\n      }\r\n    } catch (error) {\r\n      toast({\r\n        title: \"Error\",\r\n        description: \"Failed to fetch career info.\",\r\n        variant: \"destructive\",\r\n      });\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    fetchCareerInfo();\r\n  }, [form]);\r\n\r\n  const handleInfoChange = (newInfo) => {\r\n    setInfo(newInfo);\r\n\r\n    // Convert white text to black for visibility\r\n    const parser = new DOMParser();\r\n    const doc = parser.parseFromString(newInfo, \"text/html\");\r\n    const elements = doc.getElementsByTagName(\"*\");\r\n    for (let element of elements) {\r\n      if (element.style.color === \"white\" || element.style.color === \"#ffffff\") {\r\n        element.style.color = \"black\";\r\n      }\r\n    }\r\n    setInfo(doc.body.innerHTML);\r\n  };\r\n\r\n  const handleImageChange = (e) => {\r\n    const file = e.target.files[0];\r\n    if (file) {\r\n      setImage(file);\r\n      setImageUrl(URL.createObjectURL(file)); // Show preview\r\n    }\r\n  };\r\n\r\n  const handleSubmit = async () => {\r\n    const formData = new FormData();\r\n    formData.append(\"info\", info);\r\n    if (image) {\r\n      formData.append(\"image\", image);\r\n    }\r\n\r\n    try {\r\n      if (careerInfo) {\r\n        await axios.put(`/api/careerInfo/${careerInfo._id}`, formData);\r\n        toast({ title: \"Success\", description: \"Career info updated successfully!\" });\r\n      } else {\r\n        await axios.post(\"/api/careerInfo\", formData);\r\n        toast({ title: \"Success\", description: \"Career info created successfully!\" });\r\n      }\r\n      fetchCareerInfo();\r\n    } catch (error) {\r\n      toast({ title: \"Error\", description: \"Failed to save career info.\", variant: \"destructive\" });\r\n    }\r\n  };\r\n\r\n  return (\r\n    <Card className=\"p-6 max-w-2xl mx-auto\">\r\n      <CardHeader>\r\n        <h2 className=\"text-xl font-bold\">Career Info</h2>\r\n      </CardHeader>\r\n      <CardContent>\r\n        <Form form={form} layout=\"vertical\" onFinish={handleSubmit}>\r\n          <div className=\"mb-4\">\r\n            <Label htmlFor=\"info\">Info</Label>\r\n            <ReactQuill\r\n              id=\"info\"\r\n              value={info}\r\n              onChange={handleInfoChange}\r\n              modules={{\r\n                toolbar: [\r\n                  [{ header: \"1\" }, { header: \"2\" }, { font: [] }],\r\n                  [{ list: \"ordered\" }, { list: \"bullet\" }],\r\n                  [\"bold\", \"italic\", \"underline\", \"blockquote\"],\r\n                  [{ align: [] }],\r\n                  [\"link\", \"image\", \"video\"],\r\n                  [\"clean\"],\r\n                ],\r\n              }}\r\n              formats={[\r\n                \"header\",\r\n                \"font\",\r\n                \"list\",\r\n                \"bold\",\r\n                \"italic\",\r\n                \"underline\",\r\n                \"blockquote\",\r\n                \"align\",\r\n                \"link\",\r\n                \"image\",\r\n                \"video\",\r\n              ]}\r\n            />\r\n          </div>\r\n          <div className=\"mb-4\">\r\n            <Label htmlFor=\"image\">Image</Label>\r\n            {imageUrl && <img className=\"w-32 mb-2 rounded\" src={imageUrl} alt=\"Career Info\" />}\r\n            <input\r\n              type=\"file\"\r\n              id=\"image\"\r\n              accept=\"image/*\"\r\n              onChange={handleImageChange}\r\n              className=\"block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-lg file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100\"\r\n            />\r\n          </div>\r\n          <Button type=\"submit\" className=\"w-full\">\r\n            {careerInfo ? \"Update Career Info\" : \"Submit Career Info\"}\r\n          </Button>\r\n        </Form>\r\n      </CardContent>\r\n    </Card>\r\n  );\r\n};\r\n\r\nexport default CareerInfoForm;\r\n"],"names":["CareerInfoForm","form","Form","useForm","info","setInfo","useState","image","setImage","imageUrl","setImageUrl","careerInfo","setCareerInfo","fetchCareerInfo","async","response","axios","get","data","length","setFieldsValue","error","toast","title","description","variant","useEffect","jsxs","Card","className","children","jsx","CardHeader","CardContent","layout","onFinish","formData","FormData","append","put","_id","post","Label","htmlFor","ReactQuill","id","value","onChange","newInfo","doc","DOMParser","parseFromString","elements","getElementsByTagName","element","style","color","body","innerHTML","modules","toolbar","header","font","list","align","formats","src","alt","type","accept","e","file","target","files","URL","createObjectURL","Button"],"mappings":"0ZASA,MAAMA,EAAiB,KACrB,MAAOC,GAAQC,EAAKC,WACbC,EAAMC,GAAWC,EAAAA,SAAS,KAC1BC,EAAOC,GAAYF,EAAAA,SAAS,OAC5BG,EAAUC,GAAeJ,EAAAA,SAAS,OAClCK,EAAYC,GAAiBN,EAAAA,SAAS,MAEvCO,EAAkBC,UAClB,IACF,MAAMC,QAAiBC,EAAMC,IAAI,mBAC7B,GAAAF,EAASG,KAAKC,OAAS,EAAG,CACtB,MAAAD,EAAOH,EAASG,KAAK,GAC3BN,EAAcM,GACdb,EAAQa,EAAKd,MACbH,EAAKmB,eAAe,CAAEhB,KAAMc,EAAKd,OAC7Bc,EAAKX,OACKG,EAAA,uBAAuBQ,EAAKX,QAC1C,QAEKc,GACDC,MAAA,CACJC,MAAO,QACPC,YAAa,+BACbC,QAAS,eACV,GAILC,EAAAA,WAAU,KACQb,GAAA,GACf,CAACZ,IA+CF,OAAA0B,EAAAA,KAACC,EAAK,CAAAC,UAAU,wBACdC,SAAA,CAAAC,EAAAA,IAACC,GACCF,SAACC,EAAAA,IAAA,KAAA,CAAGF,UAAU,oBAAoBC,2BAEpCC,EAAAA,IAACE,GACCH,SAACH,EAAAA,KAAAzB,EAAA,CAAKD,OAAYiC,OAAO,WAAWC,SA3BrBrB,UACb,MAAAsB,EAAW,IAAIC,SACZD,EAAAE,OAAO,OAAQlC,GACpBG,GACO6B,EAAAE,OAAO,QAAS/B,GAGvB,IACEI,SACIK,EAAMuB,IAAI,mBAAmB5B,EAAW6B,MAAOJ,GACrDd,MAAM,CAAEC,MAAO,UAAWC,YAAa,8CAEjCR,EAAMyB,KAAK,kBAAmBL,GACpCd,MAAM,CAAEC,MAAO,UAAWC,YAAa,uCAEzBX,UACTQ,GACPC,MAAM,CAAEC,MAAO,QAASC,YAAa,8BAA+BC,QAAS,eAAe,GAWxFK,SAAA,CAACH,EAAAA,KAAA,MAAA,CAAIE,UAAU,OACbC,SAAA,CAACC,EAAAA,IAAAW,EAAA,CAAMC,QAAQ,OAAOb,SAAI,SAC1BC,EAAAA,IAACa,EAAA,CACCC,GAAG,OACHC,MAAO1C,EACP2C,SAxDcC,IACxB3C,EAAQ2C,GAGF,MACAC,GADS,IAAIC,WACAC,gBAAgBH,EAAS,aACtCI,EAAWH,EAAII,qBAAqB,KAC1C,IAAA,IAASC,KAAWF,EACU,UAAxBE,EAAQC,MAAMC,OAA6C,YAAxBF,EAAQC,MAAMC,QACnDF,EAAQC,MAAMC,MAAQ,SAGlBnD,EAAA4C,EAAIQ,KAAKC,UAAS,EA6ChBC,QAAS,CACPC,QAAS,CACP,CAAC,CAAEC,OAAQ,KAAO,CAAEA,OAAQ,KAAO,CAAEC,KAAM,KAC3C,CAAC,CAAEC,KAAM,WAAa,CAAEA,KAAM,WAC9B,CAAC,OAAQ,SAAU,YAAa,cAChC,CAAC,CAAEC,MAAO,KACV,CAAC,OAAQ,QAAS,SAClB,CAAC,WAGLC,QAAS,CACP,SACA,OACA,OACA,OACA,SACA,YACA,aACA,QACA,OACA,QACA,cAINtC,EAAAA,KAAC,MAAI,CAAAE,UAAU,OACbC,SAAA,CAACC,EAAAA,IAAAW,EAAA,CAAMC,QAAQ,QAAQb,SAAK,UAC3BrB,SAAa,MAAI,CAAAoB,UAAU,oBAAoBqC,IAAKzD,EAAU0D,IAAI,gBACnEpC,EAAAA,IAAC,QAAA,CACCqC,KAAK,OACLvB,GAAG,QACHwB,OAAO,UACPtB,SA1EeuB,IACzB,MAAMC,EAAOD,EAAEE,OAAOC,MAAM,GACxBF,IACF/D,EAAS+D,GACG7D,EAAAgE,IAAIC,gBAAgBJ,IAAK,EAuE7B1C,UAAU,gMAGdE,EAAAA,IAAC6C,GAAOR,KAAK,SAASvC,UAAU,SAC7BC,SAAAnB,EAAa,qBAAuB,8BAI7C"}