{"version":3,"file":"CatalogueForm-jCroAbDR.js","sources":["../../src/websiteBackend/catalogue/CatalogueForm.jsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { useNavigate, useParams, Link } from 'react-router-dom';\r\nimport { useCreateCatalogueMutation, useGetCatalogueByIdQuery, useUpdateCatalogueMutation } from \"@/slice/catalogue/catalogueslice\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { Input } from \"@/components/ui/input\";\r\nimport { Label } from \"@/components/ui/label\";\r\nimport { Breadcrumb, BreadcrumbItem, BreadcrumbLink } from \"@/components/ui/breadcrumb\";\r\nimport { toast } from \"react-toastify\";\r\n\r\nconst CatalogueForm = () => {\r\n  const navigate = useNavigate();\r\n  const { id } = useParams();\r\n  const { data: catalogue, isLoading } = useGetCatalogueByIdQuery(id, { skip: !id });\r\n  const [createCatalogue] = useCreateCatalogueMutation();\r\n  const [updateCatalogue] = useUpdateCatalogueMutation();\r\n  \r\n  const [title, setTitle] = useState('');\r\n  const [catalogueFile, setCatalogueFile] = useState(null);\r\n  const [imageFile, setImageFile] = useState(null);\r\n\r\n  useEffect(() => {\r\n    if (catalogue) {\r\n      setTitle(catalogue.title || \"\");\r\n    }\r\n  }, [catalogue]);\r\n\r\n  const handleFileChange = (e) => {\r\n    setCatalogueFile(e.target.files[0]);\r\n  };\r\n\r\n  const handleImageChange = (e) => {\r\n    setImageFile(e.target.files[0]);\r\n  };\r\n\r\n  const handleSubmit = async (e) => {\r\n    e.preventDefault();\r\n    const formData = new FormData();\r\n    formData.append('title', title);\r\n    if (catalogueFile) formData.append('catalog', catalogueFile);\r\n    if (imageFile) formData.append('image', imageFile);\r\n\r\n    try {\r\n      if (id) {\r\n        await updateCatalogue({ id, formData }).unwrap();\r\n        toast.success('Catalogue updated successfully');\r\n      } else {\r\n        await createCatalogue(formData).unwrap();\r\n        toast.success('Catalogue created successfully');\r\n      }\r\n      navigate('/catalogue-table');\r\n    } catch (error) {\r\n      toast.error('Failed to save catalogue');\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"max-w-lg mx-auto p-6 bg-white shadow-md rounded-lg\">\r\n      <Breadcrumb className=\"mb-4\">\r\n        <BreadcrumbItem>\r\n          <BreadcrumbLink as={Link} to=\"/dashboard\">Dashboard</BreadcrumbLink>\r\n        </BreadcrumbItem>\r\n        <BreadcrumbItem>\r\n          <BreadcrumbLink as={Link} to=\"/catalogue-table\">Catalogue Table</BreadcrumbLink>\r\n        </BreadcrumbItem>\r\n        <BreadcrumbItem>{id ? 'Edit Catalogue' : 'Create Catalogue'}</BreadcrumbItem>\r\n      </Breadcrumb>\r\n\r\n      <form onSubmit={handleSubmit} className=\"space-y-4\">\r\n        <div>\r\n          <Label htmlFor=\"title\">Title</Label>\r\n          <Input id=\"title\" value={title} onChange={(e) => setTitle(e.target.value)} required />\r\n        </div>\r\n\r\n        <div>\r\n          <Label htmlFor=\"catalogue\">Upload Catalogue</Label>\r\n          <Input id=\"catalogue\" type=\"file\" accept=\".pdf\" onChange={handleFileChange} required />\r\n        </div>\r\n\r\n        <div>\r\n          <Label htmlFor=\"image\">Upload Image</Label>\r\n          <Input id=\"image\" type=\"file\" accept=\"image/*\" onChange={handleImageChange} required />\r\n        </div>\r\n\r\n        <Button type=\"submit\" className=\"w-full\" disabled={isLoading}>\r\n          {isLoading ? 'Processing...' : id ? 'Update' : 'Create'}\r\n        </Button>\r\n      </form>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default CatalogueForm;\r\n"],"names":["CatalogueForm","navigate","useNavigate","id","useParams","data","catalogue","isLoading","useGetCatalogueByIdQuery","skip","createCatalogue","useCreateCatalogueMutation","updateCatalogue","useUpdateCatalogueMutation","title","setTitle","useState","catalogueFile","setCatalogueFile","imageFile","setImageFile","useEffect","jsxs","className","children","Breadcrumb","jsx","BreadcrumbItem","BreadcrumbLink","as","Link","to","onSubmit","async","e","preventDefault","formData","FormData","append","unwrap","toast","success","error","Label","htmlFor","Input","value","onChange","target","required","type","accept","files","Button","disabled"],"mappings":"8WASA,MAAMA,EAAgB,KACpB,MAAMC,EAAWC,KACXC,GAAEA,GAAOC,KACPC,KAAMC,EAAAC,UAAWA,GAAcC,EAAyBL,EAAI,CAAEM,MAAON,KACtEO,GAAmBC,KACnBC,GAAmBC,KAEnBC,EAAOC,GAAYC,EAAAA,SAAS,KAC5BC,EAAeC,GAAoBF,EAAAA,SAAS,OAC5CG,EAAWC,GAAgBJ,EAAAA,SAAS,MAE3CK,EAAAA,WAAU,KACJf,GACOS,EAAAT,EAAUQ,OAAS,GAAE,GAE/B,CAACR,IAgCF,OAAAgB,EAAAA,KAAC,MAAI,CAAAC,UAAU,qDACbC,SAAA,CAACF,EAAAA,KAAAG,EAAA,CAAWF,UAAU,OACpBC,SAAA,CAACE,EAAAA,IAAAC,EAAA,CACCH,eAACI,EAAe,CAAAC,GAAIC,EAAMC,GAAG,aAAaP,yBAE5CE,EAAAA,IAACC,GACCH,SAACE,EAAAA,IAAAE,EAAA,CAAeC,GAAIC,EAAMC,GAAG,mBAAmBP,SAAA,sBAEjDE,EAAAA,IAAAC,EAAA,CAAgBH,SAAKrB,EAAA,iBAAmB,wBAG1CmB,EAAAA,KAAA,OAAA,CAAKU,SAjCWC,MAAOC,IAC1BA,EAAEC,iBACI,MAAAC,EAAW,IAAIC,SACZD,EAAAE,OAAO,QAASxB,GACrBG,GAAemB,EAASE,OAAO,UAAWrB,GAC1CE,GAAWiB,EAASE,OAAO,QAASnB,GAEpC,IACEhB,SACIS,EAAgB,CAAET,KAAIiC,aAAYG,SACxCC,EAAMC,QAAQ,0CAER/B,EAAgB0B,GAAUG,SAChCC,EAAMC,QAAQ,mCAEhBxC,EAAS,0BACFyC,GACPF,EAAME,MAAM,2BAA0B,GAgBRnB,UAAU,YACtCC,SAAA,CAAAF,OAAC,MACC,CAAAE,SAAA,CAACE,EAAAA,IAAAiB,EAAA,CAAMC,QAAQ,QAAQpB,SAAK,UAC3BE,EAAAA,IAAAmB,EAAA,CAAM1C,GAAG,QAAQ2C,MAAOhC,EAAOiC,SAAWb,GAAMnB,EAASmB,EAAEc,OAAOF,OAAQG,UAAQ,cAGpF,MACC,CAAAzB,SAAA,CAACE,EAAAA,IAAAiB,EAAA,CAAMC,QAAQ,YAAYpB,SAAgB,qBAC3CE,EAAAA,IAACmB,EAAM,CAAA1C,GAAG,YAAY+C,KAAK,OAAOC,OAAO,OAAOJ,SAjD9Bb,IACxBhB,EAAiBgB,EAAEc,OAAOI,MAAM,GAAE,EAgDgDH,UAAQ,cAGrF,MACC,CAAAzB,SAAA,CAACE,EAAAA,IAAAiB,EAAA,CAAMC,QAAQ,QAAQpB,SAAY,iBACnCE,EAAAA,IAACmB,EAAM,CAAA1C,GAAG,QAAQ+C,KAAK,OAAOC,OAAO,UAAUJ,SAlD5Bb,IACzBd,EAAac,EAAEc,OAAOI,MAAM,GAAE,EAiDoDH,UAAQ,OAGrFvB,EAAAA,IAAA2B,EAAA,CAAOH,KAAK,SAAS3B,UAAU,SAAS+B,SAAU/C,EAChDiB,SAAYjB,EAAA,gBAAkBJ,EAAK,SAAW,gBAGrD"}