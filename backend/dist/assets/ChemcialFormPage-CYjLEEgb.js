import{r as e,j as s}from"./react-BfBsRgn0.js";import{C as a,u as l,b as r,c as t}from"./react-hook-form-Dn0Bw783.js";import{a as i}from"./axios-BoylL8Pu.js";import{P as n}from"./prop-types-BgiiqXIo.js";import{x as c,u as o,L as d,I as m,B as u,T as h}from"./index-mCSb4W1J.js";import{C as x,a as g}from"./card--g8pM1Dm.js";import{S as p,a as j,b as y,c as b,d as f}from"./select-BjvvJv_x.js";import{s as v}from"./slugify-BIrg6xww.js";import{X as N,o as _,p as C}from"./lucide-D6BDVLHE.js";import{R as w}from"./react-quill-O9LY_HeH.js";import{a as S,b as k,L as F}from"./react-router-DUJjWq5j.js";import"./classnames-C3ovBj6j.js";import"./react-dom-DwrudmHt.js";import"./scheduler-BFk34ZWe.js";import"./react-redux-DbBiFgqA.js";import"./use-sync-external-store-DdeJV4gQ.js";import"./@reduxjs-UCSEaN3g.js";import"./redux-C5Huw2aR.js";import"./immer-DgfQkf_7.js";import"./redux-thunk-B3S1iNVp.js";import"./reselect-BSOs5pU1.js";import"./js-cookie-BXEMiIsG.js";import"./@radix-ui-BWjeGzol.js";import"./aria-hidden-BHUiN-rI.js";import"./react-remove-scroll-yauc81_r.js";import"./tslib-Bc9CN1Ef.js";import"./react-remove-scroll-bar-BcxDecei.js";import"./react-style-singleton-C1QVuB2c.js";import"./get-nonce-BYiZHLe3.js";import"./use-sidecar-BA4C4RS7.js";import"./use-callback-ref-Cvx1xcTX.js";import"./@floating-ui-BSChQBl3.js";import"./class-variance-authority-DeOWI0hf.js";import"./clsx-BeLtu-UY.js";import"./tailwind-merge-D2VJQb_v.js";import"./cookie-BUTH-fPQ.js";import"./lodash-CtK3uT03.js";import"./quill-CMG--X-K.js";const E=({control:l,chemicalData:r,watch:t,setValue:i})=>{const[n,m]=e.useState([]),[u,h]=e.useState([]),{data:v,isLoading:N}=c(),_=v||[],{data:C,isLoading:w,isSuccess:S,isError:k,error:F}=o(),E=C||[],T=t("category"),D=t("sub_category"),U=t("subsub_category_id");return e.useEffect((()=>{var e;if(!E.length)return;const s=E.find((e=>e._id===T));s&&(m(s.subCategories||[]),i("categorySlug",s.slug));const a=D&&(null==(e=null==s?void 0:s.subCategories)?void 0:e.find((e=>e._id===D)));a&&(h(a.subSubCategory||[]),i("subCategorySlug",a.slug))}),[E,T,D,i]),e.useEffect((()=>{if(!u.length)return;const e=U&&u.find((e=>e._id===U));e&&i("subSubCategorySlug",e.slug)}),[u,U,i]),e.useEffect((()=>{}),[k,F]),e.useEffect((()=>{var e,s;if(r&&r.category&&E.length>0){const a=E.find((e=>e._id===r.category));if(a){m(a.subCategories||[]),i("category",r.category),i("categorySlug",a.slug);const l=null==(e=a.subCategories)?void 0:e.find((e=>e._id===r.sub_category));l&&(h(l.subSubCategory||[]),i("sub_category",r.sub_category),i("subCategorySlug",l.slug));const t=null==(s=null==l?void 0:l.subSubCategory)?void 0:s.find((e=>e._id===r.subsub_category_id));t&&(i("subsub_category_id",r.subsub_category_id),i("subSubCategorySlug",t.slug))}}}),[r,E,i]),s.jsx(x,{className:"w-full max-w-2xl border-none mx-auto shadow-none",children:s.jsx(g,{className:"space-y-6",children:s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(d,{htmlFor:"category",children:"Category"}),s.jsx(a,{name:"category",control:l,rules:{required:"Category is required"},render:({field:e})=>{var a,l;return s.jsxs(p,{value:e.value||"",onValueChange:s=>{const a=E.find((e=>e._id===s));a&&(e.onChange(a._id),i("categorySlug",a.slug))},children:[s.jsx(j,{id:"category",children:s.jsx(y,{children:e.value&&S?null==(a=E.find((s=>s._id===e.value)))?void 0:a.category:r&&(null==(l=r.category)?void 0:l.name)||"Select Category"})}),s.jsx(b,{children:w?s.jsx(f,{value:"loading",disabled:!0,children:"Loading..."}):S&&E.length>0?E.map((e=>s.jsx(f,{value:e._id,children:e.category},e._id))):s.jsx(f,{value:"none",disabled:!0,children:"No categories available"})})]})}})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(d,{htmlFor:"sub_category",children:"Sub Category"}),s.jsx(a,{name:"sub_category",control:l,render:({field:e})=>{var a,l;return s.jsxs(p,{value:e.value||"",onValueChange:s=>{const a=n.find((e=>e._id===s));a&&(e.onChange(a._id),i("subCategorySlug",a.slug))},disabled:!T||0===n.length,children:[s.jsx(j,{id:"sub_category",children:s.jsx(y,{children:e.value&&n.length>0?null==(a=n.find((s=>s._id===e.value)))?void 0:a.category:r&&(null==(l=r.sub_category)?void 0:l.name)||"Select Sub Category"})}),s.jsx(b,{children:n.length>0?n.map((e=>s.jsx(f,{value:e._id,children:e.category},e._id))):s.jsx(f,{value:"none",disabled:!0,children:"No sub-categories available"})})]})}})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(d,{htmlFor:"subsub_category_id",children:"Sub Sub Category"}),s.jsx(a,{name:"subsub_category_id",control:l,render:({field:e})=>{var a,l;return s.jsxs(p,{value:e.value||"",onValueChange:s=>{const a=u.find((e=>e._id===s));a&&(e.onChange(a._id),i("subSubCategorySlug",a.slug))},disabled:!D||0===u.length,children:[s.jsx(j,{id:"subsub_category_id",children:s.jsx(y,{children:e.value&&u.length>0?null==(a=u.find((s=>s._id===e.value)))?void 0:a.category:r&&(null==(l=r.subSubCategory)?void 0:l.category)||"Select Sub Sub Category"})}),s.jsx(b,{children:u.length>0?u.map((e=>s.jsx(f,{value:e._id,children:e.category},e._id))):s.jsx(f,{value:"none",disabled:!0,children:"No sub-sub-categories available"})})]})}})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(d,{htmlFor:"unit",children:"Unit"}),s.jsx(a,{name:"unit",control:l,rules:{required:"Unit is required"},render:({field:e})=>s.jsxs(p,{onValueChange:e.onChange,value:e.value||void 0,children:[s.jsx(j,{id:"unit",children:s.jsx(y,{placeholder:"Select Unit"})}),s.jsx(b,{children:N?s.jsx(f,{value:"loading",children:"Loading..."}):_.map((e=>s.jsx(f,{value:e.name,children:e.name},e._id)))})]})})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(d,{htmlFor:"assay",children:"Assay (%)"}),s.jsx(a,{name:"assay",control:l,render:({field:e})=>s.jsx("div",{children:s.jsx("input",{type:"string",id:"assay",min:"0",max:"100",step:"0.01",value:e.value||0,onChange:s=>e.onChange(s.target.value),className:"w-full border "})})})]})]})})})};E.propTypes={control:n.object.isRequired,chemicalData:n.object,watch:n.func.isRequired,setValue:n.func.isRequired};const T=({control:r,setValue:t})=>{const i=l({control:r,name:"name"});return e.useEffect((()=>{if(i){const e=v(i,{lower:!0,strict:!0,trim:!0});t("slug",e)}}),[i,t]),s.jsx(x,{className:"w-full max-w-2xl mx-auto shadow-none border-none",children:s.jsxs(g,{className:"space-y-3",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(d,{htmlFor:"name",children:"Name"}),s.jsx(a,{name:"name",control:r,rules:{required:"Name is required"},render:({field:e})=>s.jsx(m,{id:"name",...e})})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(d,{htmlFor:"slug",children:"Slug"}),s.jsx(a,{name:"slug",control:r,render:({field:e})=>s.jsx(m,{id:"slug",...e,onChange:s=>{const a=v(s.target.value,{lower:!0,strict:!0,trim:!0});e.onChange(a)}})})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(d,{htmlFor:"chemical_type",children:"Chemical Type"}),s.jsx(a,{name:"chemical_type",control:r,render:({field:e})=>s.jsx(m,{id:"chemical_type",...e})})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(d,{htmlFor:"cas_number",children:"CAS Number"}),s.jsx(a,{name:"cas_number",control:r,render:({field:e})=>s.jsx(m,{id:"cas_number",...e})})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(d,{htmlFor:"iupac",children:"IUPAC Name"}),s.jsx(a,{name:"iupac",control:r,render:({field:e})=>s.jsx(m,{id:"iupac",...e})})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(d,{htmlFor:"molecular_formula",children:"Molecular Formula"}),s.jsx(a,{name:"molecular_formula",control:r,render:({field:e})=>s.jsx(m,{id:"molecular_formula",...e})})]})]})})},D=({control:l,watch:r})=>{const[t,i]=e.useState({specs:!1,msds:!1}),n=r("specs"),c=r("msds"),o=(e,s="specs")=>{if(e){const a="msds"===s?"msds":"specs",l=e.split(".")[0];window.open(`/api/image/${a}/view/${l}`,"_blank")}};return s.jsx(x,{className:"w-full max-w-2xl mx-auto border-none shadow-none",children:s.jsxs(g,{className:"space-y-3",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(d,{htmlFor:"packings",children:"Packings"}),s.jsx(a,{name:"packings",control:l,defaultValue:[],render:({field:e})=>s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex gap-2",children:[s.jsx(m,{placeholder:"Enter packing (e.g., 25kg)",onKeyDown:s=>{if("Enter"===s.key){s.preventDefault();const a=s.target.value.trim();a&&!e.value.includes(a)&&(e.onChange([...e.value,a]),s.target.value="")}}}),s.jsx(u,{type:"button",onClick:s=>{const a=s.currentTarget.previousSibling,l=a.value.trim();l&&!e.value.includes(l)&&(e.onChange([...e.value,l]),a.value="")},children:"Add"})]}),s.jsx("div",{className:"flex flex-wrap gap-2",children:Array.isArray(e.value)&&e.value.map(((a,l)=>s.jsxs("div",{className:"flex items-center gap-1 bg-secondary px-2 py-1 rounded-md",children:[s.jsx("span",{children:a}),s.jsx("button",{type:"button",onClick:()=>{const s=e.value.filter(((e,s)=>s!==l));e.onChange(s)},className:"text-muted-foreground hover:text-foreground",children:s.jsx(N,{className:"h-4 w-4"})})]},l)))})]})})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(d,{htmlFor:"grade",children:"Grade"}),s.jsx(a,{name:"grade",control:l,render:({field:e})=>s.jsx(m,{id:"grade",placeholder:"Enter grade",...e})})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(d,{htmlFor:"iupac",children:"IUPAC Name"}),s.jsx(a,{name:"iupac",control:l,render:({field:e})=>s.jsx(m,{id:"iupac",placeholder:"Enter IUPAC name",...e})})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(d,{htmlFor:"h_s_code",children:"HS Code"}),s.jsx(a,{name:"h_s_code",control:l,render:({field:e})=>s.jsx(m,{id:"h_s_code",placeholder:"Enter HS code",...e})})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(d,{htmlFor:"molecular_weight",children:"Molecular Weight"}),s.jsx(a,{name:"molecular_weight",control:l,render:({field:e})=>s.jsx(m,{id:"molecular_weight",type:"number",placeholder:"Enter molecular weight",...e})})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(d,{htmlFor:"molecular_formula",children:"Molecular Formula"}),s.jsx(a,{name:"molecular_formula",control:l,render:({field:e})=>s.jsx(m,{id:"molecular_formula",placeholder:"Enter molecular formula",...e})})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(d,{htmlFor:"application",children:"Applications"}),s.jsx(a,{name:"application",control:l,defaultValue:[],render:({field:e})=>s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex gap-2",children:[s.jsx(m,{placeholder:"Enter application",onKeyDown:s=>{if("Enter"===s.key){s.preventDefault();const a=s.target.value.trim();a&&!e.value.includes(a)&&(e.onChange([...e.value,a]),s.target.value="")}}}),s.jsx(u,{type:"button",onClick:s=>{const a=s.currentTarget.previousSibling,l=a.value.trim();l&&!e.value.includes(l)&&(e.onChange([...e.value,l]),a.value="")},children:"Add"})]}),s.jsx("div",{className:"flex flex-wrap gap-2",children:Array.isArray(e.value)&&e.value.map(((a,l)=>s.jsxs("div",{className:"flex items-center gap-1 bg-secondary px-2 py-1 rounded-md",children:[s.jsx("span",{children:a}),s.jsx("button",{type:"button",onClick:()=>{const s=e.value.filter(((e,s)=>s!==l));e.onChange(s)},className:"text-muted-foreground hover:text-foreground",children:s.jsx(N,{className:"h-4 w-4"})})]},l)))})]})})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(d,{htmlFor:"specs",children:"Specifications (PDF)"}),s.jsx(a,{name:"specs",control:l,render:({field:{value:e,onChange:a,...l}})=>s.jsxs("div",{className:"space-y-2",children:["string"==typeof n&&n&&s.jsxs("div",{className:"flex items-center gap-2 p-2 bg-secondary rounded-md",children:[s.jsx(_,{className:"h-4 w-4"}),s.jsx("span",{className:"text-sm truncate",children:n}),s.jsx(u,{type:"button",variant:"ghost",size:"sm",onClick:()=>o(n,"specs"),children:s.jsx(C,{className:"h-4 w-4"})}),s.jsx(u,{type:"button",variant:"ghost",size:"sm",onClick:()=>a(""),children:s.jsx(N,{className:"h-4 w-4"})})]}),s.jsx(m,{id:"specs",type:"file",accept:".pdf",disabled:t.specs,onChange:async e=>{var s;const l=null==(s=e.target.files)?void 0:s[0];l&&(i((e=>({...e,specs:!0}))),a(l),i((e=>({...e,specs:!1}))))},...l}),t.specs&&s.jsx("p",{className:"text-sm text-muted-foreground",children:"Uploading specification file..."})]})})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(d,{htmlFor:"msds",children:"MSDS (PDF)"}),s.jsx(a,{name:"msds",control:l,render:({field:{value:e,onChange:a,...l}})=>s.jsxs("div",{className:"space-y-2",children:["string"==typeof c&&c&&s.jsxs("div",{className:"flex items-center gap-2 p-2 bg-secondary rounded-md",children:[s.jsx(_,{className:"h-4 w-4"}),s.jsx("span",{className:"text-sm truncate",children:c}),s.jsx(u,{type:"button",variant:"ghost",size:"sm",onClick:()=>o(c,"msds"),children:s.jsx(C,{className:"h-4 w-4"})}),s.jsx(u,{type:"button",variant:"ghost",size:"sm",onClick:()=>a(""),children:s.jsx(N,{className:"h-4 w-4"})})]}),s.jsx(m,{id:"msds",type:"file",accept:".pdf",disabled:t.msds,onChange:async e=>{var s;const l=null==(s=e.target.files)?void 0:s[0];l&&(i((e=>({...e,msds:!0}))),a(l),i((e=>({...e,msds:!1}))))},...l}),t.msds&&s.jsx("p",{className:"text-sm text-muted-foreground",children:"Uploading MSDS file..."})]})})]})]})})};D.propTypes={control:n.object.isRequired,watch:n.func},D.defaultProps={watch:()=>{}};const U=({control:e})=>s.jsx(x,{className:"w-full max-w-2xl mx-auto border-none shadow-none",children:s.jsxs(g,{className:"space-y-3",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(d,{htmlFor:"metatitle",children:"Meta Title"}),s.jsx(a,{name:"metatitle",control:e,render:({field:e})=>s.jsx(m,{id:"metatitle",placeholder:"Enter meta title",...e})})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(d,{htmlFor:"metadescription",children:"Meta Description"}),s.jsx(a,{name:"metadescription",control:e,render:({field:e})=>s.jsx(h,{id:"metadescription",placeholder:"Enter meta description",...e,rows:3})})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(d,{htmlFor:"metakeywords",children:"Meta Keywords"}),s.jsx(a,{name:"metakeywords",control:e,render:({field:e})=>s.jsx(m,{id:"metakeywords",placeholder:"Enter meta keywords",...e})})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(d,{htmlFor:"metacanonical",children:"Meta Canonical URL"}),s.jsx(a,{name:"metacanonical",control:e,render:({field:e})=>s.jsx(m,{id:"metacanonical",placeholder:"Enter canonical URL",...e})})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(d,{htmlFor:"metalanguage",children:"Meta Language"}),s.jsx(a,{name:"metalanguage",control:e,render:({field:e})=>s.jsx(m,{id:"metalanguage",placeholder:"Enter language code (e.g., en-US)",...e})})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(d,{htmlFor:"metaschema",children:"Meta Schema"}),s.jsx(a,{name:"metaschema",control:e,render:({field:e})=>s.jsx(h,{id:"metaschema",placeholder:"Enter JSON-LD schema",...e,rows:4})})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(d,{htmlFor:"otherMeta",children:"Other Meta Information"}),s.jsx(a,{name:"otherMeta",control:e,render:({field:e})=>s.jsx(h,{id:"otherMeta",placeholder:"Enter any additional meta information",...e,rows:3})})]})]})}),A=({control:l,setValue:t})=>{const{fields:i,append:n,remove:c,update:o}=r({control:l,name:"images"}),h={toolbar:[["bold","italic","underline","strike"],["blockquote","code-block"],[{header:1},{header:2}],[{list:"ordered"},{list:"bullet"}],[{script:"sub"},{script:"super"}],[{indent:"-1"},{indent:"+1"}],[{direction:"rtl"}],[{size:["small",!1,"large","huge"]}],[{color:[]},{background:[]}],[{font:[]}],[{align:[]}],["clean"],["link","image"]]},x=["header","font","size","bold","italic","underline","strike","blockquote","list","bullet","indent","link","image","color","background","align","direction","code-block","script"],g=e.useCallback(((e,s)=>{var a,l,r,t;const n=e.target.files[0];if(n){(null==(l=null==(a=i[s])?void 0:a.preview)?void 0:l.startsWith("blob:"))&&URL.revokeObjectURL(i[s].preview);const e=URL.createObjectURL(n);o(s,{...i[s],file:n,preview:e,altText:(null==(r=i[s])?void 0:r.altText)||"",title:(null==(t=i[s])?void 0:t.title)||"",url:null})}}),[i,o]);e.useEffect((()=>()=>{i.forEach((e=>{var s;(null==(s=null==e?void 0:e.preview)?void 0:s.startsWith("blob:"))&&URL.revokeObjectURL(e.preview)}))}),[i]);const p=e.useCallback((e=>{var s,a;(null==(a=null==(s=i[e])?void 0:s.preview)?void 0:a.startsWith("blob:"))&&URL.revokeObjectURL(i[e].preview),i[e]._id&&t(`imagesToDelete.${i[e]._id}`,!0),c(e)}),[i,c,t]);return s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(d,{htmlFor:"global_tagline",children:"Global Tagline"}),s.jsx(a,{name:"global_tagline",control:l,defaultValue:"",render:({field:e})=>s.jsx(m,{id:"global_tagline",placeholder:"Enter global tagline",...e})}),s.jsx("p",{className:"text-xs text-gray-500",children:"A brief tagline that will appear globally."})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(d,{htmlFor:"description",children:"Description"}),s.jsx(a,{name:"description",control:l,defaultValue:"",render:({field:{onChange:e,value:a}})=>s.jsx("div",{className:"quill-container",children:s.jsx(w,{id:"description",theme:"snow",value:a,onChange:e,className:"bg-white",modules:h,formats:x,placeholder:"Enter detailed description..."})})}),s.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Format your content using the toolbar above. Use headings, lists, and formatting to create well-structured content."})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(d,{htmlFor:"synonyms",children:"Synonyms"}),s.jsx(a,{name:"synonyms",control:l,defaultValue:[],render:({field:e})=>s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex gap-2",children:[s.jsx(m,{placeholder:"Enter synonym",onKeyDown:s=>{if("Enter"===s.key){s.preventDefault();const a=s.target.value.trim();a&&!e.value.includes(a)&&(e.onChange([...e.value,a]),s.target.value="")}}}),s.jsx(u,{type:"button",onClick:s=>{const a=s.currentTarget.previousSibling,l=a.value.trim();l&&!e.value.includes(l)&&(e.onChange([...e.value,l]),a.value="")},children:"Add"})]}),s.jsx("div",{className:"flex flex-wrap gap-2",children:Array.isArray(e.value)&&e.value.map(((a,l)=>s.jsxs("div",{className:"flex items-center gap-1 bg-secondary px-2 py-1 rounded-md",children:[s.jsx("span",{children:a}),s.jsx("button",{type:"button",onClick:()=>{const s=e.value.filter(((e,s)=>s!==l));e.onChange(s)},className:"text-muted-foreground hover:text-foreground",children:s.jsx(N,{className:"h-4 w-4"})})]},l)))})]})})]}),s.jsx(d,{children:"Images"}),i.map(((e,r)=>s.jsxs("div",{className:"space-y-2 border p-4 rounded-lg",children:[e.preview||e.url?s.jsx("img",{src:e.preview||`/api/image/download/${e.url}`,alt:e.altText||"Image preview",className:"w-32 h-32 object-cover rounded border"}):s.jsx("div",{className:"w-32 h-32 flex items-center justify-center border rounded bg-gray-100",children:"No Preview"}),s.jsx("input",{type:"file",onChange:e=>g(e,r),accept:"image/*",className:"block w-full text-sm text-gray-500\r\n                file:mr-4 file:py-2 file:px-4\r\n                file:rounded-full file:border-0\r\n                file:text-sm file:font-semibold\r\n                file:bg-blue-50 file:text-blue-700\r\n                hover:file:bg-blue-100"}),s.jsx(d,{htmlFor:`alt-text-${r}`,children:"Alt Text"}),s.jsx(a,{name:`images.${r}.altText`,control:l,defaultValue:e.altText||"",render:({field:e})=>s.jsx(m,{id:`alt-text-${r}`,placeholder:"Alt Text",...e})}),s.jsx(d,{htmlFor:`image-title-${r}`,children:"Image Title"}),s.jsx(a,{name:`images.${r}.title`,control:l,defaultValue:e.title||"",render:({field:e})=>s.jsx(m,{id:`image-title-${r}`,placeholder:"Image Title",...e})}),s.jsx("button",{type:"button",onClick:()=>p(r),className:"text-red-600 hover:underline",children:"Remove"})]},e.id))),s.jsx("button",{type:"button",onClick:()=>n({file:null,preview:null,altText:"",title:"",url:null}),className:"px-4 py-2 mt-4 text-sm font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Add Image"})]})},V=()=>{const{control:a,handleSubmit:l,watch:r,setValue:n}=t({defaultValues:{category:"",sub_category:"",subsub_category_id:"",categorySlug:"",subCategorySlug:"",subSubCategorySlug:"",name:"",slug:"",images:[],catalog:"",msds:"",specs:"",unit:"",chemical_type:"",cas_number:"",packings:[],grade:"",iupac:"",h_s_code:"",molecular_weight:"",molecular_formula:"",synonyms:[],application:[],chemical_industries:[],product_code:"",auto_p_code:"",packing:"",hs_code:"",assay:"",metatitle:"",metadescription:"",metakeywords:"",metacanonical:"",metalanguage:"",metaschema:"",otherMeta:"",imagesToDelete:{}}}),c=S(),{id:o}=k(),[d,m]=e.useState(!1),[h,x]=e.useState(null);e.useEffect((()=>{(async()=>{if(o){m(!0);try{const e=(await i.get(`/api/chemical/getChemicalById?id=${o}`)).data;x(e),e.category&&(n("category",e.category._id),n("categorySlug",e.category.slug)),e.sub_category&&(n("sub_category",e.sub_category._id),n("subCategorySlug",e.sub_category.slug)),e.subsub_category_id&&(n("subsub_category_id","object"==typeof e.subsub_category_id?e.subsub_category_id._id:e.subsub_category_id),n("subSubCategorySlug",e.subsub_category_id.slug||"")),Object.entries(e).forEach((([e,s])=>{"category"!==e&&"sub_category"!==e&&"subsub_category_id"!==e&&"images"!==e&&n(e,s)})),e.images&&e.images.length>0&&n("images",e.images)}catch(e){}finally{m(!1)}}})()}),[o,n]);return d?s.jsx("div",{children:"Loading existing chemical data..."}):s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"mb-4 flex items-center text-sm text-gray-500",children:[s.jsx(F,{to:"/",className:"hover:text-purple-600",children:"Home"}),s.jsx("span",{className:"mx-2",children:"/"}),s.jsx(F,{to:"/chemical-table",className:"hover:text-purple-600",children:"Chemicals"}),s.jsx("span",{className:"mx-2",children:"/"}),s.jsx("span",{className:"text-gray-900",children:o?"Edit Chemical":"New Chemical"})]}),s.jsxs("form",{onSubmit:l((async e=>{try{const s=new FormData;let a;e.images.forEach(((e,a)=>{e.file instanceof File?(s.append("images",e.file),s.append(`altText-${a}`,e.altText||""),s.append(`title-${a}`,e.title||"")):e.url&&(s.append(`existingImages[${a}][url]`,e.url),s.append(`existingImages[${a}][altText]`,e.altText||""),s.append(`existingImages[${a}][title]`,e.title||""))})),Object.keys(e.imagesToDelete).forEach((e=>{s.append("imagesToDelete[]",e)})),Object.entries(e).forEach((([e,a])=>{"images"!==e&&"imagesToDelete"!==e&&null!=a&&""!==a&&(Array.isArray(a)?a.forEach(((a,l)=>{s.append(`${e}[${l}]`,a)})):"molecular_weight"===e&&a?s.append(e,Number(a)):s.append(e,a))})),a=o?await i.put(`/api/chemical/updateChemicalById?id=${o}`,s,{headers:{"Content-Type":"multipart/form-data"}}):await i.post("/api/chemical/add",s,{headers:{"Content-Type":"multipart/form-data"}}),c("/chemical-table")}catch(s){}})),className:"space-y-6 bg-white",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-2 gap-6",children:[s.jsxs("div",{className:"border p-4 rounded-lg",children:[s.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Category Information"}),s.jsx(E,{control:a,watch:r,setValue:n,chemicalData:h})]}),s.jsxs("div",{className:"border p-4 rounded-lg",children:[s.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Chemical Details"}),s.jsx(T,{control:a,setValue:n,chemicalData:h})]}),s.jsxs("div",{className:"border p-4 rounded-lg",children:[s.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Chemical Properties"}),s.jsx(D,{control:a,chemicalData:h})]}),s.jsxs("div",{className:"border p-4 rounded-lg",children:[s.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Image Upload"}),s.jsx(A,{control:a,setValue:n,chemicalData:h})]}),s.jsxs("div",{className:"border p-4 rounded-lg",children:[s.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Meta Information"}),s.jsx(U,{control:a,chemicalData:h})]})]}),s.jsx("div",{className:"flex justify-center mt-6",children:s.jsx(u,{type:"submit",className:"px-8 py-3 w-1/4 text-white rounded-md hover:bg-purple-700 transition duration-300 ease-in-out transform hover:scale-105",children:o?"Update Chemical":"Submit Chemical"})})]})]})};export{V as ChemicalFormPage,V as default};
