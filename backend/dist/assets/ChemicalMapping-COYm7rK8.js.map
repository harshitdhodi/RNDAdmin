{"version":3,"file":"ChemicalMapping-COYm7rK8.js","sources":["../../src/customer/components/ChemicalTable.jsx","../../src/customer/components/ChemicalSearch.jsx","../../src/customer/components/CustomerSearch.jsx","../../src/customer/ChemicalMapping.jsx"],"sourcesContent":["'use client'\r\n\r\nimport React, { useState } from 'react'\r\nimport { Table } from '@/components/ui/table'\r\nimport { Button } from '@/components/ui/button'\r\nimport { Card } from '@/components/ui/card'\r\nimport { Select } from '@/components/ui/select'\r\nimport { Trash2 } from 'lucide-react'\r\n\r\nexport function ChemicalTable({ chemicals, onRemoveChemical }) {\r\n  const [page, setPage] = useState(1)\r\n  const [itemsPerPage, setItemsPerPage] = useState(10)\r\n\r\n  const totalPages = Math.ceil((chemicals?.length || 0) / itemsPerPage)\r\n  const startIndex = (page - 1) * itemsPerPage\r\n  const endIndex = startIndex + itemsPerPage\r\n  const currentChemicals = chemicals?.slice(startIndex, endIndex)\r\n\r\n  const columns = [\r\n    {\r\n      header: 'Action',\r\n      accessorKey: 'action',\r\n      cell: ({ row }) => (\r\n        <Button size='icon' variant='destructive' onClick={() => onRemoveChemical(row.original)}>\r\n          <Trash2 className='h-4 w-4' />\r\n        </Button>\r\n      ),\r\n    },\r\n    {\r\n      header: 'Chemical Name',\r\n      accessorKey: 'name',\r\n    },\r\n    {\r\n      header: 'CAS Number',\r\n      accessorKey: 'cas_number',\r\n    },\r\n  ]\r\n\r\n  return (\r\n    <Card className='p-5 space-y-4'>\r\n      <Table columns={columns} data={currentChemicals || []} />\r\n      <div className='flex items-center justify-between mt-4'>\r\n        <div className='text-sm text-gray-500'>\r\n          Items per page:{' '}\r\n          <Select\r\n            value={itemsPerPage}\r\n            onValueChange={(value) => {\r\n              setItemsPerPage(Number(value))\r\n              setPage(1)\r\n            }}\r\n            options={[\r\n              { value: 10, label: '10' },\r\n              { value: 20, label: '20' },\r\n              { value: 50, label: '50' },\r\n            ]}\r\n            className='w-20'\r\n          />\r\n        </div>\r\n        <div className='flex gap-2'>\r\n          <Button variant='outline' size='sm' onClick={() => setPage(page - 1)} disabled={page === 1}>\r\n            Previous\r\n          </Button>\r\n          <span className='text-sm text-gray-500'>\r\n            {startIndex + 1} - {Math.min(endIndex, chemicals?.length || 0)} of {chemicals?.length || 0}\r\n          </span>\r\n          <Button variant='outline' size='sm' onClick={() => setPage(page + 1)} disabled={page === totalPages}>\r\n            Next\r\n          </Button>\r\n        </div>\r\n      </div>\r\n    </Card>\r\n  )\r\n}\r\n","import React, { useState } from 'react';\r\nimport { Input } from '@/components/ui/input';\r\nimport { useGetChemicalsByAlphabetQuery } from '@/slice/supplierSlice/chemicalBySupplier';\r\nimport { useAddChemicalToCustomerMutation } from '@/slice/customerSlice/customerApiSlice';\r\nimport { Button } from '@/components/ui/button';\r\nimport { toast } from 'react-toastify';\r\n\r\nexport function ChemicalSearch({ selectedCustomer, refetchCustomer }) {\r\n  const [chemicalSearch, setChemicalSearch] = useState('');\r\n  const [queryString, setQueryString] = useState('');\r\n  const [selectedChemical, setSelectedChemical] = useState(null);\r\n\r\n  const { data: chemicals, isLoading: isLoadingChemicals } = useGetChemicalsByAlphabetQuery(\r\n    queryString.charAt(0),\r\n    { skip: queryString.length === 0 }\r\n  );\r\n\r\n  const [addChemicalToCustomer, { isLoading: isAdding }] = useAddChemicalToCustomerMutation();\r\n\r\n  const handleInputChange = (e) => {\r\n    const value = e.target.value;\r\n    setChemicalSearch(value);\r\n    setQueryString(value);\r\n  };\r\n\r\n  const handleSelectChemical = (chemical) => {\r\n    setSelectedChemical(chemical);\r\n    setChemicalSearch(chemical.name);\r\n    setQueryString('');\r\n  };\r\n\r\n  const handleAddChemical = async () => {\r\n    if (!selectedChemical || !selectedCustomer) {\r\n      toast.error('Please select both customer and chemical');\r\n      return;\r\n    }\r\n\r\n    try {\r\n      const chemicalId = selectedChemical.id || selectedChemical._id;\r\n      const customerId = selectedCustomer._id;\r\n\r\n      await addChemicalToCustomer({\r\n        customerId,\r\n        chemicalId,\r\n      }).unwrap();\r\n\r\n      // Reset form and refetch data\r\n      setChemicalSearch('');\r\n      setSelectedChemical(null);\r\n      await refetchCustomer();\r\n      \r\n      toast.success('Chemical added successfully');\r\n    } catch (error) {\r\n      toast.error(error.message || 'Failed to add chemical');\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"mt-4\">\r\n      <div className=\"relative\">\r\n        <Input\r\n          placeholder=\"Search Chemical\"\r\n          value={chemicalSearch}\r\n          onChange={handleInputChange}\r\n          className=\"w-full mb-4\"\r\n          disabled={!selectedCustomer}\r\n        />\r\n        {isLoadingChemicals && (\r\n          <div className=\"absolute top-2 right-4 text-sm text-gray-500\">\r\n            Loading...\r\n          </div>\r\n        )}\r\n      </div>\r\n\r\n      {queryString && chemicals?.length > 0 && (\r\n        <ul className=\"border bg-white rounded max-h-40 overflow-y-auto\">\r\n          {chemicals.map((chemical) => (\r\n            <li\r\n              key={chemical._id}\r\n              onClick={() => handleSelectChemical(chemical)}\r\n              className=\"p-2 hover:bg-gray-200 cursor-pointer\"\r\n            >\r\n              {chemical.name}\r\n            </li>\r\n          ))}\r\n        </ul>\r\n      )}\r\n\r\n      <Button\r\n        onClick={handleAddChemical}\r\n        disabled={isAdding || !selectedChemical || !selectedCustomer}\r\n        className=\"mt-4 w-[10%] py-2 bg-blue-500 text-white rounded hover:bg-blue-600\"\r\n      >\r\n        {isAdding ? 'Adding...' : 'Add '}\r\n      </Button>\r\n    </div>\r\n  );\r\n}\r\n","import React, { useState } from 'react'\r\nimport { Input } from '@/components/ui/input'\r\nimport { useGetCustomersByAlphabetQuery, useGetCustomerByIdQuery } from '@/slice/customerSlice/customerApiSlice'\r\nimport { useRemoveChemicalFromCustomerMutation } from '@/slice/customerSlice/customerApiSlice'\r\nimport { ChemicalTable } from './ChemicalTable'\r\nimport { ChemicalSearch } from './ChemicalSearch'\r\nimport { toast } from 'react-toastify'\r\n\r\nexport function CustomerSearch({ onSelectCustomer }) {\r\n  const [customerSearch, setCustomerSearch] = useState('')\r\n  const [queryString, setQueryString] = useState('')\r\n  const [selectedCustomer, setSelectedCustomer] = useState(null)\r\n\r\n  // Fetch customers based on the first letter of the query string\r\n  const { data: customers, isLoading: isLoadingCustomers, refetch: refetchCustomers } = useGetCustomersByAlphabetQuery(\r\n    queryString.charAt(0),\r\n    {\r\n      skip: queryString.length === 0,\r\n    }\r\n  );\r\n\r\n  // Fetch selected customer details to keep them updated\r\n  const { data: customerDetails, refetch: refetchCustomer } = useGetCustomerByIdQuery(\r\n    selectedCustomer?._id,\r\n    {\r\n      skip: !selectedCustomer?._id,\r\n    }\r\n  );\r\n\r\n  const [removeChemicalFromCustomer] = useRemoveChemicalFromCustomerMutation()\r\n\r\n  const handleSelectCustomer = (customer) => {\r\n    setSelectedCustomer(customer)\r\n    setCustomerSearch(customer.name)\r\n    setQueryString('')\r\n    onSelectCustomer(customer)\r\n  }\r\n\r\n  const handleInputChange = (e) => {\r\n    const value = e.target.value\r\n    setCustomerSearch(value)\r\n    setQueryString(value)\r\n  }\r\n\r\n  const handleRemoveChemical = async (removedChemical) => {\r\n    try {\r\n      await removeChemicalFromCustomer({\r\n        customerId: selectedCustomer._id,\r\n        chemicalId: removedChemical._id\r\n      }).unwrap();\r\n\r\n      // Refetch both customer details and customer list\r\n      await Promise.all([\r\n        refetchCustomer(),\r\n        refetchCustomers()\r\n      ]);\r\n      \r\n      toast.success('Chemical removed successfully');\r\n    } catch (error) {\r\n      console.error('Error removing chemical:', error);\r\n      toast.error('Failed to remove chemical');\r\n    }\r\n  };\r\n\r\n  // Use customerDetails data if available, otherwise use selectedCustomer\r\n  const currentCustomerData = customerDetails?.data || selectedCustomer;\r\n\r\n  return (\r\n    <div className=\"mt-4\">\r\n      <Input\r\n        placeholder=\"Search Customer\"\r\n        value={customerSearch}\r\n        onChange={handleInputChange}\r\n        className=\"w-full mb-4\"\r\n      />\r\n\r\n      {/* Dropdown for Customer Suggestions */}\r\n      {isLoadingCustomers ? (\r\n        <div>Loading...</div>\r\n      ) : (\r\n        queryString &&\r\n        customers &&\r\n        customers.length > 0 && (\r\n          <ul className=\"border bg-white rounded max-h-40 overflow-y-auto\">\r\n            {customers.map((customer) => (\r\n              <li\r\n                key={customer._id}\r\n                onClick={() => handleSelectCustomer(customer)}\r\n                className=\"p-2 hover:bg-gray-200 cursor-pointer\"\r\n              >\r\n                {customer.name}\r\n              </li>\r\n            ))}\r\n          </ul>\r\n        )\r\n      )}\r\n\r\n      {/* ChemicalSearch Component */}\r\n      <ChemicalSearch \r\n        selectedCustomer={currentCustomerData} \r\n        refetchCustomer={async () => {\r\n          await Promise.all([\r\n            refetchCustomer(),\r\n            refetchCustomers()\r\n          ]);\r\n        }}\r\n      />\r\n\r\n      {/* ChemicalTable Component */}\r\n      {currentCustomerData && (\r\n        <ChemicalTable \r\n          chemicals={currentCustomerData.chemicalId || []} \r\n          onRemoveChemical={handleRemoveChemical}\r\n        />\r\n      )}\r\n    </div>\r\n  )\r\n}\r\n","'use client'\r\n\r\nimport React from 'react'\r\nimport { CustomerSearch } from './components/CustomerSearch'\r\n// import { ChemicalSearch } from './components/ChemicalSearch'\r\nimport { ChemicalTable } from './components/ChemicalTable'\r\nimport { Button } from '@/components/ui/button'\r\nimport { BreadcrumbWithCustomSeparator } from '@/breadCrumb/BreadCrumb'\r\n\r\nconst breadcrumbItems = [\r\n  { label: \"Dashboard\", href: \"/dashboard\" },\r\n  { label: \"Chemical Mapping\", href: null },\r\n]\r\nexport default function AssignChemicals() {\r\n  const [selectedCustomer, setSelectedCustomer] = React.useState(null)\r\n  const [chemicals, setChemicals] = React.useState([])\r\n\r\n  const handleSelectCustomer = (customer) => {\r\n    setSelectedCustomer(customer)\r\n    setChemicals([])\r\n  }\r\n  return (\r\n    <>\r\n    <div className=\"ml-1\">\r\n              <BreadcrumbWithCustomSeparator items={breadcrumbItems} />\r\n        \r\n            </div>\r\n    <div className=\"py-4 space-y-6\">\r\n\r\n      <h1 className=\"text-2xl font-bold text-purple-700\">\r\n        Assign Chemicals to Customer\r\n      </h1>\r\n\r\n      <div className=\"space-y-4\">\r\n        <CustomerSearch onSelectCustomer={handleSelectCustomer} />\r\n\r\n        \r\n        \r\n \r\n       \r\n      </div>\r\n    </div>\r\n    </>\r\n  )\r\n}\r\n"],"names":["ChemicalTable","chemicals","onRemoveChemical","page","setPage","useState","itemsPerPage","setItemsPerPage","totalPages","Math","ceil","length","startIndex","endIndex","currentChemicals","slice","columns","header","accessorKey","cell","row","jsx","Button","size","variant","onClick","original","children","Trash2","className","jsxs","Card","Table","data","Select","value","onValueChange","Number","options","label","disabled","min","ChemicalSearch","selectedCustomer","refetchCustomer","chemicalSearch","setChemicalSearch","queryString","setQueryString","selectedChemical","setSelectedChemical","isLoading","isLoadingChemicals","useGetChemicalsByAlphabetQuery","charAt","skip","addChemicalToCustomer","isAdding","useAddChemicalToCustomerMutation","Input","placeholder","onChange","e","target","map","chemical","name","handleSelectChemical","_id","async","chemicalId","id","customerId","unwrap","toast","success","error","message","CustomerSearch","onSelectCustomer","customerSearch","setCustomerSearch","setSelectedCustomer","customers","isLoadingCustomers","refetch","refetchCustomers","useGetCustomersByAlphabetQuery","customerDetails","useGetCustomerByIdQuery","removeChemicalFromCustomer","useRemoveChemicalFromCustomerMutation","currentCustomerData","customer","handleSelectCustomer","Promise","all","removedChemical","breadcrumbItems","href","AssignChemicals","React","setChemicals","Fragment","BreadcrumbWithCustomSeparator","items"],"mappings":"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"}