import{p as e,j as s,I as a,B as l,t as i,T as r,U as t}from"./main-BcUd3ASm.js";import{r as c,R as n}from"./vendor-router-CaZtIe2_.js";import{a as d}from"./vendor-utils-CfKmydC0.js";import{T as o,a as h,b as m,c as u,d as x,e as p}from"./table-DnBX1p3B.js";import{A as j,a as g,b as v,c as f,d as N,e as b,f as y,g as S}from"./alert-dialog-BQISGsdK.js";import{S as C,a as w,b as A,c as k,d as _}from"./select-Dc7LnXRO.js";import{P as I,a as L,b as M,c as R,d as D,e as $}from"./pagination-kOtHPq3f.js";import"./vendor-react-DD_RYU77.js";import"./index-CMYgmcqM.js";import"./index-BY97PVuz.js";import"./check-CxfHQWmE.js";import"./chevron-up-BAx2OvKy.js";import"./chevron-left-1VOK-MTw.js";import"./chevron-right-C95tp0e6.js";function B({selectedSupplier:i,onAddChemical:r}){const[t,n]=c.useState(""),[o,h]=c.useState(""),[m,u]=c.useState(null),[x,p]=c.useState([]),[j,g]=c.useState(!1),[v,{isLoading:f}]=e();return s.jsxs("div",{className:"mt-4",children:[s.jsxs("div",{className:"relative",children:[s.jsx(a,{placeholder:"Search Chemical",value:t,onChange:e=>{const s=e.target.value;n(s),s.trim()?(h(s),(async e=>{if(e){g(!0);try{const s=await d.get(`/api/chemical/getChemicalByCategoryAndAlphabet?alphabet=${e}`);p(s.data)}catch(s){p([])}finally{g(!1)}}})(s.charAt(0))):(h(""),p([]))},className:"w-full mb-4",disabled:!i}),j&&s.jsx("div",{className:"absolute top-2 right-4 text-sm text-gray-500",children:"Loading..."})]}),o&&x?.length>0&&s.jsx("ul",{className:"border bg-white rounded max-h-40 overflow-y-auto",children:x.map((e=>s.jsx("li",{onClick:()=>(e=>{u(e),n(e.name),h("")})(e),className:"p-2 hover:bg-gray-200 cursor-pointer border-b last:border-b-0",children:e.name},e._id)))}),0===x?.length&&!j&&o&&s.jsx("div",{className:"p-2 text-gray-500",children:"No chemicals found"}),s.jsx(l,{onClick:async()=>{if(m&&i)try{const e=m._id,s=i._id;await v({supplierId:s,chemical_ids:[e]}).unwrap(),u(null),n(""),r&&r()}catch(e){alert(`Failed to add chemical: ${e.message||"Unknown error occurred"}`)}},disabled:f||!m||!i,className:"mt-4 w-fit py-2 bg-blue-500 text-white rounded hover:bg-blue-600 "+(f?"opacity-50 cursor-not-allowed":""),children:f?"Adding...":"Add Chemical"})]})}function F({chemicals:e,refetch:a,supplierId:r,onRemoveChemical:t}){const[n,d]=c.useState(1),[B,F]=c.useState(10),[T]=i(),[U,z]=c.useState(null),[E,J]=c.useState(!1),K=Math.ceil(e.length/B),O=(n-1)*B,P=O+B,V=e.slice(O,P),q=e=>{d(e)};return s.jsxs("div",{className:"border rounded-md mt-4 p-4",children:[s.jsxs(o,{children:[s.jsx(h,{children:s.jsxs(m,{children:[s.jsx(u,{className:"w-[100px]",children:"Action"}),s.jsx(u,{children:"Chemical Name"}),s.jsx(u,{children:"CAS Number"})]})}),s.jsx(x,{children:V.map((e=>s.jsxs(m,{children:[s.jsx(p,{children:s.jsx(l,{variant:"destructive",size:"sm",onClick:()=>(e=>{z(e),J(!0)})(e),children:"Delete"})}),s.jsx(p,{children:e.name}),s.jsx(p,{children:e.cas_number})]},e._id)))})]}),s.jsxs("div",{className:"flex items-center justify-end space-x-4 py-4",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("span",{className:"text-sm text-muted-foreground",children:"Rows per page"}),s.jsxs(C,{value:B.toString(),onValueChange:e=>{F(Number(e)),d(1)},children:[s.jsx(w,{className:"h-8 w-[70px]",children:s.jsx(A,{placeholder:B})}),s.jsxs(k,{children:[s.jsx(_,{value:"10",children:"10"}),s.jsx(_,{value:"20",children:"20"}),s.jsx(_,{value:"30",children:"30"}),s.jsx(_,{value:"40",children:"40"}),s.jsx(_,{value:"50",children:"50"})]})]})]}),s.jsx("div",{className:"flex items-center justify-end",children:s.jsx(I,{children:s.jsxs(L,{children:[s.jsx(M,{children:s.jsx(R,{onClick:()=>q(Math.max(1,n-1)),className:1===n?"pointer-events-none opacity-50":"cursor-pointer"})}),Array.from({length:Math.min(5,K)},((e,a)=>{let l;return l=K<=5||n<=3?a+1:n>=K-2?K-4+a:n-2+a,s.jsx(M,{children:s.jsx(D,{onClick:()=>q(l),isActive:n===l,children:l})},a)})),s.jsx(M,{children:s.jsx($,{onClick:()=>q(Math.min(K,n+1)),className:n===K?"pointer-events-none opacity-50":"cursor-pointer"})})]})})})]}),s.jsx(j,{open:E,onOpenChange:J,children:s.jsxs(g,{children:[s.jsxs(v,{children:[s.jsx(f,{children:"Confirm Deletion"}),s.jsxs(N,{children:['Are you sure you want to delete "',U?.name,'"?']})]}),s.jsxs(b,{children:[s.jsx(y,{children:"Cancel"}),s.jsx(S,{onClick:async()=>{if(r&&U)try{await T({supplierId:r,chemicalId:U._id}),t(U),a(),J(!1),z(null),1===V.length&&n>1&&d(1)}catch(e){}},className:"bg-red-600 hover:bg-red-700",children:"Delete"})]})]})})]})}function T({onSelectSupplier:e}){const[l,i]=c.useState(""),[n,d]=c.useState(""),[o,h]=c.useState(null),{data:m,isLoading:u}=r(n.charAt(0),{skip:0===n.length}),{data:x,refetch:p,isFetching:j}=t(o?._id,{skip:!o});c.useEffect((()=>{x&&!j&&(h(x),"function"==typeof e&&e(x))}),[x,j,e]);const g=()=>{p()};return s.jsxs("div",{className:"mt-4",children:[s.jsx(a,{placeholder:"Search Supplier",value:l,onChange:e=>{const s=e.target.value;i(s),d(s)},className:"w-full mb-4"}),u?s.jsx("div",{children:"Loading..."}):n&&m&&m.length>0&&s.jsx("ul",{className:"border bg-white rounded max-h-40 overflow-y-auto",children:m.map((a=>s.jsx("li",{onClick:()=>(s=>{h(s),i(s.name),d(""),"function"==typeof e&&e(s)})(a),className:"p-2 hover:bg-gray-200 cursor-pointer",children:a.name},a.id)))}),0===m?.length&&!u&&n&&s.jsx("div",{className:"p-2 text-gray-500",children:"No Supplier found"}),j&&s.jsx("div",{className:"p-2 text-gray-500",children:"Refreshing supplier data..."}),s.jsx(B,{selectedSupplier:o,onAddChemical:g}),s.jsx("div",{className:"mt-4",children:s.jsx(F,{chemicals:o?.chemical_ids||[],refetch:p,onRemoveChemical:g,supplierId:o?._id})})]})}function U(){const[e,a]=n.useState(null),[l,i]=n.useState([]);return s.jsxs("div",{className:"p-6 space-y-6",children:[s.jsx("h1",{className:"text-2xl font-bold text-purple-700",children:"Assign Chemicals to Supplier"}),s.jsx("div",{className:"space-y-4",children:s.jsx(T,{onSelectCustomer:e=>{a(e),i([])}})})]})}export{U as default};
//# sourceMappingURL=ChemicalMapping-CwLGfaFQ.js.map
