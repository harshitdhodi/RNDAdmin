import{r as e,j as s,a as t}from"./react-BfBsRgn0.js";import{F as r,m as i,I as a,B as o,V as l,R as c,s as m}from"./index-mCSb4W1J.js";import{F as n,S as d,a as p,B as j}from"./antd-CxduzDaN.js";import{B as u}from"./react-toastify-DG2TuaTj.js";import{B as h}from"./BreadCrumb-DisBzgy2.js";import"./classnames-C3ovBj6j.js";import"./react-dom-DwrudmHt.js";import"./scheduler-BFk34ZWe.js";import"./react-redux-DbBiFgqA.js";import"./use-sync-external-store-DdeJV4gQ.js";import"./@reduxjs-UCSEaN3g.js";import"./redux-C5Huw2aR.js";import"./immer-DgfQkf_7.js";import"./redux-thunk-B3S1iNVp.js";import"./reselect-BSOs5pU1.js";import"./js-cookie-BXEMiIsG.js";import"./react-router-DUJjWq5j.js";import"./cookie-BUTH-fPQ.js";import"./@radix-ui-BWjeGzol.js";import"./aria-hidden-BHUiN-rI.js";import"./react-remove-scroll-yauc81_r.js";import"./tslib-Bc9CN1Ef.js";import"./react-remove-scroll-bar-BcxDecei.js";import"./react-style-singleton-C1QVuB2c.js";import"./get-nonce-BYiZHLe3.js";import"./use-sidecar-BA4C4RS7.js";import"./use-callback-ref-Cvx1xcTX.js";import"./@floating-ui-BSChQBl3.js";import"./class-variance-authority-DeOWI0hf.js";import"./clsx-BeLtu-UY.js";import"./tailwind-merge-D2VJQb_v.js";import"./lucide-D6BDVLHE.js";import"./axios-BoylL8Pu.js";import"./@ant-design-DttPmOfw.js";import"./rc-util-CQtTJgfq.js";import"./@babel-BfC2A0EA.js";import"./react-is-BaRe0U6l.js";import"./@emotion-Czw0TW3x.js";import"./stylis-IVPcsLSI.js";import"./@ctrl-B2IeE8ye.js";import"./rc-motion-Cs3GDHoo.js";import"./@rc-component-BB24pTyE.js";import"./rc-resize-observer-DUJXZwxn.js";import"./resize-observer-polyfill-CzGuHLZU.js";import"./ant-design-icons-DoIDTG1a.js";import"./rc-dialog-BGKNmDMe.js";import"./rc-table-CybQOAzy.js";import"./rc-virtual-list-P8JqKX09.js";import"./rc-tree--ithDbGw.js";import"./rc-checkbox-bMXfL26q.js";import"./rc-pagination-CiqGXVR2.js";import"./rc-select-sVu4PbUz.js";import"./rc-overflow-73VxJI7O.js";import"./throttle-debounce-w9OM8Bxz.js";import"./rc-input-ByOKN0-r.js";import"./rc-tooltip-C1heEwdg.js";import"./rc-notification-D3ebMW8F.js";import"./rc-image-BIQJV_M3.js";import"./rc-textarea-DLkAnH0O.js";import"./copy-to-clipboard-Bgp_G7Oq.js";import"./toggle-selection-DUsDmMsR.js";import"./rc-upload-ClZE7meS.js";import"./rc-progress-bbq4uvV3.js";import"./rc-dropdown-C238bXH-.js";import"./rc-menu-CzbBjnhu.js";import"./rc-field-form-DaYAwFJ8.js";import"./scroll-into-view-if-needed-cNB78-hM.js";import"./compute-scroll-into-view-CJmtT4lq.js";import"./rc-picker-B5UDvhgZ.js";import"./rc-tabs-DG0zBL9k.js";function x({chemicals:t,onRemoveChemical:r}){const[i,a]=e.useState(1),[o,l]=e.useState(10),c=Math.ceil(((null==t?void 0:t.length)||0)/o),m=(i-1)*o,u=m+o,h=null==t?void 0:t.slice(m,u),x=[{title:"Action",dataIndex:"action",render:(e,t)=>s.jsx(j,{type:"primary",danger:!0,size:"small",onClick:()=>r(t),children:"Delete"})},{title:"Chemical Name",dataIndex:"name"},{title:"CAS Number",dataIndex:"cas_number"}];return s.jsxs("div",{className:"border rounded-md mt-4 p-4",children:[s.jsx(n,{columns:x,dataSource:h,rowKey:"_id",pagination:!1}),s.jsxs("div",{className:"flex items-center justify-between mt-4",children:[s.jsxs("div",{className:"text-sm text-gray-500",children:["Items per page:"," ",s.jsx(d,{value:o,onChange:e=>{l(e),a(1)},options:[{value:10,label:"10"},{value:20,label:"20"},{value:50,label:"50"}],style:{width:80}})]}),s.jsxs(p,{children:[s.jsx(j,{type:"default",size:"small",onClick:()=>a(i-1),disabled:1===i,children:"Previous"}),s.jsxs("span",{className:"text-sm text-gray-500",children:[m+1," - ",Math.min(u,(null==t?void 0:t.length)||0)," of"," ",(null==t?void 0:t.length)||0]}),s.jsx(j,{type:"default",size:"small",onClick:()=>a(i+1),disabled:i===c,children:"Next"})]})]})]})}function g({selectedCustomer:t,refetchCustomer:l}){const[c,m]=e.useState(""),[n,d]=e.useState(""),[p,j]=e.useState(null),{data:h,isLoading:x}=r(n.charAt(0),{skip:0===n.length}),[g,{isLoading:v}]=i();return s.jsxs("div",{className:"mt-4",children:[s.jsxs("div",{className:"relative",children:[s.jsx(a,{placeholder:"Search Chemical",value:c,onChange:e=>{const s=e.target.value;m(s),d(s)},className:"w-full mb-4",disabled:!t}),x&&s.jsx("div",{className:"absolute top-2 right-4 text-sm text-gray-500",children:"Loading..."})]}),n&&(null==h?void 0:h.length)>0&&s.jsx("ul",{className:"border bg-white rounded max-h-40 overflow-y-auto",children:h.map((e=>s.jsx("li",{onClick:()=>(e=>{j(e),m(e.name),d("")})(e),className:"p-2 hover:bg-gray-200 cursor-pointer",children:e.name},e._id)))}),s.jsx(o,{onClick:async()=>{if(p&&t)try{const e=p.id||p._id,s=t._id;await g({customerId:s,chemicalId:e}).unwrap(),m(""),j(null),await l(),u.success("Chemical added successfully")}catch(e){u.error(e.message||"Failed to add chemical")}else u.error("Please select both customer and chemical")},disabled:v||!p||!t,className:"mt-4 w-[10%] py-2 bg-blue-500 text-white rounded hover:bg-blue-600",children:v?"Adding...":"Add "})]})}function v({onSelectCustomer:t}){const[r,i]=e.useState(""),[o,n]=e.useState(""),[d,p]=e.useState(null),{data:j,isLoading:h,refetch:v}=l(o.charAt(0),{skip:0===o.length}),{data:b,refetch:f}=c(null==d?void 0:d._id,{skip:!(null==d?void 0:d._id)}),[y]=m(),C=(null==b?void 0:b.data)||d;return s.jsxs("div",{className:"mt-4",children:[s.jsx(a,{placeholder:"Search Customer",value:r,onChange:e=>{const s=e.target.value;i(s),n(s)},className:"w-full mb-4"}),h?s.jsx("div",{children:"Loading..."}):o&&j&&j.length>0&&s.jsx("ul",{className:"border bg-white rounded max-h-40 overflow-y-auto",children:j.map((e=>s.jsx("li",{onClick:()=>(e=>{p(e),i(e.name),n(""),t(e)})(e),className:"p-2 hover:bg-gray-200 cursor-pointer",children:e.name},e._id)))}),s.jsx(g,{selectedCustomer:C,refetchCustomer:async()=>{await Promise.all([f(),v()])}}),C&&s.jsx(x,{chemicals:C.chemicalId||[],onRemoveChemical:async e=>{try{await y({customerId:d._id,chemicalId:e._id}).unwrap(),await Promise.all([f(),v()]),u.success("Chemical removed successfully")}catch(s){u.error("Failed to remove chemical")}}})]})}const b=[{label:"Dashboard",href:"/dashboard"},{label:"Chemical Mapping",href:null}];function f(){const[e,r]=t.useState(null),[i,a]=t.useState([]);return s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"ml-1",children:s.jsx(h,{items:b})}),s.jsxs("div",{className:"py-4 space-y-6",children:[s.jsx("h1",{className:"text-2xl font-bold text-purple-700",children:"Assign Chemicals to Customer"}),s.jsx("div",{className:"space-y-4",children:s.jsx(v,{onSelectCustomer:e=>{r(e),a([])}})})]})]})}export{f as default};
