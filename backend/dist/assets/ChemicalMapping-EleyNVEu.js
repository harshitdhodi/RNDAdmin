import{j as e,B as s,K as a,q as t,I as r,Z as l,V as c,x as i}from"./main-BcUd3ASm.js";import{r as o,R as n}from"./vendor-router-CaZtIe2_.js";import{T as m}from"./table-DnBX1p3B.js";import{C as d}from"./card-DKPCnjx_.js";import{S as h}from"./select-Dc7LnXRO.js";import{T as u}from"./trash-2-D2atH8Kb.js";import{B as x}from"./react-toastify.esm-CrOn1nFw.js";import{B as j}from"./BreadCrumb-B5EzA35k.js";import"./vendor-react-DD_RYU77.js";import"./vendor-utils-CfKmydC0.js";import"./index-CMYgmcqM.js";import"./index-BY97PVuz.js";import"./check-CxfHQWmE.js";import"./chevron-up-BAx2OvKy.js";import"./breadcrumb-DEvmmGzh.js";import"./chevron-right-C95tp0e6.js";function p({chemicals:a,onRemoveChemical:t}){const[r,l]=o.useState(1),[c,i]=o.useState(10),n=Math.ceil((a?.length||0)/c),x=(r-1)*c,j=x+c,p=a?.slice(x,j),v=[{header:"Action",accessorKey:"action",cell:({row:a})=>e.jsx(s,{size:"icon",variant:"destructive",onClick:()=>t(a.original),children:e.jsx(u,{className:"h-4 w-4"})})},{header:"Chemical Name",accessorKey:"name"},{header:"CAS Number",accessorKey:"cas_number"}];return e.jsxs(d,{className:"p-5 space-y-4",children:[e.jsx(m,{columns:v,data:p||[]}),e.jsxs("div",{className:"flex items-center justify-between mt-4",children:[e.jsxs("div",{className:"text-sm text-gray-500",children:["Items per page:"," ",e.jsx(h,{value:c,onValueChange:e=>{i(Number(e)),l(1)},options:[{value:10,label:"10"},{value:20,label:"20"},{value:50,label:"50"}],className:"w-20"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(s,{variant:"outline",size:"sm",onClick:()=>l(r-1),disabled:1===r,children:"Previous"}),e.jsxs("span",{className:"text-sm text-gray-500",children:[x+1," - ",Math.min(j,a?.length||0)," of ",a?.length||0]}),e.jsx(s,{variant:"outline",size:"sm",onClick:()=>l(r+1),disabled:r===n,children:"Next"})]})]})]})}function v({selectedCustomer:l,refetchCustomer:c}){const[i,n]=o.useState(""),[m,d]=o.useState(""),[h,u]=o.useState(null),{data:j,isLoading:p}=a(m.charAt(0),{skip:0===m.length}),[v,{isLoading:g}]=t();return e.jsxs("div",{className:"mt-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(r,{placeholder:"Search Chemical",value:i,onChange:e=>{const s=e.target.value;n(s),d(s)},className:"w-full mb-4",disabled:!l}),p&&e.jsx("div",{className:"absolute top-2 right-4 text-sm text-gray-500",children:"Loading..."})]}),m&&j?.length>0&&e.jsx("ul",{className:"border bg-white rounded max-h-40 overflow-y-auto",children:j.map((s=>e.jsx("li",{onClick:()=>(e=>{u(e),n(e.name),d("")})(s),className:"p-2 hover:bg-gray-200 cursor-pointer",children:s.name},s._id)))}),e.jsx(s,{onClick:async()=>{if(h&&l)try{const e=h.id||h._id,s=l._id;await v({customerId:s,chemicalId:e}).unwrap(),n(""),u(null),await c(),x.success("Chemical added successfully")}catch(e){x.error(e.message||"Failed to add chemical")}else x.error("Please select both customer and chemical")},disabled:g||!h||!l,className:"mt-4 w-[10%] py-2 bg-blue-500 text-white rounded hover:bg-blue-600",children:g?"Adding...":"Add "})]})}function g({onSelectCustomer:s}){const[a,t]=o.useState(""),[n,m]=o.useState(""),[d,h]=o.useState(null),{data:u,isLoading:j,refetch:g}=l(n.charAt(0),{skip:0===n.length}),{data:b,refetch:f}=c(d?._id,{skip:!d?._id}),[C]=i(),N=b?.data||d;return e.jsxs("div",{className:"mt-4",children:[e.jsx(r,{placeholder:"Search Customer",value:a,onChange:e=>{const s=e.target.value;t(s),m(s)},className:"w-full mb-4"}),j?e.jsx("div",{children:"Loading..."}):n&&u&&u.length>0&&e.jsx("ul",{className:"border bg-white rounded max-h-40 overflow-y-auto",children:u.map((a=>e.jsx("li",{onClick:()=>(e=>{h(e),t(e.name),m(""),s(e)})(a),className:"p-2 hover:bg-gray-200 cursor-pointer",children:a.name},a._id)))}),e.jsx(v,{selectedCustomer:N,refetchCustomer:async()=>{await Promise.all([f(),g()])}}),N&&e.jsx(p,{chemicals:N.chemicalId||[],onRemoveChemical:async e=>{try{await C({customerId:d._id,chemicalId:e._id}).unwrap(),await Promise.all([f(),g()]),x.success("Chemical removed successfully")}catch(s){x.error("Failed to remove chemical")}}})]})}const b=[{label:"Dashboard",href:"/dashboard"},{label:"Chemical Mapping",href:null}];function f(){const[s,a]=n.useState(null),[t,r]=n.useState([]);return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"ml-1",children:e.jsx(j,{items:b})}),e.jsxs("div",{className:"py-4 space-y-6",children:[e.jsx("h1",{className:"text-2xl font-bold text-purple-700",children:"Assign Chemicals to Customer"}),e.jsx("div",{className:"space-y-4",children:e.jsx(g,{onSelectCustomer:e=>{a(e),r([])}})})]})]})}export{f as default};
//# sourceMappingURL=ChemicalMapping-EleyNVEu.js.map
