import{o as e,j as t,I as a,B as s,s as i,a5 as l,a6 as r}from"./main-DeRxjK88.js";import{r as n,R as o}from"./vendor-router-Bu4EHm1B.js";import{a as c}from"./vendor-utils-BfOc9lHv.js";import{F as d,P as m}from"./Table-BZaWXI2p.js";import{M as p}from"./index-BeYydUON.js";import{B as u}from"./index-lUiyPlMq.js";import"./vendor-react-CI5aWZjI.js";import"./toArray-DkI11MDQ.js";import"./addEventListener-BUKQhVN_.js";import"./index-j6PXCaBg.js";import"./EllipsisOutlined-L4j7-ai9.js";import"./dropdown-B7KEEEnN.js";import"./getAllowClear-exXUluB6.js";import"./CheckOutlined-3fI3nOal.js";import"./Input-BufppJmu.js";import"./index-DoSF0nZj.js";import"./index-VFidPMY_.js";import"./CheckCircleFilled-DiSUBvU5.js";import"./ExclamationCircleFilled-DZysw_83.js";import"./InfoCircleFilled-D8dKuFWy.js";import"./ActionButton-xPc0Gc43.js";import"./index-Bz7nO4c4.js";import"./index-DRGG9HZA.js";import"./fade-C0XPHGae.js";import"./Skeleton-3ezOyxdU.js";function h({selectedSupplier:i,onAddChemical:l}){const[r,o]=n.useState(""),[d,m]=n.useState(""),[p,u]=n.useState(null),[h,j]=n.useState([]),[x,g]=n.useState(!1),[f,{isLoading:S}]=e();return t.jsxs("div",{className:"mt-4",children:[t.jsxs("div",{className:"relative",children:[t.jsx(a,{placeholder:"Search Chemical",value:r,onChange:e=>{const t=e.target.value;o(t),t.trim()?(m(t),(async e=>{if(e){g(!0);try{const t=await c.get(`/api/chemical/getChemicalByCategoryAndAlphabet?alphabet=${e}`);j(t.data)}catch(t){j([])}finally{g(!1)}}})(t.charAt(0))):(m(""),j([]))},className:"w-full mb-4",disabled:!i}),x&&t.jsx("div",{className:"absolute top-2 right-4 text-sm text-gray-500",children:"Loading..."})]}),d&&h?.length>0&&t.jsx("ul",{className:"border bg-white rounded max-h-40 overflow-y-auto",children:h.map((e=>t.jsx("li",{onClick:()=>(e=>{u(e),o(e.name),m("")})(e),className:"p-2 hover:bg-gray-200 cursor-pointer border-b last:border-b-0",children:e.name},e._id)))}),0===h?.length&&!x&&d&&t.jsx("div",{className:"p-2 text-gray-500",children:"No chemicals found"}),t.jsx(s,{onClick:async()=>{if(p&&i)try{const e=p._id,t=i._id;await f({supplierId:t,chemical_ids:[e]}).unwrap(),u(null),o(""),l&&l()}catch(e){alert(`Failed to add chemical: ${e.message||"Unknown error occurred"}`)}},disabled:S||!p||!i,className:"mt-4 w-fit py-2 bg-blue-500 text-white rounded hover:bg-blue-600 "+(S?"opacity-50 cursor-not-allowed":""),children:S?"Adding...":"Add Chemical"})]})}function j({chemicals:e,refetch:a,supplierId:s,onRemoveChemical:l}){const[r,o]=n.useState(1),[c,h]=n.useState(10),[j]=i(),[x,g]=n.useState(null),[f,S]=n.useState(!1);Math.ceil(e.length/c);const C=(r-1)*c,v=C+c,b=e.slice(C,v),y=[{title:"Action",dataIndex:"action",render:(e,a)=>t.jsx(u,{danger:!0,size:"small",onClick:()=>(e=>{g(e),S(!0)})(a),children:"Delete"})},{title:"Chemical Name",dataIndex:"name"},{title:"CAS Number",dataIndex:"cas_number"}];return t.jsxs("div",{className:"border rounded-md mt-4 p-4",children:[t.jsx(d,{dataSource:b,columns:y,rowKey:"_id",pagination:!1}),t.jsx(m,{current:r,total:e.length,pageSize:c,onChange:e=>o(e),showSizeChanger:!0,onShowSizeChange:(e,t)=>h(t),className:"mt-4 float-end pt-5"}),t.jsx(p,{title:"Confirm Deletion",open:f,onCancel:()=>S(!1),onOk:async()=>{if(s&&x)try{await j({supplierId:s,chemicalId:x._id}),l(x),a(),S(!1),g(null),1===b.length&&r>1&&o(1)}catch(e){}},okText:"Delete",okButtonProps:{danger:!0},children:t.jsxs("p",{children:['Are you sure you want to delete "',x?.name,'"?']})})]})}function x({onSelectSupplier:e}){const[s,i]=n.useState(""),[o,c]=n.useState(""),[d,m]=n.useState(null),{data:p,isLoading:u}=l(o.charAt(0),{skip:0===o.length}),{data:x,refetch:g,isFetching:f}=r(d?._id,{skip:!d});n.useEffect((()=>{x&&!f&&(m(x),"function"==typeof e&&e(x))}),[x,f,e]);const S=()=>{g()};return t.jsxs("div",{className:"mt-4",children:[t.jsx(a,{placeholder:"Search Supplier",value:s,onChange:e=>{const t=e.target.value;i(t),c(t)},className:"w-full mb-4"}),u?t.jsx("div",{children:"Loading..."}):o&&p&&p.length>0&&t.jsx("ul",{className:"border bg-white rounded max-h-40 overflow-y-auto",children:p.map((a=>t.jsx("li",{onClick:()=>(t=>{m(t),i(t.name),c(""),"function"==typeof e&&e(t)})(a),className:"p-2 hover:bg-gray-200 cursor-pointer",children:a.name},a.id)))}),0===p?.length&&!u&&o&&t.jsx("div",{className:"p-2 text-gray-500",children:"No Supplier found"}),f&&t.jsx("div",{className:"p-2 text-gray-500",children:"Refreshing supplier data..."}),t.jsx(h,{selectedSupplier:d,onAddChemical:S}),t.jsx("div",{className:"mt-4",children:t.jsx(j,{chemicals:d?.chemical_ids||[],refetch:g,onRemoveChemical:S,supplierId:d?._id})})]})}function g(){const[e,a]=o.useState(null),[s,i]=o.useState([]);return t.jsxs("div",{className:"p-6 space-y-6",children:[t.jsx("h1",{className:"text-2xl font-bold text-purple-700",children:"Assign Chemicals to Supplier"}),t.jsx("div",{className:"space-y-4",children:t.jsx(x,{onSelectCustomer:e=>{a(e),i([])}})})]})}export{g as default};
//# sourceMappingURL=ChemicalMapping-QI8mXDBJ.js.map
