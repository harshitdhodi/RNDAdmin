import{j as e,J as s,p as a,I as t,B as l,aa as r,a7 as i,w as c}from"./main-DeRxjK88.js";import{r as o,R as n}from"./vendor-router-Bu4EHm1B.js";import{F as d}from"./Table-BZaWXI2p.js";import{S as m}from"./index-j6PXCaBg.js";import{S as h}from"./index-DoSF0nZj.js";import{B as u}from"./index-lUiyPlMq.js";import{B as p}from"./react-toastify.esm-DbN0HGqG.js";import{B as x}from"./BreadCrumb-PqVNrGAD.js";import"./vendor-react-CI5aWZjI.js";import"./vendor-utils-BfOc9lHv.js";import"./toArray-DkI11MDQ.js";import"./addEventListener-BUKQhVN_.js";import"./dropdown-B7KEEEnN.js";import"./EllipsisOutlined-L4j7-ai9.js";import"./getAllowClear-exXUluB6.js";import"./index-VFidPMY_.js";import"./Input-BufppJmu.js";import"./CheckOutlined-3fI3nOal.js";import"./chevron-right-YTRb9aqn.js";function j({chemicals:s,onRemoveChemical:a}){const[t,l]=o.useState(1),[r,i]=o.useState(10),c=Math.ceil((s?.length||0)/r),n=(t-1)*r,p=n+r,x=s?.slice(n,p),j=[{title:"Action",dataIndex:"action",render:(s,t)=>e.jsx(u,{type:"primary",danger:!0,size:"small",onClick:()=>a(t),children:"Delete"})},{title:"Chemical Name",dataIndex:"name"},{title:"CAS Number",dataIndex:"cas_number"}];return e.jsxs("div",{className:"border rounded-md mt-4 p-4",children:[e.jsx(d,{columns:j,dataSource:x,rowKey:"_id",pagination:!1}),e.jsxs("div",{className:"flex items-center justify-between mt-4",children:[e.jsxs("div",{className:"text-sm text-gray-500",children:["Items per page:"," ",e.jsx(m,{value:r,onChange:e=>{i(e),l(1)},options:[{value:10,label:"10"},{value:20,label:"20"},{value:50,label:"50"}],style:{width:80}})]}),e.jsxs(h,{children:[e.jsx(u,{type:"default",size:"small",onClick:()=>l(t-1),disabled:1===t,children:"Previous"}),e.jsxs("span",{className:"text-sm text-gray-500",children:[n+1," - ",Math.min(p,s?.length||0)," of"," ",s?.length||0]}),e.jsx(u,{type:"default",size:"small",onClick:()=>l(t+1),disabled:t===c,children:"Next"})]})]})]})}function g({selectedCustomer:r,refetchCustomer:i}){const[c,n]=o.useState(""),[d,m]=o.useState(""),[h,u]=o.useState(null),{data:x,isLoading:j}=s(d.charAt(0),{skip:0===d.length}),[g,{isLoading:v}]=a();return e.jsxs("div",{className:"mt-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(t,{placeholder:"Search Chemical",value:c,onChange:e=>{const s=e.target.value;n(s),m(s)},className:"w-full mb-4",disabled:!r}),j&&e.jsx("div",{className:"absolute top-2 right-4 text-sm text-gray-500",children:"Loading..."})]}),d&&x?.length>0&&e.jsx("ul",{className:"border bg-white rounded max-h-40 overflow-y-auto",children:x.map((s=>e.jsx("li",{onClick:()=>(e=>{u(e),n(e.name),m("")})(s),className:"p-2 hover:bg-gray-200 cursor-pointer",children:s.name},s._id)))}),e.jsx(l,{onClick:async()=>{if(h&&r)try{const e=h.id||h._id,s=r._id;await g({customerId:s,chemicalId:e}).unwrap(),n(""),u(null),await i(),p.success("Chemical added successfully")}catch(e){p.error(e.message||"Failed to add chemical")}else p.error("Please select both customer and chemical")},disabled:v||!h||!r,className:"mt-4 w-[10%] py-2 bg-blue-500 text-white rounded hover:bg-blue-600",children:v?"Adding...":"Add "})]})}function v({onSelectCustomer:s}){const[a,l]=o.useState(""),[n,d]=o.useState(""),[m,h]=o.useState(null),{data:u,isLoading:x,refetch:v}=r(n.charAt(0),{skip:0===n.length}),{data:f,refetch:b}=i(m?._id,{skip:!m?._id}),[C]=c(),y=f?.data||m;return e.jsxs("div",{className:"mt-4",children:[e.jsx(t,{placeholder:"Search Customer",value:a,onChange:e=>{const s=e.target.value;l(s),d(s)},className:"w-full mb-4"}),x?e.jsx("div",{children:"Loading..."}):n&&u&&u.length>0&&e.jsx("ul",{className:"border bg-white rounded max-h-40 overflow-y-auto",children:u.map((a=>e.jsx("li",{onClick:()=>(e=>{h(e),l(e.name),d(""),s(e)})(a),className:"p-2 hover:bg-gray-200 cursor-pointer",children:a.name},a._id)))}),e.jsx(g,{selectedCustomer:y,refetchCustomer:async()=>{await Promise.all([b(),v()])}}),y&&e.jsx(j,{chemicals:y.chemicalId||[],onRemoveChemical:async e=>{try{await C({customerId:m._id,chemicalId:e._id}).unwrap(),await Promise.all([b(),v()]),p.success("Chemical removed successfully")}catch(s){p.error("Failed to remove chemical")}}})]})}const f=[{label:"Dashboard",href:"/dashboard"},{label:"Chemical Mapping",href:null}];function b(){const[s,a]=n.useState(null),[t,l]=n.useState([]);return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"ml-1",children:e.jsx(x,{items:f})}),e.jsxs("div",{className:"py-4 space-y-6",children:[e.jsx("h1",{className:"text-2xl font-bold text-purple-700",children:"Assign Chemicals to Customer"}),e.jsx("div",{className:"space-y-4",children:e.jsx(v,{onSelectCustomer:e=>{a(e),l([])}})})]})]})}export{b as default};
//# sourceMappingURL=ChemicalMapping-v639-PTD.js.map
