import{h as e,J as s,j as a,D as r,l,m as c,n as i,I as n,B as d,a7 as t,w as h,a8 as o,t as m,O as x}from"./main-DeRxjK88.js";import{r as j,L as u}from"./vendor-router-Bu4EHm1B.js";import{T as p,a as b,b as g,c as N,d as f,e as C}from"./table-Cj_y_WH9.js";import{D as v,a as y,b as w,c as k}from"./dropdown-menu-BEoG4Wb8.js";import{a as _}from"./vendor-utils-BfOc9lHv.js";import{P as I}from"./plus-CYGv-ui8.js";import{B as S}from"./BreadCrumb-PqVNrGAD.js";import{C as A}from"./chevron-up-3rt5hBY6.js";import{E as F}from"./ellipsis-vertical-DXlju7bG.js";import"./vendor-react-CI5aWZjI.js";import"./Combination-CNfQ0noH.js";import"./chevron-right-YTRb9aqn.js";import"./check-CVm68GV7.js";
/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O=e("Trash",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}]]),D=({open:e,onOpenChange:t,customerId:h,onAddChemical:o,customerRefatch:m,refetch:x})=>{const[u,p]=j.useState(""),[b,g]=j.useState([]),{data:N,isLoading:f,error:C}=s(u,{skip:!u||u.length<2});return a.jsx(r,{open:e,onOpenChange:e=>!e&&t(!1),children:a.jsxs(l,{className:"max-w-lg p-6",children:[a.jsx(c,{children:a.jsx(i,{className:"text-lg font-semibold text-[#3b1f91]",children:"Add Chemicals to Customer"})}),a.jsxs("div",{className:"mt-4",children:[a.jsx(n,{placeholder:"Search chemicals",value:u,onChange:e=>p(e.target.value),className:"w-full mb-4"}),f?a.jsx("div",{children:"Loading..."}):u&&N&&N.length>0&&a.jsx("ul",{className:"border bg-white rounded max-h-40 overflow-y-auto",children:N.filter((e=>!b.some((s=>s._id===e._id)))).map((e=>a.jsx("li",{onClick:()=>(e=>{b.some((s=>s._id===e._id))||g((s=>{const a=[...s,e];return p(""),a}))})(e),className:"p-2 hover:bg-gray-200 cursor-pointer",children:e.name},e._id)))}),0===N?.length&&!f&&u&&a.jsx("div",{className:"p-2 text-gray-500",children:"No chemicals found"}),a.jsx("div",{className:"mt-4",children:b.length>0&&a.jsx("div",{className:"space-y-2",children:b.map((e=>a.jsxs("div",{className:"flex justify-between items-center bg-gray-100 p-2 rounded",children:[a.jsx("span",{children:e.name}),a.jsx(d,{variant:"outline",size:"sm",onClick:()=>{return s=e._id,g((e=>e.filter((e=>e._id!==s)))),void x();var s},className:"text-red-500",children:"Remove"})]},e._id)))})}),a.jsxs("div",{className:"flex justify-between mt-4",children:[a.jsx(d,{onClick:async()=>{const e=b.map((e=>e._id)),s={id:h,chemicalId:e};try{await _.put(`/api/customer/addChemicalIdsToCustomer?id=${h}`,s,{headers:{"Content-Type":"application/json"}}),t(!1),o&&o(b),m(),x()}catch(a){}},className:"bg-[#3b1f91] hover:bg-purple-700",disabled:0===b.length,children:"+ Add Chemicals"}),a.jsx(d,{onClick:()=>t(!1),className:"bg-red-600 hover:bg-red-700",children:"Cancel"})]})]})]})})},T=({customerId:e,customerName:s,open:n,onOpenChange:o,customerRefatch:m})=>{const[x,u]=j.useState(!1),{data:v,isLoading:y,isError:w,refetch:k}=t(e,{skip:!n}),[_,{isLoading:S}]=h();if(y)return a.jsx(r,{open:n,onOpenChange:o,children:a.jsxs(l,{children:[a.jsx(c,{children:a.jsx(i,{children:"Loading Chemicals..."})}),a.jsx("p",{children:"Fetching chemical data..."})]})});if(w)return a.jsx(r,{open:n,onOpenChange:o,children:a.jsxs(l,{children:[a.jsx(c,{children:a.jsx(i,{children:"Error Loading Chemicals"})}),a.jsx("p",{children:"Unable to fetch chemical data. Please try again."})]})});const A=v?.data?.chemicalId||[];return a.jsxs(a.Fragment,{children:[a.jsx(r,{open:n,onOpenChange:o,children:a.jsxs(l,{className:"max-w-3xl",children:[a.jsx(c,{children:a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsxs(i,{children:["Chemicals for ",s]}),a.jsxs(d,{className:"m-3",onClick:()=>u(!0),children:[a.jsx(I,{className:"mr-2 h-4 w-4"})," Add Chemical"]})]})}),A.length>0?a.jsxs(p,{children:[a.jsx(b,{children:a.jsxs(g,{children:[a.jsx(N,{children:"Name"}),a.jsx(N,{children:"CAS Number"}),a.jsx(N,{children:"Actions"})," "]})}),a.jsx(f,{children:A.map((s=>a.jsxs(g,{children:[a.jsx(C,{children:s.name}),a.jsx(C,{children:s.cas_number}),a.jsx(C,{children:a.jsx(d,{variant:"destructive",size:"sm",onClick:()=>(async s=>{try{await _({customerId:e,chemicalId:s}),k()}catch(a){}})(s._id),disabled:S,children:a.jsx(O,{})})})]},s._id)))})]}):a.jsx("p",{className:"text-center py-4",children:"No chemicals found for this customer"})]})}),a.jsx(D,{open:x,onOpenChange:u,customerId:e,onAddChemical:e=>{u(!1)},customerRefatch:m,refetch:k})]})},L=({salesOrders:e=[]})=>a.jsxs(p,{children:[a.jsx(b,{children:a.jsxs(g,{children:[a.jsx(N,{children:"Created Date"}),a.jsx(N,{children:"Order Number"}),a.jsx(N,{children:"Payment Status"}),a.jsx(N,{children:"Total Discount"}),a.jsx(N,{children:"Total Tax"}),a.jsx(N,{children:"Total Amount"})]})}),a.jsx(f,{children:0===e.length?a.jsx(g,{children:a.jsx(C,{colSpan:6,className:"text-center",children:"No Data Found"})}):e.map((e=>a.jsxs(g,{children:[a.jsx(C,{children:e.createdDate}),a.jsx(C,{children:e.orderNumber}),a.jsx(C,{children:e.paymentStatus}),a.jsx(C,{children:e.totalDiscount}),a.jsx(C,{children:e.totalTax}),a.jsx(C,{children:e.totalAmount})]},e.orderNumber)))})]}),E=[{label:"Dashboard",href:"/dashboard"},{label:"Customer Table",href:"/supplier-table"}],P=()=>{const[e,s]=j.useState(null),[r,l]=j.useState(!1),[c,i]=j.useState(null),[t]=o(),[h,_]=j.useState(!1),[O,P]=j.useState(!1),{data:z,isLoading:R,error:M,refetch:B}=m(),V=z||[];if(R)return a.jsx("div",{children:"Loading..."});if(M)return a.jsx("div",{children:"Error loading customers"});const H=e=>{};return a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"ml-1",children:a.jsx(S,{items:E})}),a.jsxs("div",{className:"space-y-4 mt-4",children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx("h2",{className:"text-xl font-medium text-[#3b1f91]",children:"Customers"}),a.jsx(u,{to:"/customer-form",children:a.jsxs(d,{children:[a.jsx(I,{className:"mr-2 h-4 w-4 "}),"Add Customer"]})})]}),a.jsx("hr",{className:"border-[#3b1f91] border my-4"}),a.jsx("div",{className:"rounded-md border",children:a.jsxs(p,{children:[a.jsx(b,{className:"bg-gray-100 ",children:a.jsxs(g,{children:[a.jsx(N,{className:"w-[50px] border-r-gray-300 bg-gray-100"}),a.jsx(N,{className:"text-black border-r-gray-300 font-semibold",children:"Name"}),a.jsx(N,{className:"text-black border-r-gray-300 font-semibold",children:"Contact Person"}),a.jsx(N,{className:"text-black border-r-gray-300 font-semibold",children:"Email"}),a.jsx(N,{className:"text-black border-r-gray-300 font-semibold",children:"Mobile/Phone"}),a.jsx(N,{className:"text-black border-r-gray-300 font-semibold",children:"Website"}),a.jsx(N,{className:"text-black  font-semibold",children:"Chemicals Count"})]})}),a.jsxs(f,{children:[a.jsxs(g,{className:"bg-gray-100",children:[a.jsx(C,{}),a.jsx(C,{children:a.jsx(n,{placeholder:"Filter name...",className:"max-w-sm"})}),a.jsx(C,{children:a.jsx(n,{placeholder:"Filter contact...",className:"max-w-sm"})}),a.jsx(C,{children:a.jsx(n,{placeholder:"Filter email...",className:"max-w-sm"})}),a.jsx(C,{children:a.jsx(n,{placeholder:"Filter phone...",className:"max-w-sm"})}),a.jsx(C,{children:a.jsx(n,{placeholder:"Filter website...",className:"max-w-sm"})}),a.jsx(C,{children:a.jsx(n,{placeholder:"Filter chemicals...",className:"max-w-sm"})})]}),V.map((r=>a.jsxs(a.Fragment,{children:[a.jsxs(g,{children:[a.jsx(C,{children:a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(d,{variant:"ghost",size:"sm",onClick:()=>{return e=r.id,void s((s=>s===e?null:e));var e},children:e===r.id?a.jsx(A,{className:"h-4 w-4"}):a.jsx(x,{className:"h-4 w-4"})}),a.jsxs(v,{children:[a.jsx(y,{asChild:!0,children:a.jsx(d,{variant:"ghost",size:"sm",children:a.jsx(F,{className:"h-4 w-4"})})}),a.jsxs(w,{align:"end",children:[a.jsx(u,{to:`/edit-customer-form/${r._id}`,children:a.jsx(k,{children:"Edit"})}),a.jsx(k,{className:"text-red-600",onClick:()=>(async e=>{try{_(!0),await t(e),alert("Customer deleted successfully")}catch(s){alert("Failed to delete customer")}finally{_(!1)}})(r._id),disabled:h,children:h?"Deleting...":"Delete"}),a.jsx(k,{onClick:()=>{i(r),P(!0)},children:"Add Chemical"})]})]})]})}),a.jsx(C,{children:r.name}),a.jsx(C,{children:r.contactPerson}),a.jsx(C,{children:r.email}),a.jsx(C,{children:r.phone}),a.jsx(C,{children:r.website}),a.jsx(C,{children:a.jsxs(d,{className:"hover:bg-[#4f359c]",variant:"secondary",size:"sm",onClick:()=>(e=>{i(e),l(!0)})(r),children:["Chemicals (",r.chemicalId.length,")"]})})]},r.id),e===r.id&&a.jsx(g,{children:a.jsx(C,{colSpan:9,children:a.jsx("div",{className:"p-4",children:a.jsx(L,{customerId:r._id})})})})]})))]})]})}),a.jsx(T,{open:r,onOpenChange:l,customerName:c?.name,customerId:c?._id,onAddChemical:H,customerRefatch:B}),a.jsx(D,{open:O,onOpenChange:P,onAddChemical:H,customerId:c?._id})]})]})};export{P as default};
//# sourceMappingURL=CustomerTable-Brbk5Sah.js.map
