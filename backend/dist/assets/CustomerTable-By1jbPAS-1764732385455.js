import{ae as H,r as g,aL as G,j as e,ag as k,aj as A,ak as T,al as _,I as N,B as b,c as Q,b7 as V,aw as $,b8 as U,au as W,L as P,b9 as q,aP as O}from"./index-2kbH1bBb-1764732385455.js";import{T as F,a as I,b as p,c as i,d as L,e as a}from"./table-DRpdyDSO-1764732385455.js";import{D as J,a as K,b as X,c as E}from"./dropdown-menu-C_8HXjx9-1764732385455.js";import{P as B}from"./plus-Co79WuO4-1764732385455.js";import{B as Y}from"./BreadCrumb-BEII7H-Z-1764732385455.js";import{E as Z}from"./ellipsis-vertical-C5tVG7sw-1764732385455.js";import"./Combination-Dnkj1Sd1-1764732385455.js";import"./check-DDxB_Ky9-1764732385455.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ee=H("Trash",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}]]),R=({open:o,onOpenChange:c,customerId:x,onAddChemical:j,customerRefatch:n,refetch:C})=>{const[d,u]=g.useState(""),[t,f]=g.useState([]),{data:h,isLoading:w,error:S}=G(d,{skip:!d||d.length<2}),v=async()=>{const s=t.map(m=>m._id),r={id:x,chemicalId:s};try{await Q.put(`/api/customer/addChemicalIdsToCustomer?id=${x}`,r,{headers:{"Content-Type":"application/json"}}),c(!1),j&&j(t),n(),C()}catch(m){console.error("Error adding chemicals:",m)}},D=s=>{t.some(r=>r._id===s._id)||f(r=>{const m=[...r,s];return u(""),m})},y=s=>{f(r=>r.filter(m=>m._id!==s)),C()};return e.jsx(k,{open:o,onOpenChange:s=>!s&&c(!1),children:e.jsxs(A,{className:"max-w-lg p-6",children:[e.jsx(T,{children:e.jsx(_,{className:"text-lg font-semibold text-[#304a8a]",children:"Add Chemicals to Customer"})}),e.jsxs("div",{className:"mt-4",children:[e.jsx(N,{placeholder:"Search chemicals",value:d,onChange:s=>u(s.target.value),className:"w-full mb-4"}),w?e.jsx("div",{children:"Loading..."}):d&&h&&h.length>0&&e.jsx("ul",{className:"border bg-white rounded max-h-40 overflow-y-auto",children:h.filter(s=>!t.some(r=>r._id===s._id)).map(s=>e.jsx("li",{onClick:()=>D(s),className:"p-2 hover:bg-gray-200 cursor-pointer",children:s.name},s._id))}),(h==null?void 0:h.length)===0&&!w&&d&&e.jsx("div",{className:"p-2 text-gray-500",children:"No chemicals found"}),e.jsx("div",{className:"mt-4",children:t.length>0&&e.jsx("div",{className:"space-y-2",children:t.map(s=>e.jsxs("div",{className:"flex justify-between items-center bg-gray-100 p-2 rounded",children:[e.jsx("span",{children:s.name}),e.jsx(b,{variant:"outline",size:"sm",onClick:()=>y(s._id),className:"text-red-500",children:"Remove"})]},s._id))})}),e.jsxs("div",{className:"flex justify-between mt-4",children:[e.jsx(b,{onClick:v,className:"bg-[#304a8a] hover:bg-purple-700",disabled:t.length===0,children:"+ Add Chemicals"}),e.jsx(b,{onClick:()=>c(!1),className:"bg-red-600 hover:bg-red-700",children:"Cancel"})]})]})]})})},se=({customerId:o,customerName:c,open:x,onOpenChange:j,customerRefatch:n})=>{var s;const[C,d]=g.useState(!1),{data:u,isLoading:t,isError:f,refetch:h}=V(o,{skip:!x}),[w,{isLoading:S}]=$(),v=r=>{console.log("Adding chemical:",r),d(!1)},D=async r=>{try{await w({customerId:o,chemicalId:r}),h()}catch(m){console.error("Error deleting chemical:",m)}};if(t)return e.jsx(k,{open:x,onOpenChange:j,children:e.jsxs(A,{children:[e.jsx(T,{children:e.jsx(_,{children:"Loading Chemicals..."})}),e.jsx("p",{children:"Fetching chemical data..."})]})});if(f)return e.jsx(k,{open:x,onOpenChange:j,children:e.jsxs(A,{children:[e.jsx(T,{children:e.jsx(_,{children:"Error Loading Chemicals"})}),e.jsx("p",{children:"Unable to fetch chemical data. Please try again."})]})});const y=((s=u==null?void 0:u.data)==null?void 0:s.chemicalId)||[];return e.jsxs(e.Fragment,{children:[e.jsx(k,{open:x,onOpenChange:j,children:e.jsxs(A,{className:"max-w-3xl",children:[e.jsx(T,{children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs(_,{children:["Chemicals for ",c]}),e.jsxs(b,{className:"m-3",onClick:()=>d(!0),children:[e.jsx(B,{className:"mr-2 h-4 w-4"})," Add Chemical"]})]})}),y.length>0?e.jsxs(F,{children:[e.jsx(I,{children:e.jsxs(p,{children:[e.jsx(i,{children:"Name"}),e.jsx(i,{children:"CAS Number"}),e.jsx(i,{children:"Actions"})," "]})}),e.jsx(L,{children:y.map(r=>e.jsxs(p,{children:[e.jsx(a,{children:r.name}),e.jsx(a,{children:r.cas_number}),e.jsx(a,{children:e.jsx(b,{variant:"destructive",size:"sm",onClick:()=>D(r._id),disabled:S,children:e.jsx(ee,{})})})]},r._id))})]}):e.jsx("p",{className:"text-center py-4",children:"No chemicals found for this customer"})]})}),e.jsx(R,{open:C,onOpenChange:d,customerId:o,onAddChemical:v,customerRefatch:n,refetch:h})]})},ae=({salesOrders:o=[]})=>e.jsxs(F,{children:[e.jsx(I,{children:e.jsxs(p,{children:[e.jsx(i,{children:"Created Date"}),e.jsx(i,{children:"Order Number"}),e.jsx(i,{children:"Payment Status"}),e.jsx(i,{children:"Total Discount"}),e.jsx(i,{children:"Total Tax"}),e.jsx(i,{children:"Total Amount"})]})}),e.jsx(L,{children:o.length===0?e.jsx(p,{children:e.jsx(a,{colSpan:6,className:"text-center",children:"No Data Found"})}):o.map(c=>e.jsxs(p,{children:[e.jsx(a,{children:c.createdDate}),e.jsx(a,{children:c.orderNumber}),e.jsx(a,{children:c.paymentStatus}),e.jsx(a,{children:c.totalDiscount}),e.jsx(a,{children:c.totalTax}),e.jsx(a,{children:c.totalAmount})]},c.orderNumber))})]}),le=[{label:"Dashboard",href:"/dashboard"},{label:"Customer Table",href:"/supplier-table"}],me=()=>{const[o,c]=g.useState(null),[x,j]=g.useState(!1),[n,C]=g.useState(null),[d]=U(),[u,t]=g.useState(!1),[f,h]=g.useState(!1),{data:w,isLoading:S,error:v,refetch:D}=W(),y=w||[];if(S)return e.jsx("div",{children:"Loading..."});if(v)return e.jsx("div",{children:"Error loading customers"});const s=l=>{c(M=>M===l?null:l)},r=l=>{console.log(`Adding chemical: ${l}`)},m=l=>{C(l),j(!0)},z=async l=>{try{t(!0),await d(l),alert("Customer deleted successfully")}catch{alert("Failed to delete customer")}finally{t(!1)}};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"ml-1",children:e.jsx(Y,{items:le})}),e.jsxs("div",{className:"space-y-4 mt-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h2",{className:"text-xl font-medium text-[#304a8a]",children:"Customers"}),e.jsx(P,{to:"/customer-form",children:e.jsxs(b,{children:[e.jsx(B,{className:"mr-2 h-4 w-4 "}),"Add Customer"]})})]}),e.jsx("hr",{className:"border-[#304a8a] border my-4"}),e.jsx("div",{className:"rounded-md border",children:e.jsxs(F,{children:[e.jsx(I,{className:"bg-gray-100 ",children:e.jsxs(p,{children:[e.jsx(i,{className:"w-[50px] border-r-gray-300 bg-gray-100"}),e.jsx(i,{className:"text-black border-r-gray-300 font-semibold",children:"Name"}),e.jsx(i,{className:"text-black border-r-gray-300 font-semibold",children:"Contact Person"}),e.jsx(i,{className:"text-black border-r-gray-300 font-semibold",children:"Email"}),e.jsx(i,{className:"text-black border-r-gray-300 font-semibold",children:"Mobile/Phone"}),e.jsx(i,{className:"text-black border-r-gray-300 font-semibold",children:"Website"}),e.jsx(i,{className:"text-black  font-semibold",children:"Chemicals Count"})]})}),e.jsxs(L,{children:[e.jsxs(p,{className:"bg-gray-100",children:[e.jsx(a,{}),e.jsx(a,{children:e.jsx(N,{placeholder:"Filter name...",className:"max-w-sm"})}),e.jsx(a,{children:e.jsx(N,{placeholder:"Filter contact...",className:"max-w-sm"})}),e.jsx(a,{children:e.jsx(N,{placeholder:"Filter email...",className:"max-w-sm"})}),e.jsx(a,{children:e.jsx(N,{placeholder:"Filter phone...",className:"max-w-sm"})}),e.jsx(a,{children:e.jsx(N,{placeholder:"Filter website...",className:"max-w-sm"})}),e.jsx(a,{children:e.jsx(N,{placeholder:"Filter chemicals...",className:"max-w-sm"})})]}),y.map(l=>e.jsxs(e.Fragment,{children:[e.jsxs(p,{children:[e.jsx(a,{children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(b,{variant:"ghost",size:"sm",onClick:()=>s(l.id),children:o===l.id?e.jsx(q,{className:"h-4 w-4"}):e.jsx(O,{className:"h-4 w-4"})}),e.jsxs(J,{children:[e.jsx(K,{asChild:!0,children:e.jsx(b,{variant:"ghost",size:"sm",children:e.jsx(Z,{className:"h-4 w-4"})})}),e.jsxs(X,{align:"end",children:[e.jsx(P,{to:`/edit-customer-form/${l._id}`,children:e.jsx(E,{children:"Edit"})}),e.jsx(E,{className:"text-red-600",onClick:()=>z(l._id),disabled:u,children:u?"Deleting...":"Delete"}),e.jsx(E,{onClick:()=>{C(l),h(!0)},children:"Add Chemical"})]})]})]})}),e.jsx(a,{children:l.name}),e.jsx(a,{children:l.contactPerson}),e.jsx(a,{children:l.email}),e.jsx(a,{children:l.phone}),e.jsx(a,{children:l.website}),e.jsx(a,{children:e.jsxs(b,{className:"hover:bg-[#4f359c]",variant:"secondary",size:"sm",onClick:()=>m(l),children:["Chemicals (",l.chemicalId.length,")"]})})]},l.id),o===l.id&&e.jsx(p,{children:e.jsx(a,{colSpan:9,children:e.jsx("div",{className:"p-4",children:e.jsx(ae,{customerId:l._id})})})})]}))]})]})}),e.jsx(se,{open:x,onOpenChange:j,customerName:n==null?void 0:n.name,customerId:n==null?void 0:n._id,onAddChemical:r,customerRefatch:D}),e.jsx(R,{open:f,onOpenChange:h,onAddChemical:r,customerId:n==null?void 0:n._id})]})]})};export{me as default};
