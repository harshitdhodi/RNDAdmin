import{K as e,j as s,D as a,m as r,n as l,o as c,I as i,B as n,V as d,x as t,W as o,v as h,P as m}from"./main-BcUd3ASm.js";import{r as x,L as j}from"./vendor-router-CaZtIe2_.js";import{T as u,a as p,b,c as g,d as N,e as f}from"./table-DnBX1p3B.js";import{D as C,a as v,b as y,c as w}from"./dropdown-menu-AnoYYP-z.js";import{a as k}from"./vendor-utils-CfKmydC0.js";import{P as _}from"./plus-DdATqG_B.js";import{T as I}from"./trash-Ca8SLLCq.js";import{B as S}from"./BreadCrumb-B5EzA35k.js";import{C as A}from"./chevron-up-BAx2OvKy.js";import{E as F}from"./ellipsis-vertical-PbPIP7i_.js";import"./vendor-react-DD_RYU77.js";import"./index-CMYgmcqM.js";import"./chevron-right-C95tp0e6.js";import"./check-CxfHQWmE.js";import"./breadcrumb-DEvmmGzh.js";const O=({open:d,onOpenChange:t,customerId:o,onAddChemical:h,customerRefatch:m,refetch:j})=>{const[u,p]=x.useState(""),[b,g]=x.useState([]),{data:N,isLoading:f,error:C}=e(u,{skip:!u||u.length<2});return s.jsx(a,{open:d,onOpenChange:e=>!e&&t(!1),children:s.jsxs(r,{className:"max-w-lg p-6",children:[s.jsx(l,{children:s.jsx(c,{className:"text-lg font-semibold text-[#3b1f91]",children:"Add Chemicals to Customer"})}),s.jsxs("div",{className:"mt-4",children:[s.jsx(i,{placeholder:"Search chemicals",value:u,onChange:e=>p(e.target.value),className:"w-full mb-4"}),f?s.jsx("div",{children:"Loading..."}):u&&N&&N.length>0&&s.jsx("ul",{className:"border bg-white rounded max-h-40 overflow-y-auto",children:N.filter((e=>!b.some((s=>s._id===e._id)))).map((e=>s.jsx("li",{onClick:()=>(e=>{b.some((s=>s._id===e._id))||g((s=>{const a=[...s,e];return p(""),a}))})(e),className:"p-2 hover:bg-gray-200 cursor-pointer",children:e.name},e._id)))}),0===N?.length&&!f&&u&&s.jsx("div",{className:"p-2 text-gray-500",children:"No chemicals found"}),s.jsx("div",{className:"mt-4",children:b.length>0&&s.jsx("div",{className:"space-y-2",children:b.map((e=>s.jsxs("div",{className:"flex justify-between items-center bg-gray-100 p-2 rounded",children:[s.jsx("span",{children:e.name}),s.jsx(n,{variant:"outline",size:"sm",onClick:()=>{return s=e._id,g((e=>e.filter((e=>e._id!==s)))),void j();var s},className:"text-red-500",children:"Remove"})]},e._id)))})}),s.jsxs("div",{className:"flex justify-between mt-4",children:[s.jsx(n,{onClick:async()=>{const e=b.map((e=>e._id)),s={id:o,chemicalId:e};try{await k.put(`/api/customer/addChemicalIdsToCustomer?id=${o}`,s,{headers:{"Content-Type":"application/json"}}),t(!1),h&&h(b),m(),j()}catch(a){}},className:"bg-[#3b1f91] hover:bg-purple-700",disabled:0===b.length,children:"+ Add Chemicals"}),s.jsx(n,{onClick:()=>t(!1),className:"bg-red-600 hover:bg-red-700",children:"Cancel"})]})]})]})})},D=({customerId:e,customerName:i,open:o,onOpenChange:h,customerRefatch:m})=>{const[j,C]=x.useState(!1),{data:v,isLoading:y,isError:w,refetch:k}=d(e,{skip:!o}),[S,{isLoading:A}]=t();if(y)return s.jsx(a,{open:o,onOpenChange:h,children:s.jsxs(r,{children:[s.jsx(l,{children:s.jsx(c,{children:"Loading Chemicals..."})}),s.jsx("p",{children:"Fetching chemical data..."})]})});if(w)return s.jsx(a,{open:o,onOpenChange:h,children:s.jsxs(r,{children:[s.jsx(l,{children:s.jsx(c,{children:"Error Loading Chemicals"})}),s.jsx("p",{children:"Unable to fetch chemical data. Please try again."})]})});const F=v?.data?.chemicalId||[];return s.jsxs(s.Fragment,{children:[s.jsx(a,{open:o,onOpenChange:h,children:s.jsxs(r,{className:"max-w-3xl",children:[s.jsx(l,{children:s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsxs(c,{children:["Chemicals for ",i]}),s.jsxs(n,{className:"m-3",onClick:()=>C(!0),children:[s.jsx(_,{className:"mr-2 h-4 w-4"})," Add Chemical"]})]})}),F.length>0?s.jsxs(u,{children:[s.jsx(p,{children:s.jsxs(b,{children:[s.jsx(g,{children:"Name"}),s.jsx(g,{children:"CAS Number"}),s.jsx(g,{children:"Actions"})," "]})}),s.jsx(N,{children:F.map((a=>s.jsxs(b,{children:[s.jsx(f,{children:a.name}),s.jsx(f,{children:a.cas_number}),s.jsx(f,{children:s.jsx(n,{variant:"destructive",size:"sm",onClick:()=>(async s=>{try{await S({customerId:e,chemicalId:s}),k()}catch(a){}})(a._id),disabled:A,children:s.jsx(I,{})})})]},a._id)))})]}):s.jsx("p",{className:"text-center py-4",children:"No chemicals found for this customer"})]})}),s.jsx(O,{open:j,onOpenChange:C,customerId:e,onAddChemical:e=>{C(!1)},customerRefatch:m,refetch:k})]})},L=({salesOrders:e=[]})=>s.jsxs(u,{children:[s.jsx(p,{children:s.jsxs(b,{children:[s.jsx(g,{children:"Created Date"}),s.jsx(g,{children:"Order Number"}),s.jsx(g,{children:"Payment Status"}),s.jsx(g,{children:"Total Discount"}),s.jsx(g,{children:"Total Tax"}),s.jsx(g,{children:"Total Amount"})]})}),s.jsx(N,{children:0===e.length?s.jsx(b,{children:s.jsx(f,{colSpan:6,className:"text-center",children:"No Data Found"})}):e.map((e=>s.jsxs(b,{children:[s.jsx(f,{children:e.createdDate}),s.jsx(f,{children:e.orderNumber}),s.jsx(f,{children:e.paymentStatus}),s.jsx(f,{children:e.totalDiscount}),s.jsx(f,{children:e.totalTax}),s.jsx(f,{children:e.totalAmount})]},e.orderNumber)))})]}),T=[{label:"Dashboard",href:"/dashboard"},{label:"Customer Table",href:"/supplier-table"}],P=()=>{const[e,a]=x.useState(null),[r,l]=x.useState(!1),[c,d]=x.useState(null),[t]=o(),[k,I]=x.useState(!1),[P,E]=x.useState(!1),{data:z,isLoading:R,error:B,refetch:M}=h(),W=z||[];if(R)return s.jsx("div",{children:"Loading..."});if(B)return s.jsx("div",{children:"Error loading customers"});const $=e=>{};return s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"ml-1",children:s.jsx(S,{items:T})}),s.jsxs("div",{className:"space-y-4 mt-4",children:[s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("h2",{className:"text-xl font-medium text-[#3b1f91]",children:"Customers"}),s.jsx(j,{to:"/customer-form",children:s.jsxs(n,{children:[s.jsx(_,{className:"mr-2 h-4 w-4 "}),"Add Customer"]})})]}),s.jsx("hr",{className:"border-[#3b1f91] border my-4"}),s.jsx("div",{className:"rounded-md border",children:s.jsxs(u,{children:[s.jsx(p,{className:"bg-gray-100 ",children:s.jsxs(b,{children:[s.jsx(g,{className:"w-[50px] border-r-gray-300 bg-gray-100"}),s.jsx(g,{className:"text-black border-r-gray-300 font-semibold",children:"Name"}),s.jsx(g,{className:"text-black border-r-gray-300 font-semibold",children:"Contact Person"}),s.jsx(g,{className:"text-black border-r-gray-300 font-semibold",children:"Email"}),s.jsx(g,{className:"text-black border-r-gray-300 font-semibold",children:"Mobile/Phone"}),s.jsx(g,{className:"text-black border-r-gray-300 font-semibold",children:"Website"}),s.jsx(g,{className:"text-black  font-semibold",children:"Chemicals Count"})]})}),s.jsxs(N,{children:[s.jsxs(b,{className:"bg-gray-100",children:[s.jsx(f,{}),s.jsx(f,{children:s.jsx(i,{placeholder:"Filter name...",className:"max-w-sm"})}),s.jsx(f,{children:s.jsx(i,{placeholder:"Filter contact...",className:"max-w-sm"})}),s.jsx(f,{children:s.jsx(i,{placeholder:"Filter email...",className:"max-w-sm"})}),s.jsx(f,{children:s.jsx(i,{placeholder:"Filter phone...",className:"max-w-sm"})}),s.jsx(f,{children:s.jsx(i,{placeholder:"Filter website...",className:"max-w-sm"})}),s.jsx(f,{children:s.jsx(i,{placeholder:"Filter chemicals...",className:"max-w-sm"})})]}),W.map((r=>s.jsxs(s.Fragment,{children:[s.jsxs(b,{children:[s.jsx(f,{children:s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(n,{variant:"ghost",size:"sm",onClick:()=>{return e=r.id,void a((s=>s===e?null:e));var e},children:e===r.id?s.jsx(A,{className:"h-4 w-4"}):s.jsx(m,{className:"h-4 w-4"})}),s.jsxs(C,{children:[s.jsx(v,{asChild:!0,children:s.jsx(n,{variant:"ghost",size:"sm",children:s.jsx(F,{className:"h-4 w-4"})})}),s.jsxs(y,{align:"end",children:[s.jsx(j,{to:`/edit-customer-form/${r._id}`,children:s.jsx(w,{children:"Edit"})}),s.jsx(w,{className:"text-red-600",onClick:()=>(async e=>{try{I(!0),await t(e),alert("Customer deleted successfully")}catch(s){alert("Failed to delete customer")}finally{I(!1)}})(r._id),disabled:k,children:k?"Deleting...":"Delete"}),s.jsx(w,{onClick:()=>{d(r),E(!0)},children:"Add Chemical"})]})]})]})}),s.jsx(f,{children:r.name}),s.jsx(f,{children:r.contactPerson}),s.jsx(f,{children:r.email}),s.jsx(f,{children:r.phone}),s.jsx(f,{children:r.website}),s.jsx(f,{children:s.jsxs(n,{className:"hover:bg-[#4f359c]",variant:"secondary",size:"sm",onClick:()=>(e=>{d(e),l(!0)})(r),children:["Chemicals (",r.chemicalId.length,")"]})})]},r.id),e===r.id&&s.jsx(b,{children:s.jsx(f,{colSpan:9,children:s.jsx("div",{className:"p-4",children:s.jsx(L,{customerId:r._id})})})})]})))]})]})}),s.jsx(D,{open:r,onOpenChange:l,customerName:c?.name,customerId:c?._id,onAddChemical:$,customerRefatch:M}),s.jsx(O,{open:P,onOpenChange:E,onAddChemical:$,customerId:c?._id})]})]})};export{P as default};
//# sourceMappingURL=CustomerTable-CR5W0fT7.js.map
