import{r as e,j as s}from"./react-BfBsRgn0.js";import{T as r,a,b as i,c as l,d as c,e as n}from"./table-6AWYD7bR.js";import{D as d,a as t,b as o,c as m}from"./dropdown-menu-CAoccP3e.js";import{F as h,D as j,i as x,j as u,k as p,I as b,B as g,R as f,s as N,S as C,q as v}from"./index-cVSOkL6A.js";import{a as y}from"./axios-BoylL8Pu.js";import{h as w,r as k,s as _,C as S,E as A}from"./lucide-D6BDVLHE.js";import{B as F}from"./BreadCrumb-D0swuSFA.js";import{L as I}from"./react-router-DUJjWq5j.js";import"./classnames-C3ovBj6j.js";import"./@radix-ui-BWjeGzol.js";import"./react-dom-DwrudmHt.js";import"./scheduler-BFk34ZWe.js";import"./aria-hidden-BHUiN-rI.js";import"./react-remove-scroll-yauc81_r.js";import"./tslib-Bc9CN1Ef.js";import"./react-remove-scroll-bar-BcxDecei.js";import"./react-style-singleton-C1QVuB2c.js";import"./get-nonce-BYiZHLe3.js";import"./use-sidecar-BA4C4RS7.js";import"./use-callback-ref-Cvx1xcTX.js";import"./@floating-ui-BSChQBl3.js";import"./react-redux-DbBiFgqA.js";import"./use-sync-external-store-DdeJV4gQ.js";import"./@reduxjs-UCSEaN3g.js";import"./redux-C5Huw2aR.js";import"./immer-DgfQkf_7.js";import"./redux-thunk-B3S1iNVp.js";import"./reselect-BSOs5pU1.js";import"./js-cookie-BXEMiIsG.js";import"./class-variance-authority-DeOWI0hf.js";import"./clsx-BeLtu-UY.js";import"./tailwind-merge-D2VJQb_v.js";import"./@syncfusion-CXokIO9o.js";import"./cookie-BUTH-fPQ.js";const D=({open:r,onOpenChange:a,customerId:i,onAddChemical:l,customerRefatch:c,refetch:n})=>{const[d,t]=e.useState(""),[o,m]=e.useState([]),{data:f,isLoading:N,error:C}=h(d,{skip:!d||d.length<2});return s.jsx(j,{open:r,onOpenChange:e=>!e&&a(!1),children:s.jsxs(x,{className:"max-w-lg p-6",children:[s.jsx(u,{children:s.jsx(p,{className:"text-lg font-semibold text-[#3b1f91]",children:"Add Chemicals to Customer"})}),s.jsxs("div",{className:"mt-4",children:[s.jsx(b,{placeholder:"Search chemicals",value:d,onChange:e=>t(e.target.value),className:"w-full mb-4"}),N?s.jsx("div",{children:"Loading..."}):d&&f&&f.length>0&&s.jsx("ul",{className:"border bg-white rounded max-h-40 overflow-y-auto",children:f.filter((e=>!o.some((s=>s._id===e._id)))).map((e=>s.jsx("li",{onClick:()=>(e=>{o.some((s=>s._id===e._id))||m((s=>{const r=[...s,e];return t(""),r}))})(e),className:"p-2 hover:bg-gray-200 cursor-pointer",children:e.name},e._id)))}),0===(null==f?void 0:f.length)&&!N&&d&&s.jsx("div",{className:"p-2 text-gray-500",children:"No chemicals found"}),s.jsx("div",{className:"mt-4",children:o.length>0&&s.jsx("div",{className:"space-y-2",children:o.map((e=>s.jsxs("div",{className:"flex justify-between items-center bg-gray-100 p-2 rounded",children:[s.jsx("span",{children:e.name}),s.jsx(g,{variant:"outline",size:"sm",onClick:()=>{return s=e._id,m((e=>e.filter((e=>e._id!==s)))),void n();var s},className:"text-red-500",children:"Remove"})]},e._id)))})}),s.jsxs("div",{className:"flex justify-between mt-4",children:[s.jsx(g,{onClick:async()=>{const e=o.map((e=>e._id)),s={id:i,chemicalId:e};try{await y.put(`/api/customer/addChemicalIdsToCustomer?id=${i}`,s,{headers:{"Content-Type":"application/json"}}),a(!1),l&&l(o),c(),n()}catch(r){}},className:"bg-[#3b1f91] hover:bg-purple-700",disabled:0===o.length,children:"+ Add Chemicals"}),s.jsx(g,{onClick:()=>a(!1),className:"bg-red-600 hover:bg-red-700",children:"Cancel"})]})]})]})})},O=({customerId:d,customerName:t,open:o,onOpenChange:m,customerRefatch:h})=>{var b;const[C,v]=e.useState(!1),{data:y,isLoading:_,isError:S,refetch:A}=f(d,{skip:!o}),[F,{isLoading:I}]=N();if(_)return s.jsx(j,{open:o,onOpenChange:m,children:s.jsxs(x,{children:[s.jsx(u,{children:s.jsx(p,{children:"Loading Chemicals..."})}),s.jsx("p",{children:"Fetching chemical data..."})]})});if(S)return s.jsx(j,{open:o,onOpenChange:m,children:s.jsxs(x,{children:[s.jsx(u,{children:s.jsx(p,{children:"Error Loading Chemicals"})}),s.jsx("p",{children:"Unable to fetch chemical data. Please try again."})]})});const O=(null==(b=null==y?void 0:y.data)?void 0:b.chemicalId)||[];return s.jsxs(s.Fragment,{children:[s.jsx(j,{open:o,onOpenChange:m,children:s.jsxs(x,{className:"max-w-3xl",children:[s.jsx(u,{children:s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsxs(p,{children:["Chemicals for ",t]}),s.jsxs(g,{className:"m-3",onClick:()=>v(!0),children:[s.jsx(w,{className:"mr-2 h-4 w-4"})," Add Chemical"]})]})}),O.length>0?s.jsxs(r,{children:[s.jsx(a,{children:s.jsxs(i,{children:[s.jsx(l,{children:"Name"}),s.jsx(l,{children:"CAS Number"}),s.jsx(l,{children:"Actions"})," "]})}),s.jsx(c,{children:O.map((e=>s.jsxs(i,{children:[s.jsx(n,{children:e.name}),s.jsx(n,{children:e.cas_number}),s.jsx(n,{children:s.jsx(g,{variant:"destructive",size:"sm",onClick:()=>(async e=>{try{await F({customerId:d,chemicalId:e}),A()}catch(s){}})(e._id),disabled:I,children:s.jsx(k,{})})})]},e._id)))})]}):s.jsx("p",{className:"text-center py-4",children:"No chemicals found for this customer"})]})}),s.jsx(D,{open:C,onOpenChange:v,customerId:d,onAddChemical:e=>{v(!1)},customerRefatch:h,refetch:A})]})},L=({salesOrders:e=[]})=>s.jsxs(r,{children:[s.jsx(a,{children:s.jsxs(i,{children:[s.jsx(l,{children:"Created Date"}),s.jsx(l,{children:"Order Number"}),s.jsx(l,{children:"Payment Status"}),s.jsx(l,{children:"Total Discount"}),s.jsx(l,{children:"Total Tax"}),s.jsx(l,{children:"Total Amount"})]})}),s.jsx(c,{children:0===e.length?s.jsx(i,{children:s.jsx(n,{colSpan:6,className:"text-center",children:"No Data Found"})}):e.map((e=>s.jsxs(i,{children:[s.jsx(n,{children:e.createdDate}),s.jsx(n,{children:e.orderNumber}),s.jsx(n,{children:e.paymentStatus}),s.jsx(n,{children:e.totalDiscount}),s.jsx(n,{children:e.totalTax}),s.jsx(n,{children:e.totalAmount})]},e.orderNumber)))})]}),T=[{label:"Dashboard",href:"/dashboard"},{label:"Customer Table",href:"/supplier-table"}],E=()=>{const[h,j]=e.useState(null),[x,u]=e.useState(!1),[p,f]=e.useState(null),[N]=C(),[y,k]=e.useState(!1),[E,R]=e.useState(!1),{data:z,isLoading:P,error:B,refetch:$}=v(),q=z||[];if(P)return s.jsx("div",{children:"Loading..."});if(B)return s.jsx("div",{children:"Error loading customers"});const J=e=>{};return s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"ml-1",children:s.jsx(F,{items:T})}),s.jsxs("div",{className:"space-y-4 mt-4",children:[s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("h2",{className:"text-xl font-medium text-[#3b1f91]",children:"Customers"}),s.jsx(I,{to:"/customer-form",children:s.jsxs(g,{children:[s.jsx(w,{className:"mr-2 h-4 w-4 "}),"Add Customer"]})})]}),s.jsx("hr",{className:"border-[#3b1f91] border my-4"}),s.jsx("div",{className:"rounded-md border",children:s.jsxs(r,{children:[s.jsx(a,{className:"bg-gray-100 ",children:s.jsxs(i,{children:[s.jsx(l,{className:"w-[50px] border-r-gray-300 bg-gray-100"}),s.jsx(l,{className:"text-black border-r-gray-300 font-semibold",children:"Name"}),s.jsx(l,{className:"text-black border-r-gray-300 font-semibold",children:"Contact Person"}),s.jsx(l,{className:"text-black border-r-gray-300 font-semibold",children:"Email"}),s.jsx(l,{className:"text-black border-r-gray-300 font-semibold",children:"Mobile/Phone"}),s.jsx(l,{className:"text-black border-r-gray-300 font-semibold",children:"Website"}),s.jsx(l,{className:"text-black  font-semibold",children:"Chemicals Count"})]})}),s.jsxs(c,{children:[s.jsxs(i,{className:"bg-gray-100",children:[s.jsx(n,{}),s.jsx(n,{children:s.jsx(b,{placeholder:"Filter name...",className:"max-w-sm"})}),s.jsx(n,{children:s.jsx(b,{placeholder:"Filter contact...",className:"max-w-sm"})}),s.jsx(n,{children:s.jsx(b,{placeholder:"Filter email...",className:"max-w-sm"})}),s.jsx(n,{children:s.jsx(b,{placeholder:"Filter phone...",className:"max-w-sm"})}),s.jsx(n,{children:s.jsx(b,{placeholder:"Filter website...",className:"max-w-sm"})}),s.jsx(n,{children:s.jsx(b,{placeholder:"Filter chemicals...",className:"max-w-sm"})})]}),q.map((e=>s.jsxs(s.Fragment,{children:[s.jsxs(i,{children:[s.jsx(n,{children:s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(g,{variant:"ghost",size:"sm",onClick:()=>{return s=e.id,void j((e=>e===s?null:s));var s},children:h===e.id?s.jsx(_,{className:"h-4 w-4"}):s.jsx(S,{className:"h-4 w-4"})}),s.jsxs(d,{children:[s.jsx(t,{asChild:!0,children:s.jsx(g,{variant:"ghost",size:"sm",children:s.jsx(A,{className:"h-4 w-4"})})}),s.jsxs(o,{align:"end",children:[s.jsx(I,{to:`/edit-customer-form/${e._id}`,children:s.jsx(m,{children:"Edit"})}),s.jsx(m,{className:"text-red-600",onClick:()=>(async e=>{try{k(!0),await N(e),alert("Customer deleted successfully")}catch(s){alert("Failed to delete customer")}finally{k(!1)}})(e._id),disabled:y,children:y?"Deleting...":"Delete"}),s.jsx(m,{onClick:()=>{f(e),R(!0)},children:"Add Chemical"})]})]})]})}),s.jsx(n,{children:e.name}),s.jsx(n,{children:e.contactPerson}),s.jsx(n,{children:e.email}),s.jsx(n,{children:e.phone}),s.jsx(n,{children:e.website}),s.jsx(n,{children:s.jsxs(g,{className:"hover:bg-[#4f359c]",variant:"secondary",size:"sm",onClick:()=>(e=>{f(e),u(!0)})(e),children:["Chemicals (",e.chemicalId.length,")"]})})]},e.id),h===e.id&&s.jsx(i,{children:s.jsx(n,{colSpan:9,children:s.jsx("div",{className:"p-4",children:s.jsx(L,{customerId:e._id})})})})]})))]})]})}),s.jsx(O,{open:x,onOpenChange:u,customerName:null==p?void 0:p.name,customerId:null==p?void 0:p._id,onAddChemical:J,customerRefatch:$}),s.jsx(D,{open:E,onOpenChange:R,onAddChemical:J,customerId:null==p?void 0:p._id})]})]})};export{E as default};
