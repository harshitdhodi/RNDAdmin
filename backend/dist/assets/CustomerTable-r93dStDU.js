import{i as H,K as G,j as e,D as k,m as A,n as T,o as _,I as f,B as j,b as Q,a8 as V,x as $,a9 as U,v as W,P as q}from"./main-B_OYodTY.js";import{c as p,L as R}from"./vendor-CxfDVdnA.js";import{T as F,a as I,b as u,c as r,d as L,e as a}from"./table-4v0nO1xc.js";import{D as K,a as O,b as J,c as E}from"./dropdown-menu-DRxsagvY.js";import{P}from"./plus-B7nEkLih.js";import{B as X}from"./BreadCrumb-CdH6IHXe.js";import{C as Y}from"./chevron-up-EpGLJbSm.js";import{E as Z}from"./ellipsis-vertical-lK1uEpZ2.js";import"./Combination-DgqiAUoz.js";import"./chevron-right-CO2XmaMg.js";import"./check-DEVVPDR5.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ee=H("Trash",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}]]),B=({open:t,onOpenChange:i,customerId:h,onAddChemical:m,customerRefatch:b,refetch:C})=>{const[n,g]=p.useState(""),[d,N]=p.useState([]),{data:o,isLoading:y,error:S}=G(n,{skip:!n||n.length<2}),v=async()=>{const s=d.map(x=>x._id),c={id:h,chemicalId:s};try{await Q.put(`/api/customer/addChemicalIdsToCustomer?id=${h}`,c,{headers:{"Content-Type":"application/json"}}),i(!1),m&&m(d),b(),C()}catch(x){console.error("Error adding chemicals:",x)}},D=s=>{d.some(c=>c._id===s._id)||N(c=>{const x=[...c,s];return g(""),x})},w=s=>{N(c=>c.filter(x=>x._id!==s)),C()};return e.jsx(k,{open:t,onOpenChange:s=>!s&&i(!1),children:e.jsxs(A,{className:"max-w-lg p-6",children:[e.jsx(T,{children:e.jsx(_,{className:"text-lg font-semibold text-[#3b1f91]",children:"Add Chemicals to Customer"})}),e.jsxs("div",{className:"mt-4",children:[e.jsx(f,{placeholder:"Search chemicals",value:n,onChange:s=>g(s.target.value),className:"w-full mb-4"}),y?e.jsx("div",{children:"Loading..."}):n&&o&&o.length>0&&e.jsx("ul",{className:"border bg-white rounded max-h-40 overflow-y-auto",children:o.filter(s=>!d.some(c=>c._id===s._id)).map(s=>e.jsx("li",{onClick:()=>D(s),className:"p-2 hover:bg-gray-200 cursor-pointer",children:s.name},s._id))}),o?.length===0&&!y&&n&&e.jsx("div",{className:"p-2 text-gray-500",children:"No chemicals found"}),e.jsx("div",{className:"mt-4",children:d.length>0&&e.jsx("div",{className:"space-y-2",children:d.map(s=>e.jsxs("div",{className:"flex justify-between items-center bg-gray-100 p-2 rounded",children:[e.jsx("span",{children:s.name}),e.jsx(j,{variant:"outline",size:"sm",onClick:()=>w(s._id),className:"text-red-500",children:"Remove"})]},s._id))})}),e.jsxs("div",{className:"flex justify-between mt-4",children:[e.jsx(j,{onClick:v,className:"bg-[#3b1f91] hover:bg-purple-700",disabled:d.length===0,children:"+ Add Chemicals"}),e.jsx(j,{onClick:()=>i(!1),className:"bg-red-600 hover:bg-red-700",children:"Cancel"})]})]})]})})},se=({customerId:t,customerName:i,open:h,onOpenChange:m,customerRefatch:b})=>{const[C,n]=p.useState(!1),{data:g,isLoading:d,isError:N,refetch:o}=V(t,{skip:!h}),[y,{isLoading:S}]=$(),v=s=>{console.log("Adding chemical:",s),n(!1)},D=async s=>{try{await y({customerId:t,chemicalId:s}),o()}catch(c){console.error("Error deleting chemical:",c)}};if(d)return e.jsx(k,{open:h,onOpenChange:m,children:e.jsxs(A,{children:[e.jsx(T,{children:e.jsx(_,{children:"Loading Chemicals..."})}),e.jsx("p",{children:"Fetching chemical data..."})]})});if(N)return e.jsx(k,{open:h,onOpenChange:m,children:e.jsxs(A,{children:[e.jsx(T,{children:e.jsx(_,{children:"Error Loading Chemicals"})}),e.jsx("p",{children:"Unable to fetch chemical data. Please try again."})]})});const w=g?.data?.chemicalId||[];return e.jsxs(e.Fragment,{children:[e.jsx(k,{open:h,onOpenChange:m,children:e.jsxs(A,{className:"max-w-3xl",children:[e.jsx(T,{children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs(_,{children:["Chemicals for ",i]}),e.jsxs(j,{className:"m-3",onClick:()=>n(!0),children:[e.jsx(P,{className:"mr-2 h-4 w-4"})," Add Chemical"]})]})}),w.length>0?e.jsxs(F,{children:[e.jsx(I,{children:e.jsxs(u,{children:[e.jsx(r,{children:"Name"}),e.jsx(r,{children:"CAS Number"}),e.jsx(r,{children:"Actions"})," "]})}),e.jsx(L,{children:w.map(s=>e.jsxs(u,{children:[e.jsx(a,{children:s.name}),e.jsx(a,{children:s.cas_number}),e.jsx(a,{children:e.jsx(j,{variant:"destructive",size:"sm",onClick:()=>D(s._id),disabled:S,children:e.jsx(ee,{})})})]},s._id))})]}):e.jsx("p",{className:"text-center py-4",children:"No chemicals found for this customer"})]})}),e.jsx(B,{open:C,onOpenChange:n,customerId:t,onAddChemical:v,customerRefatch:b,refetch:o})]})},ae=({salesOrders:t=[]})=>e.jsxs(F,{children:[e.jsx(I,{children:e.jsxs(u,{children:[e.jsx(r,{children:"Created Date"}),e.jsx(r,{children:"Order Number"}),e.jsx(r,{children:"Payment Status"}),e.jsx(r,{children:"Total Discount"}),e.jsx(r,{children:"Total Tax"}),e.jsx(r,{children:"Total Amount"})]})}),e.jsx(L,{children:t.length===0?e.jsx(u,{children:e.jsx(a,{colSpan:6,className:"text-center",children:"No Data Found"})}):t.map(i=>e.jsxs(u,{children:[e.jsx(a,{children:i.createdDate}),e.jsx(a,{children:i.orderNumber}),e.jsx(a,{children:i.paymentStatus}),e.jsx(a,{children:i.totalDiscount}),e.jsx(a,{children:i.totalTax}),e.jsx(a,{children:i.totalAmount})]},i.orderNumber))})]}),le=[{label:"Dashboard",href:"/dashboard"},{label:"Customer Table",href:"/supplier-table"}],ue=()=>{const[t,i]=p.useState(null),[h,m]=p.useState(!1),[b,C]=p.useState(null),[n]=U(),[g,d]=p.useState(!1),[N,o]=p.useState(!1),{data:y,isLoading:S,error:v,refetch:D}=W(),w=y||[];if(S)return e.jsx("div",{children:"Loading..."});if(v)return e.jsx("div",{children:"Error loading customers"});const s=l=>{i(M=>M===l?null:l)},c=l=>{console.log(`Adding chemical: ${l}`)},x=l=>{C(l),m(!0)},z=async l=>{try{d(!0),await n(l),alert("Customer deleted successfully")}catch{alert("Failed to delete customer")}finally{d(!1)}};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"ml-1",children:e.jsx(X,{items:le})}),e.jsxs("div",{className:"space-y-4 mt-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h2",{className:"text-xl font-medium text-[#3b1f91]",children:"Customers"}),e.jsx(R,{to:"/customer-form",children:e.jsxs(j,{children:[e.jsx(P,{className:"mr-2 h-4 w-4 "}),"Add Customer"]})})]}),e.jsx("hr",{className:"border-[#3b1f91] border my-4"}),e.jsx("div",{className:"rounded-md border",children:e.jsxs(F,{children:[e.jsx(I,{className:"bg-gray-100 ",children:e.jsxs(u,{children:[e.jsx(r,{className:"w-[50px] border-r-gray-300 bg-gray-100"}),e.jsx(r,{className:"text-black border-r-gray-300 font-semibold",children:"Name"}),e.jsx(r,{className:"text-black border-r-gray-300 font-semibold",children:"Contact Person"}),e.jsx(r,{className:"text-black border-r-gray-300 font-semibold",children:"Email"}),e.jsx(r,{className:"text-black border-r-gray-300 font-semibold",children:"Mobile/Phone"}),e.jsx(r,{className:"text-black border-r-gray-300 font-semibold",children:"Website"}),e.jsx(r,{className:"text-black  font-semibold",children:"Chemicals Count"})]})}),e.jsxs(L,{children:[e.jsxs(u,{className:"bg-gray-100",children:[e.jsx(a,{}),e.jsx(a,{children:e.jsx(f,{placeholder:"Filter name...",className:"max-w-sm"})}),e.jsx(a,{children:e.jsx(f,{placeholder:"Filter contact...",className:"max-w-sm"})}),e.jsx(a,{children:e.jsx(f,{placeholder:"Filter email...",className:"max-w-sm"})}),e.jsx(a,{children:e.jsx(f,{placeholder:"Filter phone...",className:"max-w-sm"})}),e.jsx(a,{children:e.jsx(f,{placeholder:"Filter website...",className:"max-w-sm"})}),e.jsx(a,{children:e.jsx(f,{placeholder:"Filter chemicals...",className:"max-w-sm"})})]}),w.map(l=>e.jsxs(e.Fragment,{children:[e.jsxs(u,{children:[e.jsx(a,{children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(j,{variant:"ghost",size:"sm",onClick:()=>s(l.id),children:t===l.id?e.jsx(Y,{className:"h-4 w-4"}):e.jsx(q,{className:"h-4 w-4"})}),e.jsxs(K,{children:[e.jsx(O,{asChild:!0,children:e.jsx(j,{variant:"ghost",size:"sm",children:e.jsx(Z,{className:"h-4 w-4"})})}),e.jsxs(J,{align:"end",children:[e.jsx(R,{to:`/edit-customer-form/${l._id}`,children:e.jsx(E,{children:"Edit"})}),e.jsx(E,{className:"text-red-600",onClick:()=>z(l._id),disabled:g,children:g?"Deleting...":"Delete"}),e.jsx(E,{onClick:()=>{C(l),o(!0)},children:"Add Chemical"})]})]})]})}),e.jsx(a,{children:l.name}),e.jsx(a,{children:l.contactPerson}),e.jsx(a,{children:l.email}),e.jsx(a,{children:l.phone}),e.jsx(a,{children:l.website}),e.jsx(a,{children:e.jsxs(j,{className:"hover:bg-[#4f359c]",variant:"secondary",size:"sm",onClick:()=>x(l),children:["Chemicals (",l.chemicalId.length,")"]})})]},l.id),t===l.id&&e.jsx(u,{children:e.jsx(a,{colSpan:9,children:e.jsx("div",{className:"p-4",children:e.jsx(ae,{customerId:l._id})})})})]}))]})]})}),e.jsx(se,{open:h,onOpenChange:m,customerName:b?.name,customerId:b?._id,onAddChemical:c,customerRefatch:D}),e.jsx(B,{open:N,onOpenChange:o,onAddChemical:c,customerId:b?._id})]})]})};export{ue as default};
