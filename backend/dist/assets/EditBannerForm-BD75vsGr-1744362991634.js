import{bJ as y,bK as B,j as e,b as F}from"./main-4qLjs9DC-1744362991634.js";import{i as L,f as P,c as n,L as p}from"./vendor-C9iLKeEQ-1744362991634.js";import{R as E}from"./index-DBeqC7Bh-1744362991634.js";/* empty css                                 */import{F as r}from"./index-DW8oOCb8-1744362991634.js";import{B as l}from"./Breadcrumb-M9mtmHv2-1744362991634.js";import{R as w}from"./HomeOutlined-_TtdPbDL-1744362991634.js";import{S as u}from"./index-NTQ2_5ui-1744362991634.js";import{U as q,R}from"./index-DDs19gMu-1744362991634.js";import{B as c}from"./index-KVtzR29S-1744362991634.js";import{I as d}from"./index-BsE1OYP1-1744362991634.js";import{s as m}from"./index-Bd6uC6rh-1744362991634.js";import"./isEqual-D_2kg5Y--1744362991634.js";import"./toArray-Bbgf03cS-1744362991634.js";import"./CheckCircleFilled-C3q27Cea-1744362991634.js";import"./ExclamationCircleFilled-CcTejJYc-1744362991634.js";import"./dropdown-D-MlIyxB-1744362991634.js";import"./EllipsisOutlined-BU33D6Nw-1744362991634.js";import"./TextArea-CI-mQ3ZF-1744362991634.js";import"./CheckOutlined-BpOl7NFo-1744362991634.js";import"./fade-C9qzS4sj-1744362991634.js";import"./useForceUpdate-D5st5PaX-1744362991634.js";import"./DeleteOutlined-_qmzhm1M-1744362991634.js";import"./DownloadOutlined-ByB2redz-1744362991634.js";import"./InfoCircleFilled-BS3KWSKr-1744362991634.js";const{Option:C}=u,re=()=>{const{id:g}=L(),h=P(),[s]=r.useForm(),[o,f]=n.useState(!1),[x,j]=n.useState([]),{data:a,isLoading:N}=y(g),[b]=B();n.useEffect(()=>{(async()=>{try{const i=await F.get("/api/menulist/get-menu");i.data.success&&j(i.data.data)}catch(i){console.error("Error fetching menu list:",i),m.error("Failed to fetch menu list")}})()},[]),n.useEffect(()=>{a&&s.setFieldsValue({title:a.title,altName:a.altName,details:a.details,imgName:a.imgName,pageSlug:a.pageSlug||"",image:a.image?[{name:a.imgName,url:`/api/image/download/${a.image}`}]:[]})},[a,s]);const I=t=>{f(!0),s.setFieldsValue({imgName:t.file.name,image:t.fileList})},S=async t=>{try{if(!t.title?.trim()){m.error("Title is required");return}if(!t.altName?.trim()){m.error("Alt Name is required");return}if(!t.pageSlug){m.error("Page Slug is required");return}const i=new FormData;o&&t.image?.[0]?.originFileObj?(i.append("image",t.image[0].originFileObj),i.append("imgName",t.image[0].name)):i.append("imgName",t.imgName||a.imgName),i.append("title",t.title.trim()),i.append("altName",t.altName.trim()),i.append("details",t.details?.trim()||""),i.append("pageSlug",t.pageSlug),await b({id:g,bannerData:i}),m.success("Banner updated successfully"),h("/banner-table")}catch(i){console.error(i),m.error("Failed to update banner")}};return N?e.jsx("div",{children:"Loading..."}):e.jsxs("div",{children:[e.jsxs(l,{style:{padding:"16px 24px"},children:[e.jsx(l.Item,{children:e.jsxs(p,{to:"/dashboard",children:[e.jsx(w,{})," Dashboard"]})}),e.jsx(l.Item,{children:e.jsx(p,{to:"/banner-table",children:"Banner Management"})}),e.jsx(l.Item,{children:"Edit Banner"})]}),e.jsxs("div",{style:{padding:"24px"},children:[e.jsx("h1",{className:"text-2xl font-bold mb-6",children:"Edit Banner"}),e.jsxs(r,{form:s,layout:"vertical",onFinish:S,initialValues:{title:a?.title||"",altName:a?.altName||"",details:a?.details||"",imgName:a?.imgName||"",pageSlug:a?.pageSlug||"",image:a?.image?[{name:a.imgName,url:`/api/image/download/${a.image}`}]:[]},children:[e.jsx(r.Item,{name:"pageSlug",label:"Page Slug",rules:[{required:!0,message:"Please select a Page Slug!"}],children:e.jsx(u,{placeholder:"Select Page Slug",children:x.map(t=>e.jsx(C,{value:t.parent.path,children:t.parent.name},t._id))})}),e.jsx(r.Item,{name:"image",label:"Banner Image",valuePropName:"fileList",getValueFromEvent:t=>t&&t.fileList,children:e.jsx(q,{maxCount:1,listType:"picture",beforeUpload:()=>!1,onChange:I,defaultFileList:a?.image?[{name:a.imgName,url:`/api/image/download/${a.image}`}]:[],children:e.jsx(c,{icon:e.jsx(R,{}),children:o?"Change Image":"Upload New Image"})})}),e.jsx(r.Item,{name:"imgName",label:"Image Name",rules:[{required:!0,message:"Please input image name!"}],children:e.jsx(d,{disabled:o})}),e.jsx(r.Item,{name:"title",label:"Title",rules:[{required:!0,message:"Please input title!"}],children:e.jsx(d,{})}),e.jsx(r.Item,{name:"altName",label:"Alt Name",rules:[{required:!0,message:"Please input alt name!"}],children:e.jsx(d,{})}),e.jsx(r.Item,{name:"details",label:"Details",rules:[{message:"Please input details!"}],children:e.jsx(E,{theme:"snow"})}),e.jsx(r.Item,{children:e.jsx(c,{type:"primary",htmlType:"submit",children:"Update"})})]})]})]})};export{re as default};
