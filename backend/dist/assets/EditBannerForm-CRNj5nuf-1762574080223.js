import{a as w,f as q,r as o,b_ as R,b$ as _,j as a,L as j,c as C}from"./index-BzNp1rbR-1762574080223.js";import{R as U}from"./index-DFC46Kmd-1762574080223.js";/* empty css                                 */import{F as s}from"./index-CEN0Bx9D-1762574080223.js";import{B as p}from"./Breadcrumb-CxJpjmx9-1762574080223.js";import{R as D}from"./HomeOutlined-CsWRKbAj-1762574080223.js";import{S as I}from"./index-BpuT-O-l-1762574080223.js";import{U as T,R as V}from"./index-B1mybfrS-1762574080223.js";import{B as N}from"./index-Dre6a3HU-1762574080223.js";import{I as h}from"./index-CUn4GkN7-1762574080223.js";import{s as l}from"./index-C6HBjeBK-1762574080223.js";import"./isEqual-EKFdrYfS-1762574080223.js";import"./toArray-Bbgf03cS-1762574080223.js";import"./CheckCircleFilled-DG3jweE6-1762574080223.js";import"./ExclamationCircleFilled-lICnbixU-1762574080223.js";import"./dropdown-DiCFQcjx-1762574080223.js";import"./EllipsisOutlined-Cy0NeZek-1762574080223.js";import"./TextArea-fJBC8TiN-1762574080223.js";import"./CheckOutlined-D1heL4Mx-1762574080223.js";import"./fade-pTul-3Wg-1762574080223.js";import"./useForceUpdate-B9zKdnYB-1762574080223.js";import"./DeleteOutlined-FLEvWctK-1762574080223.js";import"./DownloadOutlined-CbONPB2H-1762574080223.js";import"./InfoCircleFilled-DsCgEkQ9-1762574080223.js";const{Option:f}=I,de=()=>{const{id:x}=w(),S=q(),[d]=s.useForm(),[g,y]=o.useState(!1),[B,F]=o.useState([]),[L,b]=o.useState(!0),{data:e,isLoading:$}=R(x),[E]=_();o.useEffect(()=>{(async()=>{try{const r=await C.get("/api/menulist/get-menu");r.data.success?F(r.data.data):l.error("Failed to load menu list")}catch(r){console.error("Error fetching menu list:",r),l.error("Error fetching menu list")}finally{b(!1)}})()},[]),o.useEffect(()=>{e&&d.setFieldsValue({title:e.title,altName:e.altName,details:e.details,imgName:e.imgName,pageSlug:e.pageSlug||"",image:e.image?[{name:e.imgName,url:`/api/image/download/${e.image}`}]:[]})},[e,d]);const M=t=>{y(!0),d.setFieldsValue({imgName:t.file.name,image:t.fileList})},P=async t=>{var r,m,c,n,u;try{if(!((r=t.title)!=null&&r.trim())){l.error("Title is required");return}if(!((m=t.altName)!=null&&m.trim())){l.error("Alt Name is required");return}if(!t.pageSlug){l.error("Page Slug is required");return}const i=new FormData;g&&((n=(c=t.image)==null?void 0:c[0])!=null&&n.originFileObj)?(i.append("image",t.image[0].originFileObj),i.append("imgName",t.image[0].name)):i.append("imgName",t.imgName||e.imgName),i.append("title",t.title.trim()),i.append("altName",t.altName.trim()),i.append("details",((u=t.details)==null?void 0:u.trim())||""),i.append("pageSlug",t.pageSlug),await E({id:x,bannerData:i}),l.success("Banner updated successfully"),S("/banner-table")}catch(i){console.error(i),l.error("Failed to update banner")}};return $?a.jsx("div",{children:"Loading..."}):a.jsxs("div",{children:[a.jsxs(p,{className:"px-4 py-6",children:[a.jsx(p.Item,{children:a.jsxs(j,{to:"/dashboard",children:[a.jsx(D,{})," Dashboard"]})}),a.jsx(p.Item,{children:a.jsx(j,{to:"/banner-table",children:"Banner Management"})}),a.jsx(p.Item,{children:"Edit Banner"})]}),a.jsxs("div",{className:"p-6",children:[a.jsx("h1",{className:"text-2xl font-bold mb-6",children:"Edit Banner"}),a.jsxs(s,{form:d,layout:"vertical",onFinish:P,initialValues:{title:(e==null?void 0:e.title)||"",altName:(e==null?void 0:e.altName)||"",details:(e==null?void 0:e.details)||"",imgName:(e==null?void 0:e.imgName)||"",pageSlug:(e==null?void 0:e.pageSlug)||"",image:e!=null&&e.image?[{name:e.imgName,url:`/api/image/download/${e.image}`}]:[]},children:[a.jsx(s.Item,{name:"pageSlug",label:"Page Slug",rules:[{required:!0,message:"Please select a page slug!"}],children:a.jsx(I,{placeholder:"Select a menu item",loading:L,children:B.flatMap((t,r)=>[a.jsx(f,{value:t.parent.path,className:"font-bold",children:t.parent.name},`menu-${t._id}`),...t.children.flatMap((m,c)=>[a.jsxs(f,{value:m.path,className:"pl-5",children:[a.jsx("span",{children:" ├── "}),m.name]},`child-${t._id}-${m._id}`),...m.subChildren.map((n,u)=>a.jsxs(f,{value:n.path,className:"pl-10",children:[a.jsx("span",{children:"├────"})," ",n.name]},`subchild-${t._id}-${m._id}-${n._id}`))])])})}),a.jsx(s.Item,{name:"image",label:"Banner Image",valuePropName:"fileList",getValueFromEvent:t=>t&&t.fileList,children:a.jsx(T,{maxCount:1,listType:"picture",beforeUpload:()=>!1,onChange:M,defaultFileList:e!=null&&e.image?[{name:e.imgName,url:`/api/image/download/${e.image}`}]:[],children:a.jsx(N,{icon:a.jsx(V,{}),children:g?"Change Image":"Upload New Image"})})}),a.jsx(s.Item,{name:"imgName",label:"Image Name",rules:[{required:!0,message:"Please input image name!"}],children:a.jsx(h,{disabled:g})}),a.jsx(s.Item,{name:"title",label:"Title",rules:[{required:!0,message:"Please input title!"}],children:a.jsx(h,{})}),a.jsx(s.Item,{name:"altName",label:"Alt Name",rules:[{required:!0,message:"Please input alt name!"}],children:a.jsx(h,{})}),a.jsx(s.Item,{name:"details",label:"Details",rules:[{message:"Please input details!"}],children:a.jsx(U,{theme:"snow"})}),a.jsx(s.Item,{children:a.jsx(N,{type:"primary",htmlType:"submit",children:"Update"})})]})]})]})};export{de as default};
