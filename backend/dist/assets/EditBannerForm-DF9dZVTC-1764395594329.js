import{a as M,f as C,r as n,c4 as U,c5 as D,j as a,L as j,R as N,c as _}from"./index-hVri1bw9-1764395594329.js";import{R as $}from"./index-Cu6WweBG-1764395594329.js";/* empty css                                 */import{F as r}from"./index-C07QsCy_-1764395594329.js";import{B as d}from"./Breadcrumb-BbK0fJvT-1764395594329.js";import{R as T}from"./HomeOutlined-9fT2rjPt-1764395594329.js";import{S as F}from"./index-5fCYg7FX-1764395594329.js";import{U as V,R as O}from"./index-Dke0qQ_i-1764395594329.js";import{B as I}from"./index-Vz4GTmeV-1764395594329.js";import{I as g}from"./index-yr2eBg36-1764395594329.js";import{s as m}from"./index-B44g-h7k-1764395594329.js";import"./isEqual-asQVdY7h-1764395594329.js";import"./toArray-Bbgf03cS-1764395594329.js";import"./CheckCircleFilled-FHAo7tTs-1764395594329.js";import"./ExclamationCircleFilled-BjQh_O2k-1764395594329.js";import"./dropdown-DmNOe_LX-1764395594329.js";import"./EllipsisOutlined-kjtz1ZDr-1764395594329.js";import"./TextArea-0a4D3yre-1764395594329.js";import"./CheckOutlined-DJDmJSRr-1764395594329.js";import"./fade-RUaLsAGn-1764395594329.js";import"./useForceUpdate-siptFCzz-1764395594329.js";import"./DeleteOutlined-BFyOSsD7-1764395594329.js";import"./DownloadOutlined-BeMLH6qZ-1764395594329.js";import"./InfoCircleFilled-DGIFRtU_-1764395594329.js";const{Option:c}=F,pe=()=>{const{id:u}=M(),S=C(),[o]=r.useForm(),[p,y]=n.useState(!1),[B,L]=n.useState([]),[b,E]=n.useState(!0),{data:e,isLoading:P}=U(u),[R]=D();n.useEffect(()=>{(async()=>{try{const i=await _.get("/api/menulist/get-menu");i.data.success?L(i.data.data):m.error("Failed to load menu list")}catch(i){console.error("Error fetching menu list:",i),m.error("Error fetching menu list")}finally{E(!1)}})()},[]),n.useEffect(()=>{e&&o.setFieldsValue({title:e.title,altName:e.altName,details:e.details,imgName:e.imgName,pageSlug:e.pageSlug||"",image:e.image?[{name:e.imgName,url:`/api/image/download/${e.image}`}]:[]})},[e,o]);const w=t=>{y(!0),o.setFieldsValue({imgName:t.file.name,image:t.fileList})},q=async t=>{var i,l,h,x,f;try{if(!((i=t.title)!=null&&i.trim())){m.error("Title is required");return}if(!((l=t.altName)!=null&&l.trim())){m.error("Alt Name is required");return}if(!t.pageSlug){m.error("Page Slug is required");return}const s=new FormData;p&&((x=(h=t.image)==null?void 0:h[0])!=null&&x.originFileObj)?(s.append("image",t.image[0].originFileObj),s.append("imgName",t.image[0].name)):s.append("imgName",t.imgName||e.imgName),s.append("title",t.title.trim()),s.append("altName",t.altName.trim()),s.append("details",((f=t.details)==null?void 0:f.trim())||""),s.append("pageSlug",t.pageSlug),await R({id:u,bannerData:s}),m.success("Banner updated successfully"),S("/banner-table")}catch(s){console.error(s),m.error("Failed to update banner")}};return P?a.jsx("div",{children:"Loading..."}):a.jsxs("div",{children:[a.jsxs(d,{className:"px-4 py-6",children:[a.jsx(d.Item,{children:a.jsxs(j,{to:"/dashboard",children:[a.jsx(T,{})," Dashboard"]})}),a.jsx(d.Item,{children:a.jsx(j,{to:"/banner-table",children:"Banner Management"})}),a.jsx(d.Item,{children:"Edit Banner"})]}),a.jsxs("div",{className:"p-6",children:[a.jsx("h1",{className:"text-2xl font-bold mb-6",children:"Edit Banner"}),a.jsxs(r,{form:o,layout:"vertical",onFinish:q,initialValues:{title:(e==null?void 0:e.title)||"",altName:(e==null?void 0:e.altName)||"",details:(e==null?void 0:e.details)||"",imgName:(e==null?void 0:e.imgName)||"",pageSlug:(e==null?void 0:e.pageSlug)||"",image:e!=null&&e.image?[{name:e.imgName,url:`/api/image/download/${e.image}`}]:[]},children:[a.jsx(r.Item,{name:"pageSlug",label:"Page Slug",rules:[{required:!0,message:"Please select a page slug!"}],children:a.jsx(F,{placeholder:"Select a menu item",loading:b,children:B.map(t=>a.jsxs(N.Fragment,{children:[a.jsx(c,{value:t.parent.path,className:"font-bold",children:t.parent.name},`${t._id}-parent`),t.children&&t.children.map(i=>a.jsxs(N.Fragment,{children:[a.jsxs(c,{value:i.path,className:"pl-5",children:[a.jsx("span",{children:" ├── "}),i.name]},i._id),i.subChildren&&i.subChildren.map(l=>a.jsxs(c,{value:l.path,className:"pl-10",children:[a.jsx("span",{children:"├────"})," ",l.name]},l._id))]},i._id))]},t._id))})}),a.jsx(r.Item,{name:"image",label:"Banner Image",valuePropName:"fileList",getValueFromEvent:t=>t&&t.fileList,children:a.jsx(V,{maxCount:1,listType:"picture",beforeUpload:()=>!1,onChange:w,defaultFileList:e!=null&&e.image?[{name:e.imgName,url:`/api/image/download/${e.image}`}]:[],children:a.jsx(I,{icon:a.jsx(O,{}),children:p?"Change Image":"Upload New Image"})})}),a.jsx(r.Item,{name:"imgName",label:"Image Name",rules:[{required:!0,message:"Please input image name!"}],children:a.jsx(g,{disabled:p})}),a.jsx(r.Item,{name:"title",label:"Title",rules:[{required:!0,message:"Please input title!"}],children:a.jsx(g,{})}),a.jsx(r.Item,{name:"altName",label:"Alt Name",rules:[{required:!0,message:"Please input alt name!"}],children:a.jsx(g,{})}),a.jsx(r.Item,{name:"details",label:"Details",rules:[{message:"Please input details!"}],children:a.jsx($,{theme:"snow"})}),a.jsx(r.Item,{children:a.jsx(I,{type:"primary",htmlType:"submit",children:"Update"})})]})]})]})};export{pe as default};
