import{a as E,e as w,r as n,bZ as q,b_ as R,j as a,L as x,c as C}from"./index-CoKL1xyR-1744632447889.js";import{R as M}from"./index-B1pckzOy-1744632447889.js";/* empty css                                 */import{F as r}from"./index-CoWZrSjE-1744632447889.js";import{B as o}from"./Breadcrumb-BrfCkZMc-1744632447889.js";import{R as U}from"./HomeOutlined-D4nQZQwO-1744632447889.js";import{S as N}from"./index-DFNkRd0y-1744632447889.js";import{U as D,R as T}from"./index-CO6pVMCh-1744632447889.js";import{B as j}from"./index-cVJB2HR6-1744632447889.js";import{I as g}from"./index-GrCLMWOz-1744632447889.js";import{s as m}from"./index-DiDBl6bO-1744632447889.js";import"./isEqual-BO6aAnsW-1744632447889.js";import"./toArray-Bbgf03cS-1744632447889.js";import"./CheckCircleFilled-DAbHetmO-1744632447889.js";import"./ExclamationCircleFilled-BxOFUGLG-1744632447889.js";import"./dropdown-DHu4tSOY-1744632447889.js";import"./EllipsisOutlined-DyyIAYDZ-1744632447889.js";import"./TextArea-iGqqNGHZ-1744632447889.js";import"./CheckOutlined-B_1S2Xn6-1744632447889.js";import"./fade-CnYGikE2-1744632447889.js";import"./useForceUpdate-BWllubeQ-1744632447889.js";import"./DeleteOutlined-WPmjwrbd-1744632447889.js";import"./DownloadOutlined-BTJyMuPS-1744632447889.js";import"./InfoCircleFilled-nsvEX4jc-1744632447889.js";const{Option:V}=N,ne=()=>{const{id:p}=E(),I=w(),[l]=r.useForm(),[d,S]=n.useState(!1),[B,F]=n.useState([]),{data:e,isLoading:y}=q(p),[L]=R();n.useEffect(()=>{(async()=>{try{const s=await C.get("/api/menulist/get-menu");s.data.success&&F(s.data.data)}catch(s){console.error("Error fetching menu list:",s),m.error("Failed to fetch menu list")}})()},[]),n.useEffect(()=>{e&&l.setFieldsValue({title:e.title,altName:e.altName,details:e.details,imgName:e.imgName,pageSlug:e.pageSlug||"",image:e.image?[{name:e.imgName,url:`/api/image/download/${e.image}`}]:[]})},[e,l]);const b=t=>{S(!0),l.setFieldsValue({imgName:t.file.name,image:t.fileList})},P=async t=>{var s,c,u,h,f;try{if(!((s=t.title)!=null&&s.trim())){m.error("Title is required");return}if(!((c=t.altName)!=null&&c.trim())){m.error("Alt Name is required");return}if(!t.pageSlug){m.error("Page Slug is required");return}const i=new FormData;d&&((h=(u=t.image)==null?void 0:u[0])!=null&&h.originFileObj)?(i.append("image",t.image[0].originFileObj),i.append("imgName",t.image[0].name)):i.append("imgName",t.imgName||e.imgName),i.append("title",t.title.trim()),i.append("altName",t.altName.trim()),i.append("details",((f=t.details)==null?void 0:f.trim())||""),i.append("pageSlug",t.pageSlug),await L({id:p,bannerData:i}),m.success("Banner updated successfully"),I("/banner-table")}catch(i){console.error(i),m.error("Failed to update banner")}};return y?a.jsx("div",{children:"Loading..."}):a.jsxs("div",{children:[a.jsxs(o,{className:"px-4 py-6",children:[a.jsx(o.Item,{children:a.jsxs(x,{to:"/dashboard",children:[a.jsx(U,{})," Dashboard"]})}),a.jsx(o.Item,{children:a.jsx(x,{to:"/banner-table",children:"Banner Management"})}),a.jsx(o.Item,{children:"Edit Banner"})]}),a.jsxs("div",{className:"p-6",children:[a.jsx("h1",{className:"text-2xl font-bold mb-6",children:"Edit Banner"}),a.jsxs(r,{form:l,layout:"vertical",onFinish:P,initialValues:{title:(e==null?void 0:e.title)||"",altName:(e==null?void 0:e.altName)||"",details:(e==null?void 0:e.details)||"",imgName:(e==null?void 0:e.imgName)||"",pageSlug:(e==null?void 0:e.pageSlug)||"",image:e!=null&&e.image?[{name:e.imgName,url:`/api/image/download/${e.image}`}]:[]},children:[a.jsx(r.Item,{name:"pageSlug",label:"Page Slug",rules:[{required:!0,message:"Please select a Page Slug!"}],children:a.jsx(N,{placeholder:"Select Page Slug",children:B.map(t=>a.jsx(V,{value:t.parent.path,children:t.parent.name},t._id))})}),a.jsx(r.Item,{name:"image",label:"Banner Image",valuePropName:"fileList",getValueFromEvent:t=>t&&t.fileList,children:a.jsx(D,{maxCount:1,listType:"picture",beforeUpload:()=>!1,onChange:b,defaultFileList:e!=null&&e.image?[{name:e.imgName,url:`/api/image/download/${e.image}`}]:[],children:a.jsx(j,{icon:a.jsx(T,{}),children:d?"Change Image":"Upload New Image"})})}),a.jsx(r.Item,{name:"imgName",label:"Image Name",rules:[{required:!0,message:"Please input image name!"}],children:a.jsx(g,{disabled:d})}),a.jsx(r.Item,{name:"title",label:"Title",rules:[{required:!0,message:"Please input title!"}],children:a.jsx(g,{})}),a.jsx(r.Item,{name:"altName",label:"Alt Name",rules:[{required:!0,message:"Please input alt name!"}],children:a.jsx(g,{})}),a.jsx(r.Item,{name:"details",label:"Details",rules:[{message:"Please input details!"}],children:a.jsx(M,{theme:"snow"})}),a.jsx(r.Item,{children:a.jsx(j,{type:"primary",htmlType:"submit",children:"Update"})})]})]})]})};export{ne as default};
