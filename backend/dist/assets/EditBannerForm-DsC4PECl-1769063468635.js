import{a as T,f as C,dP as n,r as d,d$ as D,e0 as R,j as a,dT as o,L as f,dZ as U,bl as b,R as N,dV as $,be as I,dW as V,dU as r,as as _,c as A,dp as l}from"./index-BtPp14pW-1769063468635.js";const{Option:u}=b,{TextArea:O}=r,k=()=>{const{id:p}=T(),S=C(),[g]=n.useForm(),[c,q]=d.useState(!1),[F,y]=d.useState([]),[L,B]=d.useState(!0),{data:e,isLoading:E}=D(p),[P]=R();d.useEffect(()=>{(async()=>{try{const s=await A.get("/api/menulist/get-menu");s.data.success?y(s.data.data):l.error("Failed to load menu list")}catch(s){console.error("Error fetching menu list:",s),l.error("Error fetching menu list")}finally{B(!1)}})()},[]),d.useEffect(()=>{e&&g.setFieldsValue({title:e.title,altName:e.altName,details:e.details,imgName:e.imgName,pageSlug:e.pageSlug||"",heading:e.heading,subheading:e.subheading,description:e.description,marque:e.marque,image:e.image?[{name:e.imgName,url:`/api/image/download/${e.image}`}]:[]})},[e,g]);const w=i=>{q(!0),g.setFieldsValue({imgName:i.file.name,image:i.fileList})},M=async i=>{var s,m,h,x,j;try{if(!((s=i.title)!=null&&s.trim())){l.error("Title is required");return}if(!((m=i.altName)!=null&&m.trim())){l.error("Alt Name is required");return}if(!i.pageSlug){l.error("Page Slug is required");return}const t=new FormData;c&&((x=(h=i.image)==null?void 0:h[0])!=null&&x.originFileObj)?(t.append("image",i.image[0].originFileObj),t.append("imgName",i.image[0].name)):t.append("imgName",i.imgName||e.imgName),t.append("title",i.title.trim()),t.append("altName",i.altName.trim()),t.append("details",((j=i.details)==null?void 0:j.trim())||""),t.append("pageSlug",i.pageSlug),t.append("heading",i.heading||""),t.append("subheading",i.subheading||""),t.append("description",i.description||""),t.append("marque",i.marque||""),await P({id:p,bannerData:t}),l.success("Banner updated successfully"),S("/banner-table")}catch(t){console.error(t),l.error("Failed to update banner")}};return E?a.jsx("div",{children:"Loading..."}):a.jsxs("div",{children:[a.jsxs(o,{className:"px-4 py-6",children:[a.jsx(o.Item,{children:a.jsxs(f,{to:"/dashboard",children:[a.jsx(U,{})," Dashboard"]})}),a.jsx(o.Item,{children:a.jsx(f,{to:"/banner-table",children:"Banner Management"})}),a.jsx(o.Item,{children:"Edit Banner"})]}),a.jsxs("div",{className:"p-6",children:[a.jsx("h1",{className:"text-2xl font-bold mb-6",children:"Edit Banner"}),a.jsxs(n,{form:g,layout:"vertical",onFinish:M,initialValues:{title:(e==null?void 0:e.title)||"",altName:(e==null?void 0:e.altName)||"",details:(e==null?void 0:e.details)||"",imgName:(e==null?void 0:e.imgName)||"",pageSlug:(e==null?void 0:e.pageSlug)||"",heading:(e==null?void 0:e.heading)||"",subheading:(e==null?void 0:e.subheading)||"",description:(e==null?void 0:e.description)||"",marque:(e==null?void 0:e.marque)||"",image:e!=null&&e.image?[{name:e.imgName,url:`/api/image/download/${e.image}`}]:[]},children:[a.jsx(n.Item,{name:"pageSlug",label:"Page Slug",rules:[{required:!0,message:"Please select a page slug!"}],children:a.jsx(b,{placeholder:"Select a menu item",loading:L,children:F.map(i=>a.jsxs(N.Fragment,{children:[a.jsx(u,{value:i.parent.path,className:"font-bold",children:i.parent.name},`${i._id}-parent`),i.children&&i.children.map(s=>a.jsxs(N.Fragment,{children:[a.jsxs(u,{value:s.path,className:"pl-5",children:[a.jsx("span",{children:" ├── "}),s.name]},s._id),s.subChildren&&s.subChildren.map(m=>a.jsxs(u,{value:m.path,className:"pl-10",children:[a.jsx("span",{children:"├────"})," ",m.name]},m._id))]},s._id))]},i._id))})}),a.jsx(n.Item,{name:"image",label:"Banner Image",valuePropName:"fileList",getValueFromEvent:i=>i&&i.fileList,children:a.jsx($,{maxCount:1,listType:"picture",beforeUpload:()=>!1,onChange:w,defaultFileList:e!=null&&e.image?[{name:e.imgName,url:`/api/image/download/${e.image}`}]:[],children:a.jsx(I,{icon:a.jsx(V,{}),children:c?"Change Image":"Upload New Image"})})}),a.jsx(n.Item,{name:"imgName",label:"Image Name",rules:[{required:!0,message:"Please input image name!"}],children:a.jsx(r,{disabled:c})}),a.jsx(n.Item,{name:"title",label:"Title",rules:[{required:!0,message:"Please input title!"}],children:a.jsx(r,{})}),a.jsx(n.Item,{name:"altName",label:"Alt Name",rules:[{required:!0,message:"Please input alt name!"}],children:a.jsx(r,{})}),a.jsx(n.Item,{name:"heading",label:"Heading",children:a.jsx(r,{})}),a.jsx(n.Item,{name:"subheading",label:"Subheading",children:a.jsx(r,{})}),a.jsx(n.Item,{name:"marque",label:"Marque Text",children:a.jsx(r,{})}),a.jsx(n.Item,{name:"description",label:"Description",children:a.jsx(O,{rows:4})}),a.jsx(n.Item,{name:"details",label:"Details",rules:[{message:"Please input details!"}],children:a.jsx(_,{theme:"snow"})}),a.jsx(n.Item,{children:a.jsx(I,{type:"primary",htmlType:"submit",children:"Update"})})]})]})]})};export{k as default};
