import{bE as e,bF as a,j as s,I as i,B as t}from"./main-BcUd3ASm.js";import{g as r,d as n,r as l,L as o}from"./vendor-router-CaZtIe2_.js";import{R as d}from"./index-BEyUZcsN.js";/* empty css                   */import{a as c}from"./vendor-utils-CfKmydC0.js";import{C as m,b as j,c as h,a as p}from"./card-DKPCnjx_.js";import{F as x,a as g,b as u,c as f,d as N,e as v,f as b}from"./form-ChijvnbD.js";import{S,a as y,b as w,c as E,d as C}from"./select-Dc7LnXRO.js";import{B as V,a as B,b as q,d as D,e as F}from"./breadcrumb-DEvmmGzh.js";import{b as L}from"./index.esm-CJw2PcRb.js";import{B as P}from"./react-toastify.esm-CrOn1nFw.js";import{H as U}from"./house-CNKfAUOI.js";import"./vendor-react-DD_RYU77.js";import"./isEqual-DwlFmuh_.js";import"./index-CMYgmcqM.js";import"./index-BY97PVuz.js";import"./check-CxfHQWmE.js";import"./chevron-up-BAx2OvKy.js";import"./chevron-right-C95tp0e6.js";const k=()=>{const{id:k}=r(),I=n(),[A,M]=l.useState(!1),[T,$]=l.useState(!1),[_,H]=l.useState([]),{data:J,isLoading:K,refetch:Q}=e(k),[R]=a(),Z=L({defaultValues:{title:"",altName:"",details:"",imgName:"",pageSlug:"",image:null,photo:null}});l.useEffect((()=>{(async()=>{try{const e=await c.get("/api/menulist/get-menu");e.data.success&&H(e.data.data)}catch(e){P({variant:"destructive",title:"Error",description:"Failed to fetch menu list"})}})()}),[]),l.useEffect((()=>{J&&Z.reset({title:J.title,altName:J.altName,details:J.details,imgName:J.imgName,pageSlug:J.pageSlug||""})}),[J,Z]);const z=e=>{M(!0);const a=e.target.files[0];a&&(Z.setValue("imgName",a.name),Z.setValue("image",a))},G=e=>{$(!0);const a=e.target.files[0];a&&Z.setValue("photo",a)};return K?s.jsx("div",{className:"flex items-center justify-center h-64",children:s.jsx("div",{className:"text-lg",children:"Loading..."})}):s.jsxs("div",{className:"container mx-auto",children:[s.jsx(V,{className:"py-4",children:s.jsxs(B,{children:[s.jsx(q,{children:s.jsx(D,{asChild:!0,children:s.jsxs(o,{to:"/dashboard",children:[s.jsx(U,{className:"h-4 w-4 mr-2 inline"}),"Dashboard"]})})}),s.jsx(F,{}),s.jsx(q,{children:s.jsx(D,{asChild:!0,children:s.jsx(o,{to:"/banner-table",children:"Banner Management"})})}),s.jsx(F,{}),s.jsx(q,{children:s.jsx(D,{children:"Edit Banner"})})]})}),s.jsxs(m,{className:"mb-8",children:[s.jsx(j,{children:s.jsx(h,{className:"text-2xl",children:"Edit Banner"})}),s.jsx(p,{children:s.jsx(x,{...Z,children:s.jsxs("form",{onSubmit:Z.handleSubmit((async e=>{try{if(!e.title?.trim())return void P({variant:"destructive",title:"Validation Error",description:"Title is required"});if(!e.altName?.trim())return void P({variant:"destructive",title:"Validation Error",description:"Alt Name is required"});if(!e.pageSlug)return void P({variant:"destructive",title:"Validation Error",description:"Page Slug is required"});const a=new FormData;A&&e.image?(a.append("image",e.image),a.append("imgName",e.imgName)):a.append("imgName",e.imgName||J.imgName),T&&e.photo?a.append("photo",e.photo):J.photo&&a.append("photo",J.photo),a.append("title",e.title.trim()),a.append("altName",e.altName.trim()),a.append("details",e.details?.trim()||""),a.append("pageSlug",e.pageSlug),await R({id:k,bannerData:a}),P({title:"Success",description:"Banner updated successfully"}),Q(),I("/banner-table")}catch(a){P({variant:"destructive",title:"Error",description:"Failed to update banner"})}})),className:"space-y-6",children:[s.jsx(g,{control:Z.control,name:"pageSlug",render:({field:e})=>s.jsxs(u,{children:[s.jsx(f,{children:"Page Slug"}),s.jsxs(S,{onValueChange:e.onChange,defaultValue:e.value,children:[s.jsx(N,{children:s.jsx(y,{children:s.jsx(w,{placeholder:"Select Page Slug"})})}),s.jsx(E,{children:_.map((e=>s.jsx(C,{value:e.parent.path,children:e.parent.name},e._id)))})]}),s.jsx(v,{})]})}),s.jsx(g,{control:Z.control,name:"image",render:({field:e})=>s.jsxs(u,{children:[s.jsx(f,{children:"Banner Image"}),s.jsx(N,{children:s.jsxs("div",{className:"space-y-4",children:[J?.image&&!A&&s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("img",{src:`/api/image/download/${J.image}`,alt:J.imgName,className:"h-20 w-auto rounded"}),s.jsx("span",{children:J.imgName})]}),s.jsx(i,{type:"file",accept:"image/*",onChange:z,className:"cursor-pointer"})]})}),s.jsx(b,{children:"Upload a new image or keep the existing one"}),s.jsx(v,{})]})}),s.jsx(g,{control:Z.control,name:"photo",render:({field:e})=>s.jsxs(u,{children:[s.jsx(f,{children:"Photo"}),s.jsx(N,{children:s.jsxs("div",{className:"space-y-4",children:[J?.photo&&!T&&s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("img",{src:`/api/photo/download/${J.photo}`,alt:J.photoName,className:"h-20 w-auto rounded"}),s.jsx("span",{children:J.photoName})]}),s.jsx(i,{type:"file",accept:"image/*",onChange:G,className:"cursor-pointer"})]})}),s.jsx(b,{children:"Upload a new photo or keep the existing one"}),s.jsx(v,{})]})}),s.jsx(g,{control:Z.control,name:"imgName",render:({field:e})=>s.jsxs(u,{children:[s.jsx(f,{children:"Image Name"}),s.jsx(N,{children:s.jsx(i,{...e,disabled:A})}),s.jsx(v,{})]})}),s.jsx(g,{control:Z.control,name:"title",render:({field:e})=>s.jsxs(u,{children:[s.jsx(f,{children:"Title"}),s.jsx(N,{children:s.jsx(i,{...e})}),s.jsx(v,{})]})}),s.jsx(g,{control:Z.control,name:"altName",render:({field:e})=>s.jsxs(u,{children:[s.jsx(f,{children:"Alt Name"}),s.jsx(N,{children:s.jsx(i,{...e})}),s.jsx(v,{})]})}),s.jsx(g,{control:Z.control,name:"details",render:({field:e})=>s.jsxs(u,{children:[s.jsx(f,{children:"Details"}),s.jsx(N,{children:s.jsx(d,{theme:"snow",value:e.value||"",onChange:e.onChange})}),s.jsx(v,{})]})}),s.jsx(t,{type:"submit",className:"mt-6",children:"Update"})]})})})]})]})};export{k as default};
//# sourceMappingURL=EditBannerForm-iMOQrHE6.js.map
