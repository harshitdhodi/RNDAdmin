import{a as T,f as C,dO as n,r as d,d_ as D,d$ as R,j as a,dS as o,L as f,dY as U,bk as S,R as N,dU as _,bd as I,dV as $,dT as l,ar as V,c as O,dn as r}from"./index-s1lMi29O-1770008093946.js";const{Option:u}=S,{TextArea:A}=l,Q=()=>{const{id:p}=T(),b=C(),[g]=n.useForm(),[c,q]=d.useState(!1),[F,y]=d.useState([]),[L,B]=d.useState(!0),{data:e,isLoading:E}=D(p),[w]=R();d.useEffect(()=>{(async()=>{try{const t=await O.get("/api/menulist/get-menu");t.data.success?y(t.data.data):r.error("Failed to load menu list")}catch(t){console.error("Error fetching menu list:",t),r.error("Error fetching menu list")}finally{B(!1)}})()},[]),d.useEffect(()=>{e&&g.setFieldsValue({title:e.title,altName:e.altName,details:e.details,imgName:e.imgName,pageSlug:e.pageSlug||"",heading:e.heading,subheading:e.subheading,description:e.description,marque:e.marque,image:e.image?[{name:e.imgName,url:`/api/image/download/${e.image}`}]:[]})},[e,g]);const P=i=>{q(!0),g.setFieldsValue({imgName:i.file.name,image:i.fileList})},M=async i=>{var t,m,h,x,j;try{if(!((t=i.title)!=null&&t.trim())){r.error("Title is required");return}if(!((m=i.altName)!=null&&m.trim())){r.error("Alt Name is required");return}if(!i.pageSlug){r.error("Page Slug is required");return}const s=new FormData;c&&((x=(h=i.image)==null?void 0:h[0])!=null&&x.originFileObj)?(s.append("image",i.image[0].originFileObj),s.append("imgName",i.image[0].name)):s.append("imgName",i.imgName||e.imgName),s.append("title",i.title.trim()),s.append("altName",i.altName.trim()),s.append("details",((j=i.details)==null?void 0:j.trim())||""),s.append("pageSlug",i.pageSlug),s.append("heading",i.heading||""),s.append("subheading",i.subheading||""),s.append("description",i.description||""),s.append("marque",i.marque||""),await w({id:p,bannerData:s}),r.success("Banner updated successfully"),b("/banner-table")}catch(s){console.error(s),r.error("Failed to update banner")}};return E?a.jsx("div",{children:"Loading..."}):a.jsxs("div",{children:[a.jsxs(o,{className:"px-4 py-6",children:[a.jsx(o.Item,{children:a.jsxs(f,{to:"/dashboard",children:[a.jsx(U,{})," Dashboard"]})}),a.jsx(o.Item,{children:a.jsx(f,{to:"/banner-table",children:"Banner Management"})}),a.jsx(o.Item,{children:"Edit Banner"})]}),a.jsxs("div",{className:"p-6",children:[a.jsx("h1",{className:"text-2xl font-bold mb-6",children:"Edit Banner"}),a.jsxs(n,{form:g,layout:"vertical",onFinish:M,initialValues:{title:(e==null?void 0:e.title)||"",altName:(e==null?void 0:e.altName)||"",details:(e==null?void 0:e.details)||"",imgName:(e==null?void 0:e.imgName)||"",pageSlug:(e==null?void 0:e.pageSlug)||"",heading:(e==null?void 0:e.heading)||"",subheading:(e==null?void 0:e.subheading)||"",description:(e==null?void 0:e.description)||"",marque:(e==null?void 0:e.marque)||"",image:e!=null&&e.image?[{name:e.imgName,url:`/api/image/download/${e.image}`}]:[]},children:[a.jsx(n.Item,{name:"pageSlug",label:"Page Slug",rules:[{required:!0,message:"Please select a page slug!"}],children:a.jsx(S,{placeholder:"Select a menu item",loading:L,children:F.map(i=>a.jsxs(N.Fragment,{children:[a.jsx(u,{value:i.parent.path,className:"font-bold",children:i.parent.name},`${i._id}-parent`),i.children&&i.children.map(t=>a.jsxs(N.Fragment,{children:[a.jsxs(u,{value:t.path,className:"pl-5",children:[a.jsx("span",{children:" ├── "}),t.name]},t._id),t.subChildren&&t.subChildren.map(m=>a.jsxs(u,{value:m.path,className:"pl-10",children:[a.jsx("span",{children:"├────"})," ",m.name]},m._id))]},t._id))]},i._id))})}),a.jsx(n.Item,{name:"image",label:"Banner Image",valuePropName:"fileList",getValueFromEvent:i=>i&&i.fileList,children:a.jsx(_,{maxCount:1,listType:"picture",beforeUpload:()=>!1,onChange:P,defaultFileList:e!=null&&e.image?[{name:e.imgName,url:`/api/image/download/${e.image}`}]:[],children:a.jsx(I,{icon:a.jsx($,{}),children:c?"Change Image":"Upload New Image"})})}),a.jsx(n.Item,{name:"imgName",label:"Image Name",rules:[{required:!0,message:"Please input image name!"}],children:a.jsx(l,{disabled:c})}),a.jsx(n.Item,{name:"title",label:"Title",rules:[{required:!0,message:"Please input title!"}],children:a.jsx(l,{})}),a.jsx(n.Item,{name:"altName",label:"Alt Name",rules:[{required:!0,message:"Please input alt name!"}],children:a.jsx(l,{})}),a.jsx(n.Item,{name:"heading",label:"Heading",children:a.jsx(l,{})}),a.jsx(n.Item,{name:"subheading",label:"Subheading",children:a.jsx(l,{})}),a.jsx(n.Item,{name:"marque",label:"Marque Text",children:a.jsx(l,{})}),a.jsx(n.Item,{name:"description",label:"Description",children:a.jsx(A,{rows:4})}),a.jsx(n.Item,{name:"details",label:"Details",rules:[{message:"Please input details!"}],children:a.jsx(V,{theme:"snow"})}),a.jsx(n.Item,{children:a.jsx(I,{type:"primary",htmlType:"submit",children:"Update"})})]})]})]})};export{Q as default};
