import{a as M,f as C,eu as r,r as n,eH as U,eI as D,j as a,ey as o,L as f,R as N,b4 as I,am as _,c as $,e9 as l}from"./index-2kbH1bBb-1764732385455.js";import{R as T}from"./HomeOutlined-CWvs7fsl-1764732385455.js";import{S}from"./index-BZgmf3ak-1764732385455.js";import{U as V,R as O}from"./index-BNaGp7Vk-1764732385455.js";import{I as c}from"./index-g1DPuVnD-1764732385455.js";import"./TextArea-BKy-nqO8-1764732385455.js";import"./CheckOutlined-6aSt04rk-1764732385455.js";import"./fade-D_zzDYw_-1764732385455.js";import"./useForceUpdate-CWyNYTn2-1764732385455.js";import"./DeleteOutlined-Dbls3UtD-1764732385455.js";import"./DownloadOutlined-BJlITzLl-1764732385455.js";const{Option:u}=S,Y=()=>{const{id:p}=M(),y=C(),[d]=r.useForm(),[g,F]=n.useState(!1),[L,B]=n.useState([]),[b,E]=n.useState(!0),{data:e,isLoading:P}=U(p),[w]=D();n.useEffect(()=>{(async()=>{try{const i=await $.get("/api/menulist/get-menu");i.data.success?B(i.data.data):l.error("Failed to load menu list")}catch(i){console.error("Error fetching menu list:",i),l.error("Error fetching menu list")}finally{E(!1)}})()},[]),n.useEffect(()=>{e&&d.setFieldsValue({title:e.title,altName:e.altName,details:e.details,imgName:e.imgName,pageSlug:e.pageSlug||"",image:e.image?[{name:e.imgName,url:`/api/image/download/${e.image}`}]:[]})},[e,d]);const R=t=>{F(!0),d.setFieldsValue({imgName:t.file.name,image:t.fileList})},q=async t=>{var i,m,h,x,j;try{if(!((i=t.title)!=null&&i.trim())){l.error("Title is required");return}if(!((m=t.altName)!=null&&m.trim())){l.error("Alt Name is required");return}if(!t.pageSlug){l.error("Page Slug is required");return}const s=new FormData;g&&((x=(h=t.image)==null?void 0:h[0])!=null&&x.originFileObj)?(s.append("image",t.image[0].originFileObj),s.append("imgName",t.image[0].name)):s.append("imgName",t.imgName||e.imgName),s.append("title",t.title.trim()),s.append("altName",t.altName.trim()),s.append("details",((j=t.details)==null?void 0:j.trim())||""),s.append("pageSlug",t.pageSlug),await w({id:p,bannerData:s}),l.success("Banner updated successfully"),y("/banner-table")}catch(s){console.error(s),l.error("Failed to update banner")}};return P?a.jsx("div",{children:"Loading..."}):a.jsxs("div",{children:[a.jsxs(o,{className:"px-4 py-6",children:[a.jsx(o.Item,{children:a.jsxs(f,{to:"/dashboard",children:[a.jsx(T,{})," Dashboard"]})}),a.jsx(o.Item,{children:a.jsx(f,{to:"/banner-table",children:"Banner Management"})}),a.jsx(o.Item,{children:"Edit Banner"})]}),a.jsxs("div",{className:"p-6",children:[a.jsx("h1",{className:"text-2xl font-bold mb-6",children:"Edit Banner"}),a.jsxs(r,{form:d,layout:"vertical",onFinish:q,initialValues:{title:(e==null?void 0:e.title)||"",altName:(e==null?void 0:e.altName)||"",details:(e==null?void 0:e.details)||"",imgName:(e==null?void 0:e.imgName)||"",pageSlug:(e==null?void 0:e.pageSlug)||"",image:e!=null&&e.image?[{name:e.imgName,url:`/api/image/download/${e.image}`}]:[]},children:[a.jsx(r.Item,{name:"pageSlug",label:"Page Slug",rules:[{required:!0,message:"Please select a page slug!"}],children:a.jsx(S,{placeholder:"Select a menu item",loading:b,children:L.map(t=>a.jsxs(N.Fragment,{children:[a.jsx(u,{value:t.parent.path,className:"font-bold",children:t.parent.name},`${t._id}-parent`),t.children&&t.children.map(i=>a.jsxs(N.Fragment,{children:[a.jsxs(u,{value:i.path,className:"pl-5",children:[a.jsx("span",{children:" ├── "}),i.name]},i._id),i.subChildren&&i.subChildren.map(m=>a.jsxs(u,{value:m.path,className:"pl-10",children:[a.jsx("span",{children:"├────"})," ",m.name]},m._id))]},i._id))]},t._id))})}),a.jsx(r.Item,{name:"image",label:"Banner Image",valuePropName:"fileList",getValueFromEvent:t=>t&&t.fileList,children:a.jsx(V,{maxCount:1,listType:"picture",beforeUpload:()=>!1,onChange:R,defaultFileList:e!=null&&e.image?[{name:e.imgName,url:`/api/image/download/${e.image}`}]:[],children:a.jsx(I,{icon:a.jsx(O,{}),children:g?"Change Image":"Upload New Image"})})}),a.jsx(r.Item,{name:"imgName",label:"Image Name",rules:[{required:!0,message:"Please input image name!"}],children:a.jsx(c,{disabled:g})}),a.jsx(r.Item,{name:"title",label:"Title",rules:[{required:!0,message:"Please input title!"}],children:a.jsx(c,{})}),a.jsx(r.Item,{name:"altName",label:"Alt Name",rules:[{required:!0,message:"Please input alt name!"}],children:a.jsx(c,{})}),a.jsx(r.Item,{name:"details",label:"Details",rules:[{message:"Please input details!"}],children:a.jsx(_,{theme:"snow"})}),a.jsx(r.Item,{children:a.jsx(I,{type:"primary",htmlType:"submit",children:"Update"})})]})]})]})};export{Y as default};
