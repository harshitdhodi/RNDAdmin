import{V as e,bt as s,j as a,L as i,I as r,B as t}from"./main-BQqr2_19.js";import{g as l,d,r as n}from"./vendor-router-DoRotgOs.js";import{b as m}from"./index.esm-CSDyVtrl.js";import{C as c,b as o,c as h,a as x}from"./card-CPQ_AIkA.js";import{T as j}from"./textarea-tez6YR4q.js";import{S as p,a as u,b,c as g,d as N}from"./select-DFtFguEc.js";import{B as f}from"./BreadCrumb-D7K0Zw6I.js";import{B as v}from"./react-toastify.esm-BNXCN5Br.js";import"./vendor-react-DD_RYU77.js";import"./vendor-utils-CfKmydC0.js";import"./index-BYajCL7Y.js";import"./index-LwoRh43N.js";import"./check-C21vIO_I.js";import"./chevron-up-CiFYhtWl.js";import"./breadcrumb-BHS-7goF.js";import"./chevron-right-DHWU52ll.js";const y=[{label:"Dashboard",href:"/dashboard"},{label:"Customer Table",href:"/customer-table"},{label:"Edit Customer",href:null}];function C(){const{id:C}=l(),{data:w,isLoading:S}=e(C),[F,{isLoading:E}]=s(),U=d(),[L]=n.useState([{isoCode:"US",name:"United States"},{isoCode:"CA",name:"Canada"},{isoCode:"UK",name:"United Kingdom"},{isoCode:"IN",name:"India"},{isoCode:"AU",name:"Australia"}]),P={US:[{isoCode:"NY",name:"New York"},{isoCode:"CA",name:"California"},{isoCode:"TX",name:"Texas"}],IN:[{isoCode:"MH",name:"Maharashtra"},{isoCode:"DL",name:"Delhi"},{isoCode:"KA",name:"Karnataka"}]},A={NY:[{name:"New York City"},{name:"Buffalo"}],CA:[{name:"Los Angeles"},{name:"San Francisco"}],MH:[{name:"Mumbai"},{name:"Pune"}]},[k,I]=n.useState([]),[M,B]=n.useState([]),{register:D,handleSubmit:V,watch:K,setValue:T,reset:Y,formState:{errors:q},setError:R,clearErrors:$}=m({defaultValues:{name:"",contactPerson:"",email:"",mobile:"",website:"",address:"",country:"",state:"",city:"",description:"",image:null}}),z=K("country"),H=K("state"),O=K("image");n.useEffect((()=>{if(z){I(P[z]||[]),w||(T("state",""),T("city",""))}else I([]),B([])}),[z,T,w]),n.useEffect((()=>{if(H){B(A[H]||[]),w||T("city","")}else B([])}),[H,T,w]),n.useEffect((()=>{if(w?.data){["name","contactPerson","email","mobile","website","address","country","state","city","description","image"].forEach((e=>{void 0!==w.data[e]&&T(e,w.data[e]||"")}))}}),[w,T]);return S?a.jsx("div",{children:"Loading..."}):a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"ml-1",children:a.jsx(f,{items:y})}),a.jsxs(c,{className:"w-full mt-4 mx-auto",children:[a.jsx(o,{children:a.jsx(h,{className:"text-xl text-purple-700",children:"Edit Customer"})}),a.jsx(x,{children:a.jsxs("form",{onSubmit:V((async e=>{if((e=>{let s=!0;$(),e.name.trim()||(R("name",{message:"Customer name is required"}),s=!1),e.email?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e.email)||(R("email",{message:"Invalid email address"}),s=!1):(R("email",{message:"Email is required"}),s=!1),e.mobile.trim()||(R("mobile",{message:"Mobile number is required"}),s=!1),e.website&&(/^(https?:\/\/)?([\w-]+(\.[\w-]+)+)(\/[\w-]*)*\/?$/.test(e.website)||(R("website",{message:"Invalid URL"}),s=!1));return s})(e))try{const s=new FormData;Object.keys(e).forEach((a=>{"image"!==a&&s.append(a,e[a]||"")})),e.image instanceof File&&s.append("image",e.image),s.append("id",C);await F({id:C,data:s}).unwrap();v.success("Customer updated successfully"),U("/customer-table")}catch(s){v.error(s.message||"Failed to update customer")}})),className:"space-y-6",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsxs(i,{htmlFor:"name",children:["Customer Name ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx(r,{id:"name",...D("name"),className:q.name?"border-red-500":""}),q.name&&a.jsx("p",{className:"text-red-500 text-sm",children:q.name.message})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(i,{htmlFor:"contactPerson",children:"Contact Person"}),a.jsx(r,{id:"contactPerson",...D("contactPerson")})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs(i,{htmlFor:"email",children:["Email ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx(r,{id:"email",type:"email",...D("email"),className:q.email?"border-red-500":""}),q.email&&a.jsx("p",{className:"text-red-500 text-sm",children:q.email.message})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs(i,{htmlFor:"mobile",children:["Mobile Number ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx(r,{id:"mobile",...D("mobile"),className:q.mobile?"border-red-500":""}),q.mobile&&a.jsx("p",{className:"text-red-500 text-sm",children:q.mobile.message})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(i,{htmlFor:"website",children:"Website"}),a.jsx(r,{id:"website",type:"url",...D("website"),className:q.website?"border-red-500":""}),q.website&&a.jsx("p",{className:"text-red-500 text-sm",children:q.website.message})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx(i,{htmlFor:"country",children:"Country"}),a.jsxs(p,{value:z,onValueChange:e=>T("country",e),children:[a.jsx(u,{children:a.jsx(b,{placeholder:"Select Country"})}),a.jsx(g,{children:L.map((e=>a.jsx(N,{value:e.isoCode,children:e.name},e.isoCode)))})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(i,{htmlFor:"state",children:"State/Province"}),a.jsxs(p,{value:H,onValueChange:e=>T("state",e),disabled:!z||0===k.length,children:[a.jsx(u,{children:a.jsx(b,{placeholder:"Select State"})}),a.jsx(g,{children:k.map((e=>a.jsx(N,{value:e.isoCode,children:e.name},e.isoCode)))})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(i,{htmlFor:"city",children:"City"}),a.jsxs(p,{value:K("city"),onValueChange:e=>T("city",e),disabled:!H||0===M.length,children:[a.jsx(u,{children:a.jsx(b,{placeholder:"Select City"})}),a.jsx(g,{children:M.map((e=>a.jsx(N,{value:e.name,children:e.name},e.name)))})]})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(i,{htmlFor:"address",children:"Address"}),a.jsx(j,{id:"address",className:"min-h-[100px]",...D("address")})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(i,{children:"Upload image"}),a.jsxs("div",{className:"border-2 border-dashed border-gray-200 rounded-lg p-4 text-center",children:[a.jsx("div",{className:"w-32 h-32 mx-auto mb-4",children:a.jsx("img",{src:O instanceof File?URL.createObjectURL(O):O?`/api/logo/download/${O}`:"/placeholder.svg",alt:"image preview",className:"w-full h-full object-contain"})}),a.jsx(t,{type:"button",variant:"outline",className:"bg-green-500 text-white hover:bg-green-600",onClick:()=>document.getElementById("imageUpload").click(),children:"Add image"}),a.jsx("input",{type:"file",id:"imageUpload",accept:"image/*",onChange:e=>{const s=e.target.files[0];if(s){if(!s.type.startsWith("image/"))return void v.error("Please upload an image file");if(s.size>5242880)return void v.error("Image size should be less than 5MB");T("image",s)}},className:"hidden"})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(i,{htmlFor:"description",children:"Description"}),a.jsx(j,{id:"description",...D("description"),className:"min-h-[200px]",placeholder:"Enter customer description"})]}),a.jsxs("div",{className:"flex gap-4",children:[a.jsx(t,{type:"submit",disabled:E,className:"bg-green-500 text-white hover:bg-green-600",children:E?"Saving...":"Save"}),a.jsx(t,{type:"button",variant:"destructive",onClick:()=>U("/customer-table"),children:"Cancel"})]})]})})]})]})}export{C as default};
//# sourceMappingURL=EditCustomerForm-3C59fAVb.js.map
