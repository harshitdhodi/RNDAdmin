import{a8 as K,by as R,j as e,L as r,I as h,B as C}from"./main-4qLjs9DC-1744362991634.js";import{i as Y,f as H,c}from"./vendor-C9iLKeEQ-1744362991634.js";import{b as W}from"./index.esm-Db4pfNYm-1744362991634.js";import{t as q,o as z,a as O,s as o,l as G}from"./index-DHL3J_e3-1744362991634.js";import{C as Q,b as X,c as $,a as J}from"./card-Bp2eKvkO-1744362991634.js";import{T as L}from"./textarea-BiFAjT2e-1744362991634.js";import{S as f,a as y,b as N,c as v,d as S}from"./select-CTw8zaMn-1744362991634.js";import{B as Z}from"./BreadCrumb-DOoKuDJk-1744362991634.js";import{B as x}from"./react-toastify.esm-Bl8YeLep-1744362991634.js";import"./Combination-iUngDOiP-1744362991634.js";import"./index-D9J54qNB-1744362991634.js";import"./check-CSXQyrPL-1744362991634.js";import"./chevron-up-DbBGlp_p-1744362991634.js";import"./chevron-right-D59bkzT9-1744362991634.js";const _=z({name:o().min(1,"Customer name is required"),contactPerson:o().optional(),email:o().email("Invalid email address"),mobile:o().min(1,"Mobile number is required"),website:o().url("Invalid URL").optional().or(G("")),address:o().optional(),country:o().optional(),state:o().optional(),city:o().optional(),description:o().optional(),image:O().optional()}),ee=[{label:"Dashboard",href:"/dashboard"},{label:"Customer Table",href:"/customer-table"},{label:"Edit Customer",href:null}];function ge(){const{id:j}=Y(),{data:l,isLoading:P}=K(j),[T,{isLoading:w}]=R(),F=H(),[A]=c.useState([{isoCode:"US",name:"United States"},{isoCode:"CA",name:"Canada"},{isoCode:"UK",name:"United Kingdom"},{isoCode:"IN",name:"India"},{isoCode:"AU",name:"Australia"}]),B={US:[{isoCode:"NY",name:"New York"},{isoCode:"CA",name:"California"},{isoCode:"TX",name:"Texas"}],IN:[{isoCode:"MH",name:"Maharashtra"},{isoCode:"DL",name:"Delhi"},{isoCode:"KA",name:"Karnataka"}]},M={NY:[{name:"New York City"},{name:"Buffalo"}],CA:[{name:"Los Angeles"},{name:"San Francisco"}],MH:[{name:"Mumbai"},{name:"Pune"}]},[E,I]=c.useState([]),[U,g]=c.useState([]),{register:n,handleSubmit:D,watch:u,setValue:i,reset:se,formState:{errors:t}}=W({resolver:q(_),defaultValues:{name:"",contactPerson:"",email:"",mobile:"",website:"",address:"",country:"",state:"",city:"",description:"",image:null}}),d=u("country"),m=u("state"),p=u("image");c.useEffect(()=>{if(d){const s=B[d]||[];I(s),l||(i("state",""),i("city",""))}else I([]),g([])},[d,i,l]),c.useEffect(()=>{if(m){const s=M[m]||[];g(s),l||i("city","")}else g([])},[m,i,l]),c.useEffect(()=>{l?.data&&["name","contactPerson","email","mobile","website","address","country","state","city","description","image"].forEach(a=>{l.data[a]!==void 0&&i(a,l.data[a]||"")})},[l,i]);const V=s=>{const a=s.target.files[0];if(a){if(!a.type.startsWith("image/")){x.error("Please upload an image file");return}if(a.size>5*1024*1024){x.error("Image size should be less than 5MB");return}i("image",a)}},k=async s=>{try{const a=new FormData;Object.keys(s).forEach(b=>{b!=="image"&&a.append(b,s[b]||"")}),s.image instanceof File&&a.append("image",s.image),a.append("id",j);const ae=await T({id:j,data:a}).unwrap();x.success("Customer updated successfully"),F("/customer-table")}catch(a){console.error("Error structure:",a),x.error(a.message||"Failed to update customer")}};return P?e.jsx("div",{children:"Loading..."}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"ml-1",children:e.jsx(Z,{items:ee})}),e.jsxs(Q,{className:"w-full mt-4 mx-auto",children:[e.jsx(X,{children:e.jsx($,{className:"text-xl text-purple-700",children:"Edit Customer"})}),e.jsx(J,{children:e.jsxs("form",{onSubmit:D(k),className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(r,{htmlFor:"name",children:["Customer Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(h,{id:"name",...n("name"),className:t.name?"border-red-500":""}),t.name&&e.jsx("p",{className:"text-red-500 text-sm",children:t.name.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"contactPerson",children:"Contact Person"}),e.jsx(h,{id:"contactPerson",...n("contactPerson")})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(r,{htmlFor:"email",children:["Email ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(h,{id:"email",type:"email",...n("email"),className:t.email?"border-red-500":""}),t.email&&e.jsx("p",{className:"text-red-500 text-sm",children:t.email.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(r,{htmlFor:"mobile",children:["Mobile Number ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(h,{id:"mobile",...n("mobile"),className:t.mobile?"border-red-500":""}),t.mobile&&e.jsx("p",{className:"text-red-500 text-sm",children:t.mobile.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"website",children:"Website"}),e.jsx(h,{id:"website",type:"url",...n("website"),className:t.website?"border-red-500":""}),t.website&&e.jsx("p",{className:"text-red-500 text-sm",children:t.website.message})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"country",children:"Country"}),e.jsxs(f,{value:d,onValueChange:s=>i("country",s),children:[e.jsx(y,{children:e.jsx(N,{placeholder:"Select Country"})}),e.jsx(v,{children:A.map(s=>e.jsx(S,{value:s.isoCode,children:s.name},s.isoCode))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"state",children:"State/Province"}),e.jsxs(f,{value:m,onValueChange:s=>i("state",s),disabled:!d||E.length===0,children:[e.jsx(y,{children:e.jsx(N,{placeholder:"Select State"})}),e.jsx(v,{children:E.map(s=>e.jsx(S,{value:s.isoCode,children:s.name},s.isoCode))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"city",children:"City"}),e.jsxs(f,{value:u("city"),onValueChange:s=>i("city",s),disabled:!m||U.length===0,children:[e.jsx(y,{children:e.jsx(N,{placeholder:"Select City"})}),e.jsx(v,{children:U.map(s=>e.jsx(S,{value:s.name,children:s.name},s.name))})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"address",children:"Address"}),e.jsx(L,{id:"address",className:"min-h-[100px]",...n("address")})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{children:"Upload image"}),e.jsxs("div",{className:"border-2 border-dashed border-gray-200 rounded-lg p-4 text-center",children:[e.jsx("div",{className:"w-32 h-32 mx-auto mb-4",children:e.jsx("img",{src:p instanceof File?URL.createObjectURL(p):p?`/api/logo/download/${p}`:"/placeholder.svg",alt:"image preview",className:"w-full h-full object-contain"})}),e.jsx(C,{type:"button",variant:"outline",className:"bg-green-500 text-white hover:bg-green-600",onClick:()=>document.getElementById("imageUpload").click(),children:"Add image"}),e.jsx("input",{type:"file",id:"imageUpload",accept:"image/*",onChange:V,className:"hidden"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"description",children:"Description"}),e.jsx(L,{id:"description",...n("description"),className:"min-h-[200px]",placeholder:"Enter customer description"})]}),e.jsxs("div",{className:"flex gap-4",children:[e.jsx(C,{type:"submit",disabled:w,className:"bg-green-500 text-white hover:bg-green-600",children:w?"Saving...":"Save"}),e.jsx(C,{type:"button",variant:"destructive",onClick:()=>F("/customer-table"),children:"Cancel"})]})]})})]})]})}export{ge as default};
