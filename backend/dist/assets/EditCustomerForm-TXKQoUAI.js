import{r as e,j as s}from"./react-BfBsRgn0.js";import{c as a}from"./react-hook-form-Dn0Bw783.js";import{t as i}from"./@hookform-DBV5tMOk.js";import{o as t,s as r,l,b as o}from"./zod-CO6CETVj.js";import{R as c,aK as d,L as m,I as n,T as j,B as p}from"./index-mCSb4W1J.js";import{C as h,b as x,c as u,a as g}from"./card--g8pM1Dm.js";import{S as b,a as f,b as y,c as v,d as N}from"./select-BjvvJv_x.js";import{B as C}from"./BreadCrumb-DisBzgy2.js";import{S as w,C as S,a as F}from"./country-state-city-BE-JKyhi.js";import{B as E}from"./react-toastify-DG2TuaTj.js";import{b as k,a as P}from"./react-router-DUJjWq5j.js";import"./classnames-C3ovBj6j.js";import"./react-dom-DwrudmHt.js";import"./scheduler-BFk34ZWe.js";import"./react-redux-DbBiFgqA.js";import"./use-sync-external-store-DdeJV4gQ.js";import"./@reduxjs-UCSEaN3g.js";import"./redux-C5Huw2aR.js";import"./immer-DgfQkf_7.js";import"./redux-thunk-B3S1iNVp.js";import"./reselect-BSOs5pU1.js";import"./js-cookie-BXEMiIsG.js";import"./@radix-ui-BWjeGzol.js";import"./aria-hidden-BHUiN-rI.js";import"./react-remove-scroll-yauc81_r.js";import"./tslib-Bc9CN1Ef.js";import"./react-remove-scroll-bar-BcxDecei.js";import"./react-style-singleton-C1QVuB2c.js";import"./get-nonce-BYiZHLe3.js";import"./use-sidecar-BA4C4RS7.js";import"./use-callback-ref-Cvx1xcTX.js";import"./@floating-ui-BSChQBl3.js";import"./class-variance-authority-DeOWI0hf.js";import"./clsx-BeLtu-UY.js";import"./tailwind-merge-D2VJQb_v.js";import"./lucide-D6BDVLHE.js";import"./axios-BoylL8Pu.js";import"./cookie-BUTH-fPQ.js";const L=t({name:r().min(1,"Customer name is required"),contactPerson:r().optional(),email:r().email("Invalid email address"),mobile:r().min(1,"Mobile number is required"),website:r().url("Invalid URL").optional().or(l("")),address:r().optional(),country:r().optional(),state:r().optional(),city:r().optional(),description:r().optional(),image:o().optional()}),B=[{label:"Dashboard",href:"/dashboard"},{label:"Customer Table",href:"/customer-table"},{label:"Edit Customer",href:null}];function I(){const{id:t}=k(),{data:r,isLoading:l}=c(t),[o,{isLoading:I}]=d(),U=P(),[V,z]=e.useState([]),[O,R]=e.useState([]),[A,D]=e.useState([]),{register:M,handleSubmit:W,watch:q,setValue:T,reset:$,formState:{errors:K}}=a({resolver:i(L),defaultValues:{name:"",contactPerson:"",email:"",mobile:"",website:"",address:"",country:"",state:"",city:"",description:"",image:null}}),Y=q("country"),Z=q("state"),G=q("image");e.useEffect((()=>{const e=F.getAllCountries();z(e)}),[]),e.useEffect((()=>{if(Y){const e=w.getStatesOfCountry(Y);R(e),r||(T("state",""),T("city",""))}else R([]),D([])}),[Y,T,r]),e.useEffect((()=>{if(Y&&Z){const e=S.getCitiesOfState(Y,Z);D(e),r||T("city","")}else D([])}),[Y,Z,T,r]),e.useEffect((()=>{if(null==r?void 0:r.data){["name","contactPerson","email","mobile","website","address","country","state","city","description","image"].forEach((e=>{void 0!==r.data[e]&&T(e,r.data[e]||"")}))}}),[r,T]);return l?s.jsx("div",{children:"Loading..."}):s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"ml-1",children:s.jsx(C,{items:B})}),s.jsxs(h,{className:"w-full mt-4 mx-auto",children:[s.jsx(x,{children:s.jsx(u,{className:"text-xl text-purple-700",children:"Edit Customer"})}),s.jsx(g,{children:s.jsxs("form",{onSubmit:W((async e=>{try{const s=new FormData;Object.keys(e).forEach((a=>{"image"!==a&&s.append(a,e[a]||"")})),e.image instanceof File&&s.append("image",e.image),s.append("id",t);await o({id:t,data:s}).unwrap();E({title:"Success",description:"Customer updated successfully"}),U("/customer-table")}catch(s){E({title:"Error",description:s.message||"Failed to update customer",variant:"destructive"})}})),className:"space-y-6",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsxs(m,{htmlFor:"name",children:["Customer Name ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx(n,{id:"name",...M("name"),className:K.name?"border-red-500":""}),K.name&&s.jsx("p",{className:"text-red-500 text-sm",children:K.name.message})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(m,{htmlFor:"contactPerson",children:"Contact Person"}),s.jsx(n,{id:"contactPerson",...M("contactPerson")})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs(m,{htmlFor:"email",children:["Email ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx(n,{id:"email",type:"email",...M("email"),className:K.email?"border-red-500":""}),K.email&&s.jsx("p",{className:"text-red-500 text-sm",children:K.email.message})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs(m,{htmlFor:"mobile",children:["Mobile Number ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx(n,{id:"mobile",...M("mobile"),className:K.mobile?"border-red-500":""}),K.mobile&&s.jsx("p",{className:"text-red-500 text-sm",children:K.mobile.message})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(m,{htmlFor:"website",children:"Website"}),s.jsx(n,{id:"website",type:"url",...M("website"),className:K.website?"border-red-500":""}),K.website&&s.jsx("p",{className:"text-red-500 text-sm",children:K.website.message})]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(m,{htmlFor:"country",children:"Country"}),s.jsxs(b,{value:Y,onValueChange:e=>T("country",e),children:[s.jsx(f,{children:s.jsx(y,{placeholder:"Select Country"})}),s.jsx(v,{children:V.map((e=>s.jsx(N,{value:e.isoCode,children:e.name},e.isoCode)))})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(m,{htmlFor:"state",children:"State/Province"}),s.jsxs(b,{value:Z,onValueChange:e=>T("state",e),disabled:!Y,children:[s.jsx(f,{children:s.jsx(y,{placeholder:"Select State"})}),s.jsx(v,{children:O.map((e=>s.jsx(N,{value:e.isoCode,children:e.name},e.isoCode)))})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(m,{htmlFor:"city",children:"City"}),s.jsxs(b,{value:q("city"),onValueChange:e=>T("city",e),disabled:!Z,children:[s.jsx(f,{children:s.jsx(y,{placeholder:"Select City"})}),s.jsx(v,{children:A.map((e=>s.jsx(N,{value:e.name,children:e.name},e.name)))})]})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(m,{htmlFor:"address",children:"Address"}),s.jsx(j,{id:"address",className:"min-h-[100px]",...M("address")})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(m,{children:"Upload image"}),s.jsxs("div",{className:"border-2 border-dashed border-gray-200 rounded-lg p-4 text-center",children:[s.jsx("div",{className:"w-32 h-32 mx-auto mb-4",children:s.jsx("img",{src:G instanceof File?URL.createObjectURL(G):G?`/api/logo/download/${G}`:"/placeholder.svg",alt:"image preview",className:"w-full h-full object-contain"})}),s.jsx(p,{type:"button",variant:"outline",className:"bg-green-500 text-white hover:bg-green-600",onClick:()=>document.getElementById("imageUpload").click(),children:"Add image"}),s.jsx("input",{type:"file",id:"imageUpload",accept:"image/*",onChange:e=>{const s=e.target.files[0];if(s){if(!s.type.startsWith("image/"))return void E.error("Please upload an image file");if(s.size>5242880)return void E.error("Image size should be less than 5MB");T("image",s)}},className:"hidden"})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(m,{htmlFor:"description",children:"Description"}),s.jsx(j,{id:"description",...M("description"),className:"min-h-[200px]",placeholder:"Enter customer description"})]}),s.jsxs("div",{className:"flex gap-4",children:[s.jsx(p,{type:"submit",disabled:I,className:"bg-green-500 text-white hover:bg-green-600",children:I?"Saving...":"Save"}),s.jsx(p,{type:"button",variant:"destructive",onClick:()=>$(),children:"Cancel"})]})]})})]})]})}export{I as default};
