import{r as m,j as e}from"./react-DKICu8bO.js";import{c as D}from"./react-hook-form-BpvdonxZ.js";import{t as W}from"./@hookform-DUkwi3xb.js";import{o as k,s as l,l as q,b as z}from"./zod-B_haSLVu.js";import{R as G,aK as H,L as r,I as p,T as E,B as f}from"./index-CDFtkn6X.js";import{C as K,b as Q,c as $,a as J}from"./card-CY6sXsn1.js";import{S as y,a as C,b as v,c as N,d as S}from"./select-CdiUu-U-.js";import{B as X}from"./BreadCrumb-C1ZZs22B.js";import{S as Y,C as Z,a as _}from"./country-state-city-BYZIyAdR.js";import{B as x}from"./react-toastify-CMp5zawu.js";import{b as ee,a as se}from"./react-router-B9QVkYva.js";import"./classnames-Bv6oJzD9.js";import"./react-dom-BBS6HuAW.js";import"./scheduler-CKyTKYc2.js";import"./react-redux-BrRfTdeB.js";import"./use-sync-external-store-D0ivhzzy.js";import"./@reduxjs-B5J9SSA5.js";import"./redux-DITMfSWq.js";import"./immer-fBqQtvEc.js";import"./redux-thunk-ClJT1hhx.js";import"./reselect-C27TLnWV.js";import"./js-cookie-Cz0CWeBA.js";import"./@radix-ui-BlrBCj0C.js";import"./aria-hidden-DQ5UC2Eg.js";import"./react-remove-scroll-fXbmorz6.js";import"./tslib-CDuPK5Eb.js";import"./react-remove-scroll-bar-C9fmXXva.js";import"./react-style-singleton-DKBZmuKg.js";import"./get-nonce-C-Z93AgS.js";import"./use-sidecar-C10EJNOT.js";import"./use-callback-ref-BoKxM4XI.js";import"./@floating-ui-8J-daYO3.js";import"./class-variance-authority-Dp3B9jqt.js";import"./clsx-B-dksMZM.js";import"./tailwind-merge-D696Ktp4.js";import"./lucide-D7hRWJEP.js";import"./axios-DXsv3KKR.js";import"./@syncfusion-BIAkhmGL.js";import"./cookie--_YQFYBD.js";const te=k({name:l().min(1,"Customer name is required"),contactPerson:l().optional(),email:l().email("Invalid email address"),mobile:l().min(1,"Mobile number is required"),website:l().url("Invalid URL").optional().or(q("")),address:l().optional(),country:l().optional(),state:l().optional(),city:l().optional(),description:l().optional(),image:z().optional()}),ae=[{label:"Dashboard",href:"/dashboard"},{label:"Customer Table",href:"/customer-table"},{label:"Edit Customer",href:null}];function Ge(){const{id:j}=ee(),{data:o,isLoading:I}=G(j),[L,{isLoading:w}]=H(),P=se(),[T,B]=m.useState([]),[U,F]=m.useState([]),[V,g]=m.useState([]),{register:n,handleSubmit:R,watch:h,setValue:i,reset:M,formState:{errors:a}}=D({resolver:W(te),defaultValues:{name:"",contactPerson:"",email:"",mobile:"",website:"",address:"",country:"",state:"",city:"",description:"",image:null}}),c=h("country"),d=h("state"),u=h("image");m.useEffect(()=>{const s=_.getAllCountries();B(s)},[]),m.useEffect(()=>{if(c){const s=Y.getStatesOfCountry(c);F(s),o||(i("state",""),i("city",""))}else F([]),g([])},[c,i,o]),m.useEffect(()=>{if(c&&d){const s=Z.getCitiesOfState(c,d);g(s),o||i("city","")}else g([])},[c,d,i,o]),m.useEffect(()=>{o!=null&&o.data&&["name","contactPerson","email","mobile","website","address","country","state","city","description","image"].forEach(t=>{o.data[t]!==void 0&&i(t,o.data[t]||"")})},[o,i]);const O=s=>{const t=s.target.files[0];if(t){if(!t.type.startsWith("image/")){x.error("Please upload an image file");return}if(t.size>5*1024*1024){x.error("Image size should be less than 5MB");return}i("image",t)}},A=async s=>{try{const t=new FormData;Object.keys(s).forEach(b=>{b!=="image"&&t.append(b,s[b]||"")}),s.image instanceof File&&t.append("image",s.image),t.append("id",j);const ie=await L({id:j,data:t}).unwrap();x({title:"Success",description:"Customer updated successfully"}),P("/customer-table")}catch(t){console.error("Error structure:",t),x({title:"Error",description:t.message||"Failed to update customer",variant:"destructive"})}};return I?e.jsx("div",{children:"Loading..."}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"ml-1",children:e.jsx(X,{items:ae})}),e.jsxs(K,{className:"w-full mt-4 mx-auto",children:[e.jsx(Q,{children:e.jsx($,{className:"text-xl text-purple-700",children:"Edit Customer"})}),e.jsx(J,{children:e.jsxs("form",{onSubmit:R(A),className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(r,{htmlFor:"name",children:["Customer Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(p,{id:"name",...n("name"),className:a.name?"border-red-500":""}),a.name&&e.jsx("p",{className:"text-red-500 text-sm",children:a.name.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"contactPerson",children:"Contact Person"}),e.jsx(p,{id:"contactPerson",...n("contactPerson")})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(r,{htmlFor:"email",children:["Email ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(p,{id:"email",type:"email",...n("email"),className:a.email?"border-red-500":""}),a.email&&e.jsx("p",{className:"text-red-500 text-sm",children:a.email.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(r,{htmlFor:"mobile",children:["Mobile Number ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(p,{id:"mobile",...n("mobile"),className:a.mobile?"border-red-500":""}),a.mobile&&e.jsx("p",{className:"text-red-500 text-sm",children:a.mobile.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"website",children:"Website"}),e.jsx(p,{id:"website",type:"url",...n("website"),className:a.website?"border-red-500":""}),a.website&&e.jsx("p",{className:"text-red-500 text-sm",children:a.website.message})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"country",children:"Country"}),e.jsxs(y,{value:c,onValueChange:s=>i("country",s),children:[e.jsx(C,{children:e.jsx(v,{placeholder:"Select Country"})}),e.jsx(N,{children:T.map(s=>e.jsx(S,{value:s.isoCode,children:s.name},s.isoCode))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"state",children:"State/Province"}),e.jsxs(y,{value:d,onValueChange:s=>i("state",s),disabled:!c,children:[e.jsx(C,{children:e.jsx(v,{placeholder:"Select State"})}),e.jsx(N,{children:U.map(s=>e.jsx(S,{value:s.isoCode,children:s.name},s.isoCode))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"city",children:"City"}),e.jsxs(y,{value:h("city"),onValueChange:s=>i("city",s),disabled:!d,children:[e.jsx(C,{children:e.jsx(v,{placeholder:"Select City"})}),e.jsx(N,{children:V.map(s=>e.jsx(S,{value:s.name,children:s.name},s.name))})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"address",children:"Address"}),e.jsx(E,{id:"address",className:"min-h-[100px]",...n("address")})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{children:"Upload image"}),e.jsxs("div",{className:"border-2 border-dashed border-gray-200 rounded-lg p-4 text-center",children:[e.jsx("div",{className:"w-32 h-32 mx-auto mb-4",children:e.jsx("img",{src:u instanceof File?URL.createObjectURL(u):u?`/api/logo/download/${u}`:"/placeholder.svg",alt:"image preview",className:"w-full h-full object-contain"})}),e.jsx(f,{type:"button",variant:"outline",className:"bg-green-500 text-white hover:bg-green-600",onClick:()=>document.getElementById("imageUpload").click(),children:"Add image"}),e.jsx("input",{type:"file",id:"imageUpload",accept:"image/*",onChange:O,className:"hidden"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"description",children:"Description"}),e.jsx(E,{id:"description",...n("description"),className:"min-h-[200px]",placeholder:"Enter customer description"})]}),e.jsxs("div",{className:"flex gap-4",children:[e.jsx(f,{type:"submit",disabled:w,className:"bg-green-500 text-white hover:bg-green-600",children:w?"Saving...":"Save"}),e.jsx(f,{type:"button",variant:"destructive",onClick:()=>M(),children:"Cancel"})]})]})})]})]})}export{Ge as default};
