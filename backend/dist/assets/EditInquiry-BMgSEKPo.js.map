{"version":3,"file":"EditInquiry-BMgSEKPo.js","sources":["../../src/inquiry/EditInquiry.jsx"],"sourcesContent":["import React, { useEffect } from 'react';\r\nimport { useForm, Controller } from 'react-hook-form';\r\nimport { Input } from \"@/components/ui/input\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { \r\n    Select, \r\n    SelectContent, \r\n    SelectItem, \r\n    SelectTrigger, \r\n    SelectValue \r\n} from \"@/components/ui/select\";\r\nimport { \r\n    Form, \r\n    FormControl, \r\n    FormField, \r\n    FormItem, \r\n    FormLabel, \r\n    FormMessage \r\n} from \"@/components/ui/form\";\r\nimport { useAddInquiryMutation, useGetInquiryByIdQuery, useUpdateInquiryMutation } from \"@/slice/inquiry/inquiry\";\r\nimport { useNavigate, useParams } from 'react-router-dom';\r\nimport { BreadcrumbWithCustomSeparator } from '@/breadCrumb/BreadCrumb';\r\nimport { useGetAllStatusesQuery } from '@/slice/status/status';\r\n\r\nconst breadcrumbItems = [\r\n    { label: \"Dashboard\", href: \"/dashboard\" },\r\n    { label: \"Inquiry Table\", href: \"/inquiry-list\" },\r\n    { label: \"Inquiry Form\", href: null },\r\n]\r\n\r\nexport default function EditInquiryForm({ onClose }) {\r\n    const { id } = useParams();\r\n    const navigate = useNavigate();\r\n    const { data: inquiryData, isLoading: isFetching } = useGetInquiryByIdQuery(id);\r\n    const [updateInquiry, { isLoading }] = useUpdateInquiryMutation();\r\n    const { data: statusesData, isLoading: isLoadingStatuses } = useGetAllStatusesQuery();\r\n\r\n    const form = useForm({\r\n        defaultValues: {\r\n            companyName: \"\",\r\n            name: \"\",\r\n            email: \"\",\r\n            mobile: \"\",\r\n            address: \"\",\r\n            status: \"New Inquiry\"\r\n        }\r\n    });\r\n\r\n    // Custom validation function\r\n    const validateForm = (data) => {\r\n        const errors = {};\r\n\r\n        if (!data.companyName || data.companyName.length < 2) {\r\n            errors.companyName = \"Company name must be at least 2 characters\";\r\n        }\r\n\r\n        if (!data.name || data.name.length < 2) {\r\n            errors.name = \"Full name must be at least 2 characters\";\r\n        }\r\n\r\n        if (!data.email || !/^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/.test(data.email)) {\r\n            errors.email = \"Invalid email address\";\r\n        }\r\n\r\n        if (!data.mobile || !/^[0-9]{10}$/.test(data.mobile)) {\r\n            errors.mobile = \"Mobile number must be 10 digits\";\r\n        }\r\n\r\n        if (!data.address || data.address.length < 2) {\r\n            errors.address = \"Address must be at least 2 characters\";\r\n        }\r\n\r\n        if (!data.status) {\r\n            errors.status = \"Please select a status\";\r\n        }\r\n\r\n        return errors;\r\n    };\r\n\r\n    useEffect(() => {\r\n        if (inquiryData) {\r\n            form.reset({\r\n                companyName: inquiryData.companyName || \"\",\r\n                name: inquiryData.name || \"\",\r\n                email: inquiryData.email || \"\",\r\n                mobile: inquiryData.mobile || \"\",\r\n                address: inquiryData.address || \"\",\r\n                status: inquiryData.status || \"New Inquiry\"\r\n            });\r\n        }\r\n    }, [inquiryData, form]);\r\n\r\n    const onSubmit = async (data) => {\r\n        const validationErrors = validateForm(data);\r\n        \r\n        if (Object.keys(validationErrors).length > 0) {\r\n            Object.keys(validationErrors).forEach(field => {\r\n                form.setError(field, { type: 'manual', message: validationErrors[field] });\r\n            });\r\n            return;\r\n        }\r\n\r\n        try {\r\n            const response = await updateInquiry({ id, ...data }).unwrap();\r\n            form.reset();\r\n            navigate('/inquiry-list');\r\n        } catch (error) {\r\n            alert({\r\n                title: \"Error\",\r\n                description: error?.data?.message || \"Failed to update inquiry\",\r\n                variant: \"destructive\"\r\n            });\r\n        }\r\n    };\r\n\r\n    if (isFetching) return <div>Loading...</div>;\r\n\r\n    return (\r\n        <>\r\n            <div className=\"ml-1\">\r\n                <BreadcrumbWithCustomSeparator items={breadcrumbItems} />\r\n            </div>\r\n            <Form {...form}>\r\n                <form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-4 p-4\">\r\n                    <h2 className=\"text-xl font-semibold mb-4\">Update Inquiry</h2>\r\n                    \r\n                    <FormField\r\n                        control={form.control}\r\n                        name=\"companyName\"\r\n                        render={({ field }) => (\r\n                            <FormItem>\r\n                                <FormLabel>Company Name</FormLabel>\r\n                                <FormControl>\r\n                                    <Input \r\n                                        placeholder=\"Enter company name\" \r\n                                        {...field} \r\n                                    />\r\n                                </FormControl>\r\n                                <FormMessage />\r\n                            </FormItem>\r\n                        )}\r\n                    />\r\n\r\n                    <FormField\r\n                        control={form.control}\r\n                        name=\"name\"\r\n                        render={({ field }) => (\r\n                            <FormItem>\r\n                                <FormLabel>Full Name</FormLabel>\r\n                                <FormControl>\r\n                                    <Input \r\n                                        placeholder=\"Enter full name\" \r\n                                        {...field} \r\n                                    />\r\n                                </FormControl>\r\n                                <FormMessage />\r\n                            </FormItem>\r\n                        )}\r\n                    />\r\n\r\n                    <FormField\r\n                        control={form.control}\r\n                        name=\"email\"\r\n                        render={({ field }) => (\r\n                            <FormItem>\r\n                                <FormLabel>Email</FormLabel>\r\n                                <FormControl>\r\n                                    <Input \r\n                                        type=\"email\"\r\n                                        placeholder=\"Enter email\" \r\n                                        {...field} \r\n                                    />\r\n                                </FormControl>\r\n                                <FormMessage />\r\n                            </FormItem>\r\n                        )}\r\n                    />\r\n\r\n                    <FormField\r\n                        control={form.control}\r\n                        name=\"mobile\"\r\n                        render={({ field }) => (\r\n                            <FormItem>\r\n                                <FormLabel>Mobile Number</FormLabel>\r\n                                <FormControl>\r\n                                    <Input \r\n                                        type=\"tel\"\r\n                                        placeholder=\"Enter 10-digit mobile\" \r\n                                        {...field} \r\n                                    />\r\n                                </FormControl>\r\n                                <FormMessage />\r\n                            </FormItem>\r\n                        )}\r\n                    />\r\n\r\n                    <FormField\r\n                        control={form.control}\r\n                        name=\"address\"\r\n                        render={({ field }) => (\r\n                            <FormItem>\r\n                                <FormLabel>Address</FormLabel>\r\n                                <FormControl>\r\n                                    <Input \r\n                                        placeholder=\"Enter address\" \r\n                                        {...field} \r\n                                    />\r\n                                </FormControl>\r\n                                <FormMessage />\r\n                            </FormItem>\r\n                        )}\r\n                    />\r\n\r\n                    <FormField\r\n                        control={form.control}\r\n                        name=\"status\"\r\n                        render={({ field }) => (\r\n                            <FormItem>\r\n                                <FormLabel>Status</FormLabel>\r\n                                <Select \r\n                                    onValueChange={field.onChange} \r\n                                    defaultValue={field.value}\r\n                                >\r\n                                    <FormControl>\r\n                                        <SelectTrigger>\r\n                                            <SelectValue placeholder=\"Select status\" />\r\n                                        </SelectTrigger>\r\n                                    </FormControl>\r\n                                    <SelectContent>\r\n                                        {statusesData?.data?.map((statusItem) => (\r\n                                            <SelectItem key={statusItem._id} value={statusItem.status}>\r\n                                                {statusItem.status}\r\n                                            </SelectItem>\r\n                                        ))}\r\n                                    </SelectContent>\r\n                                </Select>\r\n                                <FormMessage />\r\n                            </FormItem>\r\n                        )}\r\n                    />\r\n\r\n                    <div className=\"flex justify-end space-x-2 pt-4\">\r\n                        <Button \r\n                            type=\"submit\" \r\n                            disabled={isLoading}\r\n                        >\r\n                            {isLoading ? \"Updating...\" : \"Update Inquiry\"}\r\n                        </Button>\r\n                    </div>\r\n                </form>\r\n            </Form>\r\n        </>\r\n    );\r\n}"],"names":["breadcrumbItems","label","href","EditInquiryForm","onClose","id","useParams","navigate","useNavigate","data","inquiryData","isLoading","isFetching","useGetInquiryByIdQuery","updateInquiry","useUpdateInquiryMutation","statusesData","isLoadingStatuses","useGetAllStatusesQuery","form","useForm","defaultValues","companyName","name","email","mobile","address","status","useEffect","reset","jsx","children","jsxs","Fragment","className","BreadcrumbWithCustomSeparator","items","Form","onSubmit","handleSubmit","async","validationErrors","errors","length","test","validateForm","Object","keys","forEach","field","setError","type","message","unwrap","error","alert","title","description","variant","FormField","control","render","FormItem","FormLabel","FormControl","Input","placeholder","FormMessage","Select","onValueChange","onChange","defaultValue","value","SelectTrigger","SelectValue","SelectContent","map","statusItem","SelectItem","_id","Button","disabled"],"mappings":"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"}