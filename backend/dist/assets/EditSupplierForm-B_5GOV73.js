import{a7 as F,bA as I,j as e,I as d,B as D}from"./main-CHwjN9ww.js";import{f as U,i as B,c as x}from"./vendor-CgeupRFx.js";import{b as L}from"./index.esm-CAsSPsEb.js";import{C as P,b as R,c as T,a as _}from"./card-DM5cUxGx.js";import{F as M,a as t,b as i,c as l,d as o,e as c}from"./form-C_BtCiU9.js";import{T as N}from"./textarea-ODpBufAV.js";import{B as A}from"./BreadCrumb-Da9YCv3o.js";import"./chevron-right-CVtm6TB0.js";const O=[{label:"Dashboard",href:"/dashboard"},{label:"Supplier Table",href:"/supplier-table"},{label:"Edit Supplier Form",href:null}];function z(){const E=U(),{id:m}=B(),{data:a,isLoading:w}=F(m),[u]=I(),[h,b]=x.useState(!1),[g,p]=x.useState(null),[f,y]=x.useState(null),s=L({defaultValues:{name:"",mobile:"",email:"",website:"",contact_person:"",address:"",country:"",city:"",description:"",image:null}});x.useEffect(()=>{a&&(s.reset({name:a.name||"",mobile:a.mobile||"",email:a.email||"",website:a.website||"",contact_person:a.contact_person||"",address:a.address||"",country:a.country||"",city:a.city||"",description:a.description||""}),a.image&&y(`/api/image/download/${a.image}`))},[a,s]);async function v(r){if(!m){p("No supplier ID found");return}b(!0),p(null);try{let n={...r};if(delete n.image,r.image&&r.image[0]){const j=new FormData;Object.keys(n).forEach(S=>{j.append(S,n[S])}),j.append("image",r.image[0]),await u({updatedSupplier:j,id:m}).unwrap()}else await u({updatedSupplier:n,id:m}).unwrap();E("/supplier-table")}catch(n){console.error("Error updating supplier:",n),p(n.data?.message||"Failed to update supplier. Please try again.")}finally{b(!1)}}const C=r=>{const n=r.target.files[0];n&&y(URL.createObjectURL(n)),s.setValue("image",r.target.files)};return w?e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-gray-900"})}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"ml-1",children:e.jsx(A,{items:O})}),e.jsxs(P,{className:"max-w-8xl mt-3 mx-auto",children:[e.jsx(R,{children:e.jsx(T,{className:"text-xl font-semibold",children:"Update Supplier"})}),e.jsxs(_,{children:[g&&e.jsx("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4",children:g}),e.jsx(M,{...s,children:e.jsxs("form",{onSubmit:s.handleSubmit(v),className:"space-y-6",children:[e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsx(t,{control:s.control,name:"name",render:({field:r})=>e.jsxs(i,{children:[e.jsxs(l,{children:["Supplier Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(o,{children:e.jsx(d,{placeholder:"Enter supplier name",...r})}),e.jsx(c,{})]})}),e.jsx(t,{control:s.control,name:"contact_person",render:({field:r})=>e.jsxs(i,{children:[e.jsx(l,{children:"Contact Person"}),e.jsx(o,{children:e.jsx(d,{placeholder:"Enter contact person",...r})}),e.jsx(c,{})]})}),e.jsx(t,{control:s.control,name:"email",render:({field:r})=>e.jsxs(i,{children:[e.jsxs(l,{children:["Email ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(o,{children:e.jsx(d,{placeholder:"Enter email address",...r})}),e.jsx(c,{})]})}),e.jsx(t,{control:s.control,name:"website",render:({field:r})=>e.jsxs(i,{children:[e.jsx(l,{children:"Website"}),e.jsx(o,{children:e.jsx(d,{placeholder:"Enter website URL",...r})}),e.jsx(c,{})]})}),e.jsx(t,{control:s.control,name:"mobile",render:({field:r})=>e.jsxs(i,{children:[e.jsxs(l,{children:["Mobile Number ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(o,{children:e.jsx(d,{placeholder:"Enter mobile number",...r})}),e.jsx(c,{})]})})]}),e.jsx(t,{control:s.control,name:"address",render:({field:r})=>e.jsxs(i,{children:[e.jsx(l,{children:"Address"}),e.jsx(o,{children:e.jsx(N,{placeholder:"Enter address",...r})}),e.jsx(c,{})]})}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsx(t,{control:s.control,name:"country",render:({field:r})=>e.jsxs(i,{children:[e.jsx(l,{children:"Country"}),e.jsx(o,{children:e.jsx(d,{placeholder:"Enter country",...r})}),e.jsx(c,{})]})}),e.jsx(t,{control:s.control,name:"city",render:({field:r})=>e.jsxs(i,{children:[e.jsx(l,{children:"City"}),e.jsx(o,{children:e.jsx(d,{placeholder:"Enter city",...r})}),e.jsx(c,{})]})})]}),e.jsx(t,{control:s.control,name:"description",render:({field:r})=>e.jsxs(i,{children:[e.jsx(l,{children:"Description"}),e.jsx(o,{children:e.jsx(N,{placeholder:"Enter description",...r})}),e.jsx(c,{})]})}),e.jsx(t,{control:s.control,name:"image",render:({field:r})=>e.jsxs(i,{children:[e.jsx(l,{children:"Upload Image"}),e.jsx(o,{children:e.jsx(d,{type:"file",onChange:C,accept:"image/*"})}),e.jsx(c,{}),f&&e.jsx("div",{className:"mt-4",children:e.jsx("img",{src:f,alt:"Preview",className:"h-32 w-32 object-cover border"})})]})}),e.jsx("div",{className:"flex gap-4",children:e.jsx(D,{type:"submit",className:"bg-green-500 hover:bg-green-600",disabled:h,children:h?"Saving...":"Save Changes"})})]})})]})]})]})}export{z as default};
