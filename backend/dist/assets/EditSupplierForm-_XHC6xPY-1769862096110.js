import{f as I,a as D,bf as U,dJ as B,r as p,j as e,I as d,B as L}from"./index-C0ocrD0N-1769862096110.js";import{b as P}from"./index.esm-v7cVlBAI-1769862096110.js";import{C as R,b as T,c as _,a as M}from"./card-CvPgf1Aj-1769862096110.js";import{F as O,a as n,b as t,c as i,d as l,e as o}from"./form-Bm-nsTH9-1769862096110.js";import{T as E}from"./textarea-BbNLukyG-1769862096110.js";import{B as V}from"./BreadCrumb-T6I71OvJ-1769862096110.js";const W=[{label:"Dashboard",href:"/dashboard"},{label:"Supplier Table",href:"/supplier-table"},{label:"Edit Supplier Form",href:null}];function k(){const w=I(),{id:x}=D(),{data:a,isLoading:v}=U(x),[h]=B(),[b,g]=p.useState(!1),[f,j]=p.useState(null),[y,S]=p.useState(null),s=P({defaultValues:{name:"",mobile:"",email:"",website:"",contact_person:"",address:"",country:"",city:"",description:"",image:null}});p.useEffect(()=>{a&&(s.reset({name:a.name||"",mobile:a.mobile||"",email:a.email||"",website:a.website||"",contact_person:a.contact_person||"",address:a.address||"",country:a.country||"",city:a.city||"",description:a.description||""}),a.image&&S(`/api/image/download/${a.image}`))},[a,s]);async function C(r){var m;if(!x){j("No supplier ID found");return}g(!0),j(null);try{let c={...r};if(delete c.image,r.image&&r.image[0]){const u=new FormData;Object.keys(c).forEach(N=>{u.append(N,c[N])}),u.append("image",r.image[0]),await h({updatedSupplier:u,id:x}).unwrap()}else await h({updatedSupplier:c,id:x}).unwrap();w("/supplier-table")}catch(c){console.error("Error updating supplier:",c),j(((m=c.data)==null?void 0:m.message)||"Failed to update supplier. Please try again.")}finally{g(!1)}}const F=r=>{const m=r.target.files[0];m&&S(URL.createObjectURL(m)),s.setValue("image",r.target.files)};return v?e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-gray-900"})}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"ml-1",children:e.jsx(V,{items:W})}),e.jsxs(R,{className:"max-w-8xl mt-3 mx-auto",children:[e.jsx(T,{children:e.jsx(_,{className:"text-xl font-semibold",children:"Update Supplier"})}),e.jsxs(M,{children:[f&&e.jsx("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4",children:f}),e.jsx(O,{...s,children:e.jsxs("form",{onSubmit:s.handleSubmit(C),className:"space-y-6",children:[e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsx(n,{control:s.control,name:"name",render:({field:r})=>e.jsxs(t,{children:[e.jsxs(i,{children:["Supplier Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(l,{children:e.jsx(d,{placeholder:"Enter supplier name",...r})}),e.jsx(o,{})]})}),e.jsx(n,{control:s.control,name:"contact_person",render:({field:r})=>e.jsxs(t,{children:[e.jsx(i,{children:"Contact Person"}),e.jsx(l,{children:e.jsx(d,{placeholder:"Enter contact person",...r})}),e.jsx(o,{})]})}),e.jsx(n,{control:s.control,name:"email",render:({field:r})=>e.jsxs(t,{children:[e.jsxs(i,{children:["Email ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(l,{children:e.jsx(d,{placeholder:"Enter email address",...r})}),e.jsx(o,{})]})}),e.jsx(n,{control:s.control,name:"website",render:({field:r})=>e.jsxs(t,{children:[e.jsx(i,{children:"Website"}),e.jsx(l,{children:e.jsx(d,{placeholder:"Enter website URL",...r})}),e.jsx(o,{})]})}),e.jsx(n,{control:s.control,name:"mobile",render:({field:r})=>e.jsxs(t,{children:[e.jsxs(i,{children:["Mobile Number ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(l,{children:e.jsx(d,{placeholder:"Enter mobile number",...r})}),e.jsx(o,{})]})})]}),e.jsx(n,{control:s.control,name:"address",render:({field:r})=>e.jsxs(t,{children:[e.jsx(i,{children:"Address"}),e.jsx(l,{children:e.jsx(E,{placeholder:"Enter address",...r})}),e.jsx(o,{})]})}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsx(n,{control:s.control,name:"country",render:({field:r})=>e.jsxs(t,{children:[e.jsx(i,{children:"Country"}),e.jsx(l,{children:e.jsx(d,{placeholder:"Enter country",...r})}),e.jsx(o,{})]})}),e.jsx(n,{control:s.control,name:"city",render:({field:r})=>e.jsxs(t,{children:[e.jsx(i,{children:"City"}),e.jsx(l,{children:e.jsx(d,{placeholder:"Enter city",...r})}),e.jsx(o,{})]})})]}),e.jsx(n,{control:s.control,name:"description",render:({field:r})=>e.jsxs(t,{children:[e.jsx(i,{children:"Description"}),e.jsx(l,{children:e.jsx(E,{placeholder:"Enter description",...r})}),e.jsx(o,{})]})}),e.jsx(n,{control:s.control,name:"image",render:({field:r})=>e.jsxs(t,{children:[e.jsx(i,{children:"Upload Image"}),e.jsx(l,{children:e.jsx(d,{type:"file",onChange:F,accept:"image/*"})}),e.jsx(o,{}),y&&e.jsx("div",{className:"mt-4",children:e.jsx("img",{src:y,alt:"Preview",className:"h-32 w-32 object-cover border"})})]})}),e.jsx("div",{className:"flex gap-4",children:e.jsx(L,{type:"submit",className:"bg-green-500 hover:bg-green-600",disabled:b,children:b?"Saving...":"Save Changes"})})]})})]})]})]})}export{k as default};
