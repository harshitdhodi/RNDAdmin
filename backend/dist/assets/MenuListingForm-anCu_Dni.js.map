{"version":3,"file":"MenuListingForm-anCu_Dni.js","sources":["../../src/websiteBackend/MenuListing/MenuListingForm.jsx"],"sourcesContent":["import React, { useEffect } from \"react\";\r\nimport { useNavigate, useParams } from \"react-router-dom\";\r\nimport { toast } from \"react-toastify\";\r\nimport { Input } from \"@/components/ui/input\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { Card } from \"@/components/ui/card\";\r\nimport { Plus, Minus } from \"lucide-react\";\r\nimport { useCreateMenuListingMutation, useUpdateMenuListingMutation, useGetMenuListingByIdQuery, useGetAllMenuListingsQuery } from \"@/slice/menuListing/menuList\";\r\n\r\nconst MenuListingForm = () => {\r\n  const { id } = useParams();\r\n  const navigate = useNavigate();\r\n\r\n  const { data, isLoading } = useGetMenuListingByIdQuery(id, { skip: !id });\r\n  const { refetch: refetchAllMenuListings } = useGetAllMenuListingsQuery();\r\n  const [createMenuListing] = useCreateMenuListingMutation();\r\n  const [updateMenuListing] = useUpdateMenuListingMutation();\r\n\r\n  const [formData, setFormData] = React.useState({\r\n    parent: { name: \"\", path: \"\" },\r\n    children: [],\r\n  });\r\n\r\n  useEffect(() => {\r\n    if (data) {\r\n      setFormData(data.data);\r\n    }\r\n  }, [data]);\r\n\r\n  const handleInputChange = (field, value) => {\r\n    setFormData((prev) => ({\r\n      ...prev,\r\n      [field]: value,\r\n    }));\r\n  };\r\n\r\n  const handleChildChange = (index, field, value) => {\r\n    const updatedChildren = [...formData.children];\r\n    updatedChildren[index][field] = value;\r\n    setFormData((prev) => ({ ...prev, children: updatedChildren }));\r\n  };\r\n\r\n  const handleAddChild = () => {\r\n    setFormData((prev) => ({\r\n      ...prev,\r\n      children: [...prev.children, { name: \"\", path: \"\", subChildren: [] }],\r\n    }));\r\n  };\r\n\r\n  const handleRemoveChild = (index) => {\r\n    setFormData((prev) => ({\r\n      ...prev,\r\n      children: prev.children.filter((_, i) => i !== index),\r\n    }));\r\n  };\r\n\r\n  const handleSubmit = async () => {\r\n    try {\r\n      if (id) {\r\n        await updateMenuListing({ id, ...formData });\r\n        toast.success(\"Menu updated successfully!\");\r\n      } else {\r\n        await createMenuListing(formData);\r\n        toast.success(\"Menu created successfully!\");\r\n      }\r\n      await refetchAllMenuListings();\r\n      navigate(\"/menu-listing-table\");\r\n    } catch (error) {\r\n      toast.error(\"Failed to save menu.\");\r\n    }\r\n  };\r\n\r\n  if (isLoading) return <p>Loading...</p>;\r\n\r\n  return (\r\n    <Card className=\"p-6 max-w-2xl mx-auto\">\r\n      <h2 className=\"text-xl font-bold mb-4\">{id ? \"Update Menu Listing\" : \"Create Menu Listing\"}</h2>\r\n\r\n      {/* Parent Menu */}\r\n      <Card className=\"p-4 mb-4\">\r\n        <h3 className=\"text-lg font-semibold mb-3\">Parent Menu</h3>\r\n        <Input\r\n          placeholder=\"Enter parent menu name\"\r\n          value={formData.parent.name}\r\n          onChange={(e) => handleInputChange(\"parent\", { ...formData.parent, name: e.target.value })}\r\n        />\r\n        <Input\r\n          className=\"mt-2\"\r\n          placeholder=\"Enter parent menu path\"\r\n          value={formData.parent.path}\r\n          onChange={(e) => handleInputChange(\"parent\", { ...formData.parent, path: e.target.value })}\r\n        />\r\n      </Card>\r\n\r\n      {/* Children Menus */}\r\n      <Card className=\"p-4 mb-4\">\r\n        <h3 className=\"text-lg font-semibold mb-3\">Children Menus</h3>\r\n        {formData.children.map((child, index) => (\r\n          <Card key={index} className=\"p-3 mb-3\">\r\n            <div className=\"flex items-center gap-3\">\r\n              <Input\r\n                placeholder=\"Enter child name\"\r\n                value={child.name}\r\n                onChange={(e) => handleChildChange(index, \"name\", e.target.value)}\r\n              />\r\n              <Input\r\n                placeholder=\"Enter child path\"\r\n                value={child.path}\r\n                onChange={(e) => handleChildChange(index, \"path\", e.target.value)}\r\n              />\r\n              <Button variant=\"outline\" onClick={() => handleRemoveChild(index)}>\r\n                <Minus className=\"w-4 h-4\" />\r\n              </Button>\r\n            </div>\r\n          </Card>\r\n        ))}\r\n        <Button variant=\"outline\" onClick={handleAddChild} className=\"w-full\">\r\n          <Plus className=\"w-4 h-4 mr-2\" /> Add Child\r\n        </Button>\r\n      </Card>\r\n\r\n      {/* Submit Button */}\r\n      <Button className=\"w-full mt-4\" onClick={handleSubmit}>\r\n        {id ? \"Update\" : \"Create\"}\r\n      </Button>\r\n    </Card>\r\n  );\r\n};\r\n\r\nexport default MenuListingForm;\r\n"],"names":["MenuListingForm","id","useParams","navigate","useNavigate","data","isLoading","useGetMenuListingByIdQuery","skip","refetch","refetchAllMenuListings","useGetAllMenuListingsQuery","createMenuListing","useCreateMenuListingMutation","updateMenuListing","useUpdateMenuListingMutation","formData","setFormData","React","useState","parent","name","path","children","useEffect","handleInputChange","field","value","prev","handleChildChange","index","updatedChildren","jsx","jsxs","Card","className","Input","placeholder","onChange","e","target","map","child","Button","variant","onClick","filter","_","i","handleRemoveChild","Minus","subChildren","Plus","async","toast","success","error"],"mappings":"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"}