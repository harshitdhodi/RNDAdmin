{"version":3,"file":"MenuListingTable-C1eIMaxg.js","sources":["../../src/websiteBackend/MenuListing/MenuListingTable.jsx"],"sourcesContent":["import React from \"react\";\r\nimport { useNavigate, Link } from \"react-router-dom\";\r\nimport { toast } from \"react-toastify\";\r\nimport { Card } from \"@/components/ui/card\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { Table } from \"@/components/ui/table\";\r\nimport { Plus, Trash, Edit } from \"lucide-react\";\r\nimport { useGetAllMenuListingsQuery, useDeleteMenuListingMutation } from \"@/slice/menuListing/menuList\";\r\nimport { useState } from \"react\";\r\nimport { createPortal } from \"react-dom\";\r\n\r\nconst Popconfirm = ({ title, onConfirm, children }) => {\r\n  const [visible, setVisible] = useState(false);\r\n\r\n  const showConfirm = () => setVisible(true);\r\n  const hideConfirm = () => setVisible(false);\r\n\r\n  const handleConfirm = () => {\r\n    onConfirm();\r\n    hideConfirm();\r\n  };\r\n\r\n  return (\r\n    <div className=\"relative inline-block\">\r\n      <span onClick={showConfirm}>{children}</span>\r\n\r\n      {visible &&\r\n        createPortal(\r\n          <div className=\"fixed inset-0 flex items-center justify-center bg-black bg-opacity-50 z-50\">\r\n            <Card className=\"p-5 w-80 text-center shadow-lg bg-white rounded-lg\">\r\n              <p className=\"text-lg font-semibold\">{title}</p>\r\n              <div className=\"mt-4 flex justify-center gap-4\">\r\n                <Button variant=\"outline\" onClick={hideConfirm}>\r\n                  Cancel\r\n                </Button>\r\n                <Button variant=\"destructive\" onClick={handleConfirm}>\r\n                  Confirm\r\n                </Button>\r\n              </div>\r\n            </Card>\r\n          </div>,\r\n          document.body\r\n        )}\r\n    </div>\r\n  );\r\n};\r\n\r\n\r\n\r\nconst MenuListingTable = () => {\r\n  const { data, error, isLoading, refetch } = useGetAllMenuListingsQuery();\r\n  const [deleteMenuListing] = useDeleteMenuListingMutation();\r\n  const navigate = useNavigate();\r\n\r\n  const handleEdit = (id) => {\r\n    navigate(`/menu-listing-form/${id}`);\r\n  };\r\n\r\n  const handleDelete = async (id) => {\r\n    try {\r\n      await deleteMenuListing(id);\r\n      toast.success(\"Menu deleted successfully!\");\r\n      refetch();\r\n    } catch (err) {\r\n      toast.error(\"Failed to delete menu\");\r\n    }\r\n  };\r\n\r\n  if (isLoading) return <p>Loading...</p>;\r\n  if (error) return <p className=\"text-red-500\">Error: {error.message}</p>;\r\n\r\n  const menuListings = data?.data || [];\r\n\r\n  const formattedData = menuListings.map((menu) => ({\r\n    key: menu._id,\r\n    name: menu.parent.name,\r\n    path: menu.parent.path,\r\n    isParent: true,\r\n    children: menu.children.length > 0 ? menu.children.map((child) => ({\r\n      key: child._id,\r\n      name: `└── ${child.name}`,\r\n      path: child.path,\r\n      isParent: false,\r\n      children: child.subChildren?.length > 0 ? child.subChildren.map((sub) => ({\r\n        key: sub._id,\r\n        name: `    └── ${sub.name}`,\r\n        path: sub.path,\r\n        isParent: false,\r\n      })) : undefined,\r\n    })) : undefined,\r\n  }));\r\n\r\n  const columns = [\r\n    { title: \"Name\", dataIndex: \"name\", key: \"name\" },\r\n    { title: \"Path\", dataIndex: \"path\", key: \"path\" },\r\n    {\r\n      title: \"Actions\",\r\n      key: \"actions\",\r\n      render: (_, record) => (\r\n        <div className=\"flex gap-2\">\r\n          <Popconfirm title=\"Are you sure?\" onConfirm={() => handleDelete(record.key)}>\r\n            <Button variant=\"destructive\" size=\"icon\">\r\n              <Trash className=\"w-4 h-4\" />\r\n            </Button>\r\n          </Popconfirm>\r\n\r\n          {!record.name.includes(\"└──\") && (\r\n            <Button variant=\"outline\" size=\"icon\" onClick={() => handleEdit(record.key)}>\r\n              <Edit className=\"w-4 h-4\" />\r\n            </Button>\r\n          )}\r\n        </div>\r\n      ),\r\n    },\r\n  ];\r\n\r\n  return (\r\n    <Card className=\"p-6\">\r\n      <div className=\"flex justify-between items-center mb-4\">\r\n        <h2 className=\"text-xl font-bold\">Menu Listings</h2>\r\n        <Link to=\"/menu-listing-form\">\r\n          <Button>\r\n            <Plus className=\"w-4 h-4 mr-2\" /> Add Menu\r\n          </Button>\r\n        </Link>\r\n      </div>\r\n      <table className=\"w-full text-left border-collapse\">\r\n  <thead>\r\n    <tr>\r\n      {columns.map((col) => (\r\n        <th key={col.key} className=\"border-b p-2 font-semibold\">\r\n          {col.title}\r\n        </th>\r\n      ))}\r\n    </tr>\r\n  </thead>\r\n  <tbody>\r\n    {formattedData.map((row) => (\r\n      <tr key={row.key} className=\"border-b\">\r\n        <td className=\"p-2\">{row.name}</td>\r\n        <td className=\"p-2\">{row.path}</td>\r\n        <td className=\"p-2\">\r\n          <div className=\"flex gap-2\">\r\n            <Popconfirm title=\"Are you sure?\" onConfirm={() => handleDelete(row.key)}>\r\n              <Button variant=\"destructive\" size=\"icon\">\r\n                <Trash className=\"w-4 h-4\" />\r\n              </Button>\r\n            </Popconfirm>\r\n            {!row.name.includes(\"└──\") && (\r\n              <Button variant=\"outline\" size=\"icon\" onClick={() => handleEdit(row.key)}>\r\n                <Edit className=\"w-4 h-4 text-black\" />\r\n              </Button>\r\n            )}\r\n          </div>\r\n        </td>\r\n      </tr>\r\n    ))}\r\n  </tbody>\r\n</table>\r\n\r\n     </Card>\r\n  );\r\n};\r\n\r\nexport default MenuListingTable;\r\n"],"names":["Popconfirm","title","onConfirm","children","visible","setVisible","useState","hideConfirm","jsxs","className","jsx","onClick","createPortal","Card","Button","variant","document","body","MenuListingTable","data","error","isLoading","refetch","useGetAllMenuListingsQuery","deleteMenuListing","useDeleteMenuListingMutation","navigate","useNavigate","handleEdit","id","handleDelete","async","toast","success","err","message","formattedData","map","menu","key","_id","name","parent","path","isParent","length","child","subChildren","sub","columns","dataIndex","render","_","record","size","Trash","includes","Edit","Link","to","Plus","col","row"],"mappings":"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"}