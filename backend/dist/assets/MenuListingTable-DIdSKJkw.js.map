{"version":3,"file":"MenuListingTable-DIdSKJkw.js","sources":["../../src/websiteBackend/MenuListing/MenuListingTable.jsx"],"sourcesContent":["import React from \"react\";\r\nimport { useNavigate, Link } from \"react-router-dom\";\r\nimport { toast } from \"react-toastify\";\r\nimport { Card } from \"@/components/ui/card\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { Table } from \"@/components/ui/table\";\r\nimport { Plus, Trash, Edit } from \"lucide-react\";\r\nimport { useGetAllMenuListingsQuery, useDeleteMenuListingMutation } from \"@/slice/menuListing/menuList\";\r\nimport { useState } from \"react\";\r\nimport { createPortal } from \"react-dom\";\r\n\r\nconst Popconfirm = ({ title, onConfirm, children }) => {\r\n  const [visible, setVisible] = useState(false);\r\n\r\n  const showConfirm = () => setVisible(true);\r\n  const hideConfirm = () => setVisible(false);\r\n\r\n  const handleConfirm = () => {\r\n    onConfirm();\r\n    hideConfirm();\r\n  };\r\n\r\n  return (\r\n    <div className=\"relative inline-block\">\r\n      <span onClick={showConfirm}>{children}</span>\r\n\r\n      {visible &&\r\n        createPortal(\r\n          <div className=\"fixed inset-0 flex items-center justify-center bg-black bg-opacity-50 z-50\">\r\n            <Card className=\"p-5 w-80 text-center shadow-lg bg-white rounded-lg\">\r\n              <p className=\"text-lg font-semibold\">{title}</p>\r\n              <div className=\"mt-4 flex justify-center gap-4\">\r\n                <Button variant=\"outline\" onClick={hideConfirm}>\r\n                  Cancel\r\n                </Button>\r\n                <Button variant=\"destructive\" onClick={handleConfirm}>\r\n                  Confirm\r\n                </Button>\r\n              </div>\r\n            </Card>\r\n          </div>,\r\n          document.body\r\n        )}\r\n    </div>\r\n  );\r\n};\r\n\r\n\r\n\r\nconst MenuListingTable = () => {\r\n  const { data, error, isLoading, refetch } = useGetAllMenuListingsQuery();\r\n  const [deleteMenuListing] = useDeleteMenuListingMutation();\r\n  const navigate = useNavigate();\r\n\r\n  const handleEdit = (id) => {\r\n    navigate(`/menu-listing-form/${id}`);\r\n  };\r\n\r\n  const handleDelete = async (id) => {\r\n    try {\r\n      await deleteMenuListing(id);\r\n      toast.success(\"Menu deleted successfully!\");\r\n      refetch();\r\n    } catch (err) {\r\n      toast.error(\"Failed to delete menu\");\r\n    }\r\n  };\r\n\r\n  if (isLoading) return <p>Loading...</p>;\r\n  if (error) return <p className=\"text-red-500\">Error: {error.message}</p>;\r\n\r\n  const menuListings = data?.data || [];\r\n\r\n  const formattedData = menuListings.map((menu) => ({\r\n    key: menu._id,\r\n    name: menu.parent.name,\r\n    path: menu.parent.path,\r\n    isParent: true,\r\n    children: menu.children.length > 0 ? menu.children.map((child) => ({\r\n      key: child._id,\r\n      name: `└── ${child.name}`,\r\n      path: child.path,\r\n      isParent: false,\r\n      children: child.subChildren?.length > 0 ? child.subChildren.map((sub) => ({\r\n        key: sub._id,\r\n        name: `    └── ${sub.name}`,\r\n        path: sub.path,\r\n        isParent: false,\r\n      })) : undefined,\r\n    })) : undefined,\r\n  }));\r\n\r\n  const columns = [\r\n    { title: \"Name\", dataIndex: \"name\", key: \"name\" },\r\n    { title: \"Path\", dataIndex: \"path\", key: \"path\" },\r\n    {\r\n      title: \"Actions\",\r\n      key: \"actions\",\r\n      render: (_, record) => (\r\n        <div className=\"flex gap-2\">\r\n          <Popconfirm title=\"Are you sure?\" onConfirm={() => handleDelete(record.key)}>\r\n            <Button variant=\"destructive\" size=\"icon\">\r\n              <Trash className=\"w-4 h-4\" />\r\n            </Button>\r\n          </Popconfirm>\r\n\r\n          {!record.name.includes(\"└──\") && (\r\n            <Button variant=\"outline\" size=\"icon\" onClick={() => handleEdit(record.key)}>\r\n              <Edit className=\"w-4 h-4\" />\r\n            </Button>\r\n          )}\r\n        </div>\r\n      ),\r\n    },\r\n  ];\r\n\r\n  return (\r\n    <Card className=\"p-6\">\r\n      <div className=\"flex justify-between items-center mb-4\">\r\n        <h2 className=\"text-xl font-bold\">Menu Listings</h2>\r\n        <Link to=\"/menu-listing-form\">\r\n          <Button>\r\n            <Plus className=\"w-4 h-4 mr-2\" /> Add Menu\r\n          </Button>\r\n        </Link>\r\n      </div>\r\n      <Table columns={columns} dataSource={formattedData} expandable={{ defaultExpandAllRows: false }} />\r\n    </Card>\r\n  );\r\n};\r\n\r\nexport default MenuListingTable;\r\n"],"names":["Popconfirm","title","onConfirm","children","visible","setVisible","useState","hideConfirm","jsxs","className","jsx","onClick","createPortal","Card","Button","variant","document","body","MenuListingTable","data","error","isLoading","refetch","useGetAllMenuListingsQuery","deleteMenuListing","useDeleteMenuListingMutation","navigate","useNavigate","message","formattedData","map","menu","key","_id","name","parent","path","isParent","length","child","subChildren","sub","columns","dataIndex","render","_","record","async","id","toast","success","err","handleDelete","size","Trash","includes","handleEdit","Edit","Link","to","Plus","Table","dataSource","expandable","defaultExpandAllRows"],"mappings":"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"}