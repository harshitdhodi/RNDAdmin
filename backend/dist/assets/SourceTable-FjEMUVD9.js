import{r as e,j as s}from"./react-BfBsRgn0.js";import{ar as r,as as a,at as t,i,j as o,k as l,au as c,B as d,av as n,ao as u,aw as m,D as j,h as p}from"./index-mCSb4W1J.js";import{b as x,c as h}from"./react-icons-Dq16fPb9.js";import{c as b}from"./react-hook-form-Dn0Bw783.js";import{h as f}from"./lucide-D6BDVLHE.js";import"./classnames-C3ovBj6j.js";import"./react-dom-DwrudmHt.js";import"./scheduler-BFk34ZWe.js";import"./react-redux-DbBiFgqA.js";import"./use-sync-external-store-DdeJV4gQ.js";import"./@reduxjs-UCSEaN3g.js";import"./redux-C5Huw2aR.js";import"./immer-DgfQkf_7.js";import"./redux-thunk-B3S1iNVp.js";import"./reselect-BSOs5pU1.js";import"./js-cookie-BXEMiIsG.js";import"./react-router-DUJjWq5j.js";import"./cookie-BUTH-fPQ.js";import"./@radix-ui-BWjeGzol.js";import"./aria-hidden-BHUiN-rI.js";import"./react-remove-scroll-yauc81_r.js";import"./tslib-Bc9CN1Ef.js";import"./react-remove-scroll-bar-BcxDecei.js";import"./react-style-singleton-C1QVuB2c.js";import"./get-nonce-BYiZHLe3.js";import"./use-sidecar-BA4C4RS7.js";import"./use-callback-ref-Cvx1xcTX.js";import"./@floating-ui-BSChQBl3.js";import"./class-variance-authority-DeOWI0hf.js";import"./clsx-BeLtu-UY.js";import"./tailwind-merge-D2VJQb_v.js";import"./axios-BoylL8Pu.js";const g=({closeModal:u,sourceToEdit:m=null})=>{const{register:j,handleSubmit:p,reset:x}=b({defaultValues:m?{name:m.source}:{}}),[h,{isLoading:f,isSuccess:g,isError:y}]=r(),[N,{isLoading:w,isSuccess:v,isError:S}]=a(null==m?void 0:m._id),{data:k,isLoading:E}=t(null==m?void 0:m._id,{skip:!(null==m?void 0:m._id)});e.useEffect((()=>{k&&x({source:k.data.source})}),[k,x]);return E?s.jsx("p",{children:"Loading source data..."}):s.jsxs(i,{children:[s.jsxs(o,{children:[s.jsx(l,{children:m?"Edit Source":"Add Source"}),s.jsx(c,{children:m?"Update the existing source.":"Fill out the form below to add a new source."})]}),s.jsxs("form",{onSubmit:p((async e=>{try{m?await N({id:m._id,...e}).unwrap():await h(e).unwrap(),x(),u(),alert(m?"Source updated successfully!":"Source created successfully!")}catch(s){alert(m?"Failed to update source.":"Failed to create source.")}})),className:"space-y-4 p-4",children:[s.jsxs("div",{children:[s.jsx("label",{htmlFor:"name",className:"block text-sm font-medium",children:"Name"}),s.jsx("input",{id:"name",...j("source",{required:"Name is required"}),className:"w-full px-4 py-2 border rounded",placeholder:"Enter source name"})]}),s.jsx(d,{type:"submit",className:"w-full bg-blue-500 text-white rounded hover:bg-blue-600",disabled:f||w,children:f||w?"Submitting...":m?"Update":"Submit"}),g&&!m&&s.jsx("p",{className:"text-green-500",children:"Source added successfully!"}),v&&m&&s.jsx("p",{className:"text-green-500",children:"Source updated successfully!"}),(y||S)&&s.jsxs("p",{className:"text-red-500",children:["Error ",m?"updating":"adding"," source."]})]}),s.jsx(n,{})]})},y=()=>{const{data:r,isLoading:t,isError:i}=u(),[o]=m();a();const[l,c]=e.useState(null),[n,b]=e.useState(!1),y=null==r?void 0:r.data,N=()=>{c(null),b(!1)};return t?s.jsx("div",{children:"Loading..."}):i?s.jsx("div",{children:"Error fetching sources."}):s.jsxs("div",{className:"overflow-x-auto",children:[s.jsxs("div",{className:"flex justify-between items-center mb-4",children:[s.jsx("h1",{className:"text-xl font-semibold",children:"Source List"}),s.jsxs(j,{children:[s.jsx(p,{asChild:!0,children:s.jsxs(d,{className:"gap-2",children:[s.jsx(f,{className:"h-4 w-4"}),"Add Source"]})}),s.jsx(g,{closeModal:N})]})]}),s.jsxs("table",{className:"table-auto border-collapse border border-gray-300 w-1/3 text-left",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{className:"border border-gray-300 px-4 py-2",children:"Name"}),s.jsx("th",{className:"border border-gray-300 px-4 py-2",children:"Actions"})]})}),s.jsx("tbody",{children:null==y?void 0:y.map((e=>s.jsxs("tr",{children:[s.jsx("td",{className:"border border-gray-300 px-4 py-2",children:e.source}),s.jsxs("td",{className:"border border-gray-300 px-4 py-2",children:[s.jsx(x,{className:"inline-block mx-2 cursor-pointer text-blue-500",title:"Edit",onClick:()=>(e=>{c(e),b(!0)})(e)}),s.jsx(h,{className:"inline-block mx-2 cursor-pointer text-red-500",title:"Delete",onClick:()=>(async e=>{try{await o(e).unwrap(),alert("Source deleted successfully!")}catch(s){alert("Failed to delete source.")}})(e._id)})]})]},e._id)))})]}),s.jsx(j,{open:n,onOpenChange:N,children:s.jsx(g,{closeModal:N,sourceToEdit:l})})]})};export{y as SourceTable};
