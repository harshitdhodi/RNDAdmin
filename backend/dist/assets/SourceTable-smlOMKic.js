import{bg as w,bh as S,bi as D,j as e,m as C,n as F,o as L,bj as M,B as f,bk as k,bd as v,bl as U,D as j,l as _}from"./main-CHwjN9ww.js";import{c as h}from"./vendor-CgeupRFx.js";import{F as E,a as A}from"./index-cmLIoBFi.js";import{b as B}from"./index.esm-CAsSPsEb.js";import{P as O}from"./plus-BZbZkXNM.js";import"./iconBase-wcvyqyMS.js";const g=({closeModal:n,sourceToEdit:s=null})=>{const{register:u,handleSubmit:x,reset:a}=B({defaultValues:s?{name:s.source}:{}}),[l,{isLoading:i,isSuccess:c,isError:m}]=w(),[p,{isLoading:o,isSuccess:t,isError:r}]=S(s?._id),{data:d,isLoading:y}=D(s?._id,{skip:!s?._id});h.useEffect(()=>{d&&a({source:d.data.source})},[d,a]);const N=async b=>{try{s?await p({id:s._id,...b}).unwrap():await l(b).unwrap(),a(),n(),alert(s?"Source updated successfully!":"Source created successfully!")}catch{alert(s?"Failed to update source.":"Failed to create source.")}};return y?e.jsx("p",{children:"Loading source data..."}):e.jsxs(C,{children:[e.jsxs(F,{children:[e.jsx(L,{children:s?"Edit Source":"Add Source"}),e.jsx(M,{children:s?"Update the existing source.":"Fill out the form below to add a new source."})]}),e.jsxs("form",{onSubmit:x(N),className:"space-y-4 p-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"name",className:"block text-sm font-medium",children:"Name"}),e.jsx("input",{id:"name",...u("source",{required:"Name is required"}),className:"w-full px-4 py-2 border rounded",placeholder:"Enter source name"})]}),e.jsx(f,{type:"submit",className:"w-full bg-blue-500 text-white rounded hover:bg-blue-600",disabled:i||o,children:i||o?"Submitting...":s?"Update":"Submit"}),c&&!s&&e.jsx("p",{className:"text-green-500",children:"Source added successfully!"}),t&&s&&e.jsx("p",{className:"text-green-500",children:"Source updated successfully!"}),(m||r)&&e.jsxs("p",{className:"text-red-500",children:["Error ",s?"updating":"adding"," source."]})]}),e.jsx(k,{})]})},V=()=>{const{data:n,isLoading:s,isError:u}=v(),[x]=U();S();const[a,l]=h.useState(null),[i,c]=h.useState(!1),m=n?.data,p=async r=>{try{await x(r).unwrap(),alert("Source deleted successfully!")}catch{alert("Failed to delete source.")}},o=r=>{l(r),c(!0)},t=()=>{l(null),c(!1)};return s?e.jsx("div",{children:"Loading..."}):u?e.jsx("div",{children:"Error fetching sources."}):e.jsxs("div",{className:"overflow-x-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h1",{className:"text-xl font-semibold",children:"Source List"}),e.jsxs(j,{children:[e.jsx(_,{asChild:!0,children:e.jsxs(f,{className:"gap-2",children:[e.jsx(O,{className:"h-4 w-4"}),"Add Source"]})}),e.jsx(g,{closeModal:t})]})]}),e.jsxs("table",{className:"table-auto border-collapse border border-gray-300 w-1/3 text-left",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"border border-gray-300 px-4 py-2",children:"Name"}),e.jsx("th",{className:"border border-gray-300 px-4 py-2",children:"Actions"})]})}),e.jsx("tbody",{children:m?.map(r=>e.jsxs("tr",{children:[e.jsx("td",{className:"border border-gray-300 px-4 py-2",children:r.source}),e.jsxs("td",{className:"border border-gray-300 px-4 py-2",children:[e.jsx(E,{className:"inline-block mx-2 cursor-pointer text-blue-500",title:"Edit",onClick:()=>o(r)}),e.jsx(A,{className:"inline-block mx-2 cursor-pointer text-red-500",title:"Delete",onClick:()=>p(r._id)})]})]},r._id))})]}),e.jsx(j,{open:i,onOpenChange:t,children:e.jsx(g,{closeModal:t,sourceToEdit:a})})]})};export{V as SourceTable};
