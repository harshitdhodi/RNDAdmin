import{bB as w,bC as D,bD as C,r as h,j as e,s as v,t as F,v as k,by as L,B as S,bz as M,bq as U,bE as _,D as j,q}from"./index-DQEtGUrR-1762233513637.js";import{F as A,a as B}from"./index-Bn-y_TH--1762233513637.js";import{b as P}from"./index.esm-CqX61MnI-1762233513637.js";import{P as G}from"./plus-mprX_k2d-1762233513637.js";import"./iconBase-cTADqQG1-1762233513637.js";const g=({closeModal:l,statusToEdit:s})=>{console.log(s);const{register:d,handleSubmit:u,reset:i,formState:{errors:c}}=P(),{data:r}=w(s==null?void 0:s._id,{skip:!s});console.log(r);const[x,{isLoading:o,isSuccess:a,isError:t}]=D(),[p,{isLoading:b,isSuccess:m,isError:f}]=C(s==null?void 0:s._id),y=async n=>{try{s?await p({id:s._id,...n}).unwrap():await x(n).unwrap(),i()}catch(N){console.error("Failed to save status:",N)}};return h.useEffect(()=>{(a||m)&&l()},[a,m,l]),h.useEffect(()=>{const n=r||s;n&&i({status:n.status})},[r,s,i]),e.jsxs(v,{children:[e.jsxs(F,{children:[e.jsx(k,{children:s?"Edit Status":"Add Status"}),e.jsx(L,{children:s?"Edit the status details below.":"Fill out the form below to create a new status."})]}),e.jsxs("form",{onSubmit:u(y),className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"status",className:"block text-sm font-medium mb-2",children:"Status"}),e.jsx("input",{id:"status",...d("status",{required:"Status is required",minLength:{value:2,message:"Status must be at least 2 characters"}}),className:`w-full px-3 py-2 border rounded ${c.status?"border-red-500":""}`,placeholder:"Enter status name"}),c.status&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:c.status.message})]}),e.jsx(S,{type:"submit",className:"w-full",disabled:o||b,children:o||b?"Submitting...":s?"Update":"Submit"}),(a||m)&&e.jsx("p",{className:"text-green-500",children:s?"Status updated successfully!":"Status added successfully!"}),(t||f)&&e.jsx("p",{className:"text-red-500",children:"Error processing status."})]}),e.jsx(M,{})]})},O=()=>{const{data:l,isLoading:s,isError:d}=U(),[u]=_(),[i,c]=h.useState(null),r=l==null?void 0:l.data,x=async t=>{try{await u(t).unwrap(),alert("Status deleted successfully!")}catch{alert("Failed to delete status.")}},o=t=>{console.log(t),c(t)},a=()=>{c(null)};return s?e.jsx("div",{children:"Loading..."}):d?e.jsx("div",{children:"Error fetching statuses."}):e.jsxs("div",{className:"overflow-x-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h1",{className:"text-xl font-semibold",children:"Status List"}),e.jsxs(j,{children:[e.jsx(q,{asChild:!0,children:e.jsxs(S,{className:"gap-2",children:[e.jsx(G,{className:"h-4 w-4"}),"Add Status"]})}),e.jsx(g,{closeModal:a})]})]}),e.jsxs("table",{className:"table-auto border-collapse border border-gray-300 w-1/2 text-left",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"border border-gray-300 px-4 py-2",children:"Name"}),e.jsx("th",{className:"border border-gray-300 px-4 py-2",children:"Actions"})]})}),e.jsx("tbody",{children:r==null?void 0:r.map(t=>e.jsxs("tr",{children:[e.jsx("td",{className:"border border-gray-300 px-4 py-2",children:t.status}),e.jsxs("td",{className:"border border-gray-300 px-4 py-2",children:[e.jsx(A,{className:"inline-block mx-2 cursor-pointer text-blue-500",title:"Edit",onClick:()=>o(t)}),e.jsx(B,{className:"inline-block mx-2 cursor-pointer text-red-500",title:"Delete",onClick:()=>x(t._id)})]})]},t._id))})]}),i&&e.jsx(j,{open:!0,onOpenChange:a,children:e.jsx(g,{closeModal:a,statusToEdit:i})})]})};export{O as StatusTable};
