import{bl as w,bm as D,bn as C,j as s,m as F,n as v,o as E,bi as k,B as S,bj as L,ba as M,bo as U,D as j,l as _}from"./main-y5s0Z35r-1744439108834.js";import{c as h}from"./vendor-C9iLKeEQ-1744439108834.js";import{F as A,a as B}from"./index-sQA0swT4-1744439108834.js";import{b as P}from"./index.esm-CW7Xbdp9-1744439108834.js";import{P as q}from"./plus-BDThjScC-1744439108834.js";import"./iconBase-BXKifVGR-1744439108834.js";const g=({closeModal:c,statusToEdit:e})=>{console.log(e);const{register:d,handleSubmit:u,reset:r,formState:{errors:l}}=P(),{data:i}=w(e?._id,{skip:!e});console.log(i);const[m,{isLoading:n,isSuccess:a,isError:t}]=D(),[p,{isLoading:b,isSuccess:x,isError:f}]=C(e?._id),y=async o=>{try{e?await p({id:e._id,...o}).unwrap():await m(o).unwrap(),r()}catch(N){console.error("Failed to save status:",N)}};return h.useEffect(()=>{(a||x)&&c()},[a,x,c]),h.useEffect(()=>{const o=i||e;o&&r({status:o.status})},[i,e,r]),s.jsxs(F,{children:[s.jsxs(v,{children:[s.jsx(E,{children:e?"Edit Status":"Add Status"}),s.jsx(k,{children:e?"Edit the status details below.":"Fill out the form below to create a new status."})]}),s.jsxs("form",{onSubmit:u(y),className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{htmlFor:"status",className:"block text-sm font-medium mb-2",children:"Status"}),s.jsx("input",{id:"status",...d("status",{required:"Status is required",minLength:{value:2,message:"Status must be at least 2 characters"}}),className:`w-full px-3 py-2 border rounded ${l.status?"border-red-500":""}`,placeholder:"Enter status name"}),l.status&&s.jsx("p",{className:"text-red-500 text-sm mt-1",children:l.status.message})]}),s.jsx(S,{type:"submit",className:"w-full",disabled:n||b,children:n||b?"Submitting...":e?"Update":"Submit"}),(a||x)&&s.jsx("p",{className:"text-green-500",children:e?"Status updated successfully!":"Status added successfully!"}),(t||f)&&s.jsx("p",{className:"text-red-500",children:"Error processing status."})]}),s.jsx(L,{})]})},$=()=>{const{data:c,isLoading:e,isError:d}=M(),[u]=U(),[r,l]=h.useState(null),i=c?.data,m=async t=>{try{await u(t).unwrap(),alert("Status deleted successfully!")}catch{alert("Failed to delete status.")}},n=t=>{console.log(t),l(t)},a=()=>{l(null)};return e?s.jsx("div",{children:"Loading..."}):d?s.jsx("div",{children:"Error fetching statuses."}):s.jsxs("div",{className:"overflow-x-auto",children:[s.jsxs("div",{className:"flex justify-between items-center mb-4",children:[s.jsx("h1",{className:"text-xl font-semibold",children:"Status List"}),s.jsxs(j,{children:[s.jsx(_,{asChild:!0,children:s.jsxs(S,{className:"gap-2",children:[s.jsx(q,{className:"h-4 w-4"}),"Add Status"]})}),s.jsx(g,{closeModal:a})]})]}),s.jsxs("table",{className:"table-auto border-collapse border border-gray-300 w-1/2 text-left",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{className:"border border-gray-300 px-4 py-2",children:"Name"}),s.jsx("th",{className:"border border-gray-300 px-4 py-2",children:"Actions"})]})}),s.jsx("tbody",{children:i?.map(t=>s.jsxs("tr",{children:[s.jsx("td",{className:"border border-gray-300 px-4 py-2",children:t.status}),s.jsxs("td",{className:"border border-gray-300 px-4 py-2",children:[s.jsx(A,{className:"inline-block mx-2 cursor-pointer text-blue-500",title:"Edit",onClick:()=>n(t)}),s.jsx(B,{className:"inline-block mx-2 cursor-pointer text-red-500",title:"Delete",onClick:()=>m(t._id)})]})]},t._id))})]}),r&&s.jsx(j,{open:!0,onOpenChange:a,children:s.jsx(g,{closeModal:a,statusToEdit:r})})]})};export{$ as StatusTable};
