import{s as e,j as s,I as r,B as a,X as l}from"./main-BcUd3ASm.js";import{d as n,r as t}from"./vendor-router-CaZtIe2_.js";import{b as c}from"./index.esm-CJw2PcRb.js";import{C as i,b as o,c as d,a as m}from"./card-DKPCnjx_.js";import{F as j,a as x,b as h,c as p,d as u,e as f}from"./form-ChijvnbD.js";import{T as b}from"./textarea-BX_s7d6D.js";import{B as g}from"./BreadCrumb-B5EzA35k.js";import{S as y}from"./sweetalert2.esm.all-D2QuJ--x.js";import{S as N,a as v,b as w,c as S,d as C}from"./select-Dc7LnXRO.js";import"./vendor-react-DD_RYU77.js";import"./vendor-utils-CfKmydC0.js";import"./breadcrumb-DEvmmGzh.js";import"./chevron-right-C95tp0e6.js";import"./index-CMYgmcqM.js";import"./index-BY97PVuz.js";import"./check-CxfHQWmE.js";import"./chevron-up-BAx2OvKy.js";const E=[{label:"Dashboard",href:"/dashboard"},{label:"Supplier Table",href:"/supplier-table"},{label:"Supplier Form",href:"/supplier-form"}];function F(){const F=n(),[P,A]=t.useState(!1),[I,U]=t.useState(null),[k,B]=t.useState(null),{refetch:L}=e(),O=c({defaultValues:{supplierName:"",contactPerson:"",email:"",website:"",mobileNumber:"",phoneNumber:"",address:"",country:"",city:"",description:"",image:null}}),[R,V]=t.useState([]),[_,D]=t.useState([]);t.useEffect((()=>{fetch("https://restcountries.com/v3.1/all").then((e=>e.json())).then((e=>{const s=e.map((e=>({name:e.name.common,code:e.cca2}))).sort(((e,s)=>e.name.localeCompare(s.name)));V(s)})).catch((e=>{}))}),[]);const K=e=>{const s=e.target.files[0];s&&B(URL.createObjectURL(s))};return s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"ml-1",children:s.jsx(g,{items:E})}),s.jsxs(i,{className:"max-w-8xl mt-3 mx-auto",children:[s.jsx(o,{children:s.jsx(d,{className:"text-xl font-semibold",children:"Add Supplier"})}),s.jsx(m,{children:s.jsx(j,{...O,children:s.jsxs("form",{onSubmit:O.handleSubmit((async function(e){A(!0),U(null);const s=new FormData;Object.keys(e).forEach((r=>{"image"===r&&e.image?s.append("image",e.image[0]):s.append(r,e[r])}));try{const e=await fetch("/api/supplier/add",{method:"POST",body:s});if(!e.ok)throw new Error("Failed to submit form");await e.json();await L(),await y.fire({title:"Success!",text:"Supplier added successfully",icon:"success",timer:2e3,showConfirmButton:!1}),F("/supplier-table")}catch(r){U("Failed to submit form. Please try again."),y.fire({title:"Error!",text:r.message||"Failed to add supplier",icon:"error"})}finally{A(!1)}})),className:"space-y-6",children:[s.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[s.jsx(x,{control:O.control,name:"name",render:({field:e})=>s.jsxs(h,{children:[s.jsxs(p,{children:["Supplier Name ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx(u,{children:s.jsx(r,{placeholder:"Enter supplier name",...e})}),s.jsx(f,{})]})}),s.jsx(x,{control:O.control,name:"contact_person",render:({field:e})=>s.jsxs(h,{children:[s.jsx(p,{children:"Contact Person"}),s.jsx(u,{children:s.jsx(r,{placeholder:"Enter contact person",...e})}),s.jsx(f,{})]})}),s.jsx(x,{control:O.control,name:"email",render:({field:e})=>s.jsxs(h,{children:[s.jsxs(p,{children:["Email ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx(u,{children:s.jsx(r,{placeholder:"Enter email address",...e})}),s.jsx(f,{})]})}),s.jsx(x,{control:O.control,name:"website",render:({field:e})=>s.jsxs(h,{children:[s.jsx(p,{children:"Website"}),s.jsx(u,{children:s.jsx(r,{placeholder:"Enter website URL",...e})}),s.jsx(f,{})]})}),s.jsx(x,{control:O.control,name:"mobile",render:({field:e})=>s.jsxs(h,{children:[s.jsx(p,{children:"Mobile Number"}),s.jsx(u,{children:s.jsx(r,{placeholder:"Enter mobile number",...e})}),s.jsx(f,{})]})}),s.jsx(x,{control:O.control,name:"country",render:({field:e})=>s.jsxs(h,{children:[s.jsxs(p,{children:["Country ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsxs(N,{onValueChange:s=>{e.onChange(s),(async e=>{try{const s=await fetch(`https://api.api-ninjas.com/v1/city?country=${e}&limit=30`,{headers:{"X-Api-Key":"YOUR_API_NINJAS_KEY"}}),r=(await s.json()).map((e=>e.name)).sort();D(r),O.setValue("city","")}catch(s){}})(s)},value:e.value,children:[s.jsx(u,{children:s.jsx(v,{children:s.jsx(w,{placeholder:"Select country"})})}),s.jsx(S,{children:R.map((e=>s.jsx(C,{value:e.name,children:e.name},e.code)))})]}),s.jsx(f,{})]})}),s.jsx(x,{control:O.control,name:"city",render:({field:e})=>s.jsxs(h,{children:[s.jsxs(p,{children:["City ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsxs(N,{onValueChange:e.onChange,value:e.value,disabled:!O.watch("country"),children:[s.jsx(u,{children:s.jsx(v,{children:s.jsx(w,{placeholder:"Select city"})})}),s.jsx(S,{children:_.map((e=>s.jsx(C,{value:e,children:e},e)))})]}),s.jsx(f,{})]})})]}),s.jsx(x,{control:O.control,name:"address",render:({field:e})=>s.jsxs(h,{children:[s.jsxs(p,{children:["Address ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx(u,{children:s.jsx(b,{placeholder:"Enter address",...e})}),s.jsx(f,{})]})}),s.jsx(x,{control:O.control,name:"image",render:({field:e})=>s.jsxs(h,{children:[s.jsx(p,{children:"Upload Image"}),s.jsx(u,{children:s.jsx(r,{type:"file",...e,onChange:K})}),s.jsx(f,{})]})}),k&&s.jsxs("div",{className:"mt-4",children:[s.jsx("img",{src:k,alt:"Image preview",className:"w-32 h-32 object-cover rounded-lg"}),s.jsx(a,{type:"button",onClick:()=>B(null),className:"absolute top-0 right-0 bg-red-500 text-white p-1 rounded-full",children:s.jsx(l,{className:"h-4 w-4"})})]}),s.jsx("div",{className:"flex gap-4",children:s.jsx(a,{type:"submit",className:"bg-green-500 w-1/4 font-medium hover:bg-green-600 text-lg",disabled:P,children:"Save"})})]})})})]})]})}export{F as default};
//# sourceMappingURL=SupplierForm-Dpw2EfhX.js.map
