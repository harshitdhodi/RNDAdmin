import{r as e,j as s}from"./react-BfBsRgn0.js";import{c as r}from"./react-hook-form-Dn0Bw783.js";import{o as a,I as t,T as l,B as i}from"./index-cVSOkL6A.js";import{C as o,b as n,c,a as d}from"./card-DP-8QC8I.js";import{F as m,a as j,b as x,c as p,d as h,e as u}from"./form-CnKjwTYl.js";import{B as f}from"./BreadCrumb-D0swuSFA.js";import{S as b}from"./sweetalert2-R4CIEh_k.js";import{S as g,a as y,b as w,c as N,d as v}from"./select-DKOOCAeT.js";import{X as S}from"./lucide-D6BDVLHE.js";import{a as C}from"./react-router-DUJjWq5j.js";import"./classnames-C3ovBj6j.js";import"./react-dom-DwrudmHt.js";import"./scheduler-BFk34ZWe.js";import"./react-redux-DbBiFgqA.js";import"./use-sync-external-store-DdeJV4gQ.js";import"./@reduxjs-UCSEaN3g.js";import"./redux-C5Huw2aR.js";import"./immer-DgfQkf_7.js";import"./redux-thunk-B3S1iNVp.js";import"./reselect-BSOs5pU1.js";import"./js-cookie-BXEMiIsG.js";import"./@radix-ui-BWjeGzol.js";import"./aria-hidden-BHUiN-rI.js";import"./react-remove-scroll-yauc81_r.js";import"./tslib-Bc9CN1Ef.js";import"./react-remove-scroll-bar-BcxDecei.js";import"./react-style-singleton-C1QVuB2c.js";import"./get-nonce-BYiZHLe3.js";import"./use-sidecar-BA4C4RS7.js";import"./use-callback-ref-Cvx1xcTX.js";import"./@floating-ui-BSChQBl3.js";import"./class-variance-authority-DeOWI0hf.js";import"./clsx-BeLtu-UY.js";import"./tailwind-merge-D2VJQb_v.js";import"./axios-BoylL8Pu.js";import"./@syncfusion-CXokIO9o.js";import"./cookie-BUTH-fPQ.js";const E=[{label:"Dashboard",href:"/dashboard"},{label:"Supplier Table",href:"/supplier-table"},{label:"Supplier Form",href:"/supplier-form"}];function k(){const k=C(),[F,I]=e.useState(!1),[A,P]=e.useState(null),[U,_]=e.useState(null),{refetch:B}=a(),O=r({defaultValues:{supplierName:"",contactPerson:"",email:"",website:"",mobileNumber:"",phoneNumber:"",address:"",country:"",city:"",description:"",image:null}}),[R,V]=e.useState([]),[D,L]=e.useState([]);e.useEffect((()=>{fetch("https://restcountries.com/v3.1/all").then((e=>e.json())).then((e=>{const s=e.map((e=>({name:e.name.common,code:e.cca2}))).sort(((e,s)=>e.name.localeCompare(s.name)));V(s)})).catch((e=>{}))}),[]);const T=e=>{const s=e.target.files[0];s&&_(URL.createObjectURL(s))};return s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"ml-1",children:s.jsx(f,{items:E})}),s.jsxs(o,{className:"max-w-8xl mt-3 mx-auto",children:[s.jsx(n,{children:s.jsx(c,{className:"text-xl font-semibold",children:"Add Supplier"})}),s.jsx(d,{children:s.jsx(m,{...O,children:s.jsxs("form",{onSubmit:O.handleSubmit((async function(e){I(!0),P(null);const s=new FormData;Object.keys(e).forEach((r=>{"image"===r&&e.image?s.append("image",e.image[0]):s.append(r,e[r])}));try{const e=await fetch("/api/supplier/add",{method:"POST",body:s});if(!e.ok)throw new Error("Failed to submit form");await e.json();await B(),await b.fire({title:"Success!",text:"Supplier added successfully",icon:"success",timer:2e3,showConfirmButton:!1}),k("/supplier-table")}catch(r){P("Failed to submit form. Please try again."),b.fire({title:"Error!",text:r.message||"Failed to add supplier",icon:"error"})}finally{I(!1)}})),className:"space-y-6",children:[s.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[s.jsx(j,{control:O.control,name:"name",render:({field:e})=>s.jsxs(x,{children:[s.jsxs(p,{children:["Supplier Name ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx(h,{children:s.jsx(t,{placeholder:"Enter supplier name",...e})}),s.jsx(u,{})]})}),s.jsx(j,{control:O.control,name:"contact_person",render:({field:e})=>s.jsxs(x,{children:[s.jsx(p,{children:"Contact Person"}),s.jsx(h,{children:s.jsx(t,{placeholder:"Enter contact person",...e})}),s.jsx(u,{})]})}),s.jsx(j,{control:O.control,name:"email",render:({field:e})=>s.jsxs(x,{children:[s.jsxs(p,{children:["Email ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx(h,{children:s.jsx(t,{placeholder:"Enter email address",...e})}),s.jsx(u,{})]})}),s.jsx(j,{control:O.control,name:"website",render:({field:e})=>s.jsxs(x,{children:[s.jsx(p,{children:"Website"}),s.jsx(h,{children:s.jsx(t,{placeholder:"Enter website URL",...e})}),s.jsx(u,{})]})}),s.jsx(j,{control:O.control,name:"mobile",render:({field:e})=>s.jsxs(x,{children:[s.jsx(p,{children:"Mobile Number"}),s.jsx(h,{children:s.jsx(t,{placeholder:"Enter mobile number",...e})}),s.jsx(u,{})]})}),s.jsx(j,{control:O.control,name:"country",render:({field:e})=>s.jsxs(x,{children:[s.jsxs(p,{children:["Country ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsxs(g,{onValueChange:s=>{e.onChange(s),(async e=>{try{const s=await fetch(`https://api.api-ninjas.com/v1/city?country=${e}&limit=30`,{headers:{"X-Api-Key":"YOUR_API_NINJAS_KEY"}}),r=(await s.json()).map((e=>e.name)).sort();L(r),O.setValue("city","")}catch(s){}})(s)},value:e.value,children:[s.jsx(h,{children:s.jsx(y,{children:s.jsx(w,{placeholder:"Select country"})})}),s.jsx(N,{children:R.map((e=>s.jsx(v,{value:e.name,children:e.name},e.code)))})]}),s.jsx(u,{})]})}),s.jsx(j,{control:O.control,name:"city",render:({field:e})=>s.jsxs(x,{children:[s.jsxs(p,{children:["City ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsxs(g,{onValueChange:e.onChange,value:e.value,disabled:!O.watch("country"),children:[s.jsx(h,{children:s.jsx(y,{children:s.jsx(w,{placeholder:"Select city"})})}),s.jsx(N,{children:D.map((e=>s.jsx(v,{value:e,children:e},e)))})]}),s.jsx(u,{})]})})]}),s.jsx(j,{control:O.control,name:"address",render:({field:e})=>s.jsxs(x,{children:[s.jsxs(p,{children:["Address ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx(h,{children:s.jsx(l,{placeholder:"Enter address",...e})}),s.jsx(u,{})]})}),s.jsx(j,{control:O.control,name:"image",render:({field:e})=>s.jsxs(x,{children:[s.jsx(p,{children:"Upload Image"}),s.jsx(h,{children:s.jsx(t,{type:"file",...e,onChange:T})}),s.jsx(u,{})]})}),U&&s.jsxs("div",{className:"mt-4",children:[s.jsx("img",{src:U,alt:"Image preview",className:"w-32 h-32 object-cover rounded-lg"}),s.jsx(i,{type:"button",onClick:()=>_(null),className:"absolute top-0 right-0 bg-red-500 text-white p-1 rounded-full",children:s.jsx(S,{className:"h-4 w-4"})})]}),s.jsx("div",{className:"flex gap-4",children:s.jsx(i,{type:"submit",className:"bg-green-500 w-1/4 font-medium hover:bg-green-600 text-lg",disabled:F,children:"Save"})})]})})})]})]})}export{k as default};
