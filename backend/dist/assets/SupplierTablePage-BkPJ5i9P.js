import{J as e,o as s,j as a,D as r,l,m as i,n,I as t,B as c,P as d,s as o,r as h,Q as m}from"./main-DeRxjK88.js";import{r as x,d as u,R as p,L as j}from"./vendor-router-Bu4EHm1B.js";import{T as b,a as g,b as f,c as N,d as v,e as y}from"./table-Cj_y_WH9.js";import{A as C,a as w,b as S,c as k,d as L,e as D,f as _,g as A}from"./alert-dialog-BIhunjK7.js";import{T as I}from"./trash-2-B_xsoivv.js";import{B as P}from"./badge-lQP7Jiha.js";import{D as O,a as T,b as E,c as F}from"./dropdown-menu-BEoG4Wb8.js";import{E as $}from"./ellipsis-vertical-DXlju7bG.js";import{B as z}from"./BreadCrumb-PqVNrGAD.js";import{P as M}from"./plus-CYGv-ui8.js";import"./vendor-react-CI5aWZjI.js";import"./vendor-utils-BfOc9lHv.js";import"./Combination-CNfQ0noH.js";import"./chevron-right-YTRb9aqn.js";import"./check-CVm68GV7.js";const B=({open:d,onClose:o,chemicalName:h,supplier:m,supplierId:u,refetch:p,allData:j})=>{const[b,g]=x.useState(""),[f,N]=x.useState([]),{data:v,isLoading:y,error:C}=e(b,{skip:!b||b.length<2}),[w,{isLoading:S}]=s();return a.jsx(r,{open:d,onOpenChange:e=>!e&&o(),children:a.jsxs(l,{className:"max-w-lg p-6",children:[a.jsx(i,{children:a.jsxs(n,{className:"text-lg font-semibold text-[#3b1f91]",children:["Add Chemicals for ",m]})}),a.jsxs("div",{className:"mt-4",children:[a.jsx(t,{placeholder:`Search ${m}`,value:b,onChange:e=>g(e.target.value),className:"w-full mb-4"}),y?a.jsx("div",{children:"Loading..."}):b&&v&&v.length>0&&a.jsx("ul",{className:"border bg-white rounded max-h-40 overflow-y-auto",children:v.map((e=>a.jsx("li",{onClick:()=>(e=>{N((s=>{const a=[...s,e];return g(""),a}))})(e),className:"p-2 hover:bg-gray-200 cursor-pointer",children:e.name},e._id)))}),0===v?.length&&!y&&b&&a.jsx("div",{className:"p-2 text-gray-500",children:"No chemicals found"}),a.jsx("div",{className:"mt-4",children:f.length>0&&a.jsx("div",{className:"space-y-2",children:f.map((e=>a.jsxs("div",{className:"flex justify-between items-center bg-gray-100 p-2 rounded",children:[a.jsx("span",{children:e.name}),a.jsx(c,{variant:"outline",size:"sm",onClick:()=>{return s=e._id,void N((e=>e.filter((e=>e._id!==s))));var s},className:"text-red-500",children:"Remove"})]},e._id)))})}),a.jsxs("div",{className:"flex justify-between mt-4",children:[a.jsx(c,{onClick:async()=>{const e=f.map((e=>e._id));try{await w({supplierId:u,chemical_ids:e}).unwrap(),await p(),o(),j()}catch(s){}},className:"bg-[#3b1f91] hover:bg-purple-700",disabled:S||0===f.length,children:S?"Adding...":"+ Add"}),a.jsx(c,{onClick:o,className:"bg-red-600 hover:bg-red-700",children:"Cancel"})]})]})]})})};function R({supplier:e,supplierName:s,allData:r}){const[l,t]=x.useState(10),[h,m]=x.useState(1),[u,p]=x.useState(1),[j,P]=x.useState(!1),[O,T]=x.useState(null),[E,F]=x.useState(null),[$,z]=x.useState(!1),[M,R]=x.useState(null),{data:H,isLoading:J,isError:Q,refetch:U}=d(e,{skip:(h-1)*l,limit:l}),[V,{isLoading:W}]=o();x.useEffect((()=>{H&&p(Math.ceil(H.chemicals.length/l))}),[H,l]);if(J)return a.jsx("div",{children:"Loading..."});if(Q)return a.jsx("div",{children:"Error loading chemicals"});const Y=Array.isArray(H?.chemicals)?H.chemicals:[];return a.jsxs("div",{className:"w-full overflow-auto",children:[a.jsx(i,{children:a.jsxs("div",{className:"flex justify-between items-center mr-5",children:[a.jsxs(n,{children:["Chemicals for ",s]}),a.jsx(c,{onClick:()=>(T(Y),P(!0),void F("supplier")),className:"bg-purple-600 hover:bg-purple-700",children:"+ Add Chemical"})]})}),a.jsx("div",{className:"mt-5 ",children:a.jsxs(b,{children:[a.jsx(g,{children:a.jsxs(f,{children:[a.jsx(N,{className:"p-2",children:"Name"}),a.jsx(N,{className:"p-2",children:"CAS Number"}),a.jsx(N,{className:"p-2 w-[100px]",children:"Action"})]})}),a.jsx(v,{children:Y.map(((e,s)=>a.jsxs(f,{className:"p-2",children:[a.jsx(y,{className:"px-2 py-1",children:e.name}),a.jsx(y,{className:"px-2 py-1",children:e.cas_number}),a.jsx(y,{className:"px-2 py-1",children:a.jsx(c,{variant:"ghost",size:"icon",className:"text-red-500",onClick:()=>(e=>{R(e),z(!0)})(e),disabled:W,children:W?"Deleting...":a.jsx(I,{className:"h-4 w-4"})})})]},s)))})]})}),j&&O&&a.jsx(B,{open:j,onClose:()=>P(!1),chemicalName:O.name,supplier:s,supplierId:e,refetch:U,allData:r}),a.jsx(C,{open:$,onOpenChange:z,children:a.jsxs(w,{children:[a.jsxs(S,{children:[a.jsx(k,{children:"Are you sure?"}),a.jsxs(L,{children:["This action cannot be undone. This will permanently delete the chemical",M&&` "${M.name}"`," from this supplier."]})]}),a.jsxs(D,{children:[a.jsx(_,{children:"Cancel"}),a.jsx(A,{onClick:async()=>{try{await V({supplierId:e,chemicalId:M._id}).unwrap(),U()}catch(s){}finally{z(!1),R(null)}},className:"bg-red-500 hover:bg-red-600",children:"Delete"})]})]})}),a.jsxs("div",{className:"flex items-center justify-between mt-4",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-sm",children:"Items per page:"}),a.jsxs("select",{className:"border p-1 rounded",value:l,onChange:e=>t(Number(e.target.value)),children:[a.jsx("option",{value:5,children:"5"}),a.jsx("option",{value:10,children:"10"}),a.jsx("option",{value:20,children:"20"})]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(c,{variant:"outline",size:"sm",onClick:()=>{h>1&&m(h-1)},disabled:1===h,children:"Previous"}),a.jsxs("span",{children:[h," of ",u]}),a.jsx(c,{variant:"outline",size:"sm",onClick:()=>{h<u&&m(h+1)},disabled:h===u,children:"Next"})]})]})]})}const H=()=>{const{data:e=[],isLoading:s,error:i}=h(),[n,t]=x.useState(1),[d,o]=x.useState(10),[j,C]=x.useState(!1),[w,S]=x.useState(null),[k,L]=x.useState({name:"",email:"",mobile:"",country:"",website:""}),D=u(),[_,A]=x.useState(null),[I,z]=x.useState(!1),{refetch:M}=h(),[H]=m(),J=(e,s)=>{L((a=>({...a,[e]:s}))),t(1)},Q=e.filter((e=>{const s=k.name.toLowerCase();return(!k.name||e.name.toLowerCase().includes(s)||e.email.toLowerCase().includes(s)||e.mobile.toLowerCase().includes(s))&&(!k.country||e.country.toLowerCase().includes(k.country.toLowerCase()))&&(!k.website||e.website.toLowerCase().includes(k.website.toLowerCase()))})),U=Math.ceil(Q.length/d),V=Q.slice((n-1)*d,n*d);return s?a.jsx("div",{children:"Loading..."}):i?a.jsxs("div",{children:["Error loading suppliers: ",i.message]}):a.jsxs("div",{children:[a.jsx("div",{className:"rounded-md shadow-sm bg-white",children:a.jsxs(b,{className:"w-full text-left border-collapse",children:[a.jsxs(g,{className:"bg-gray-100 border-b border-gray-300",children:[a.jsxs(f,{className:"text-gray-600 font-semibold",children:[a.jsx(N,{className:"w-10"}),a.jsx(N,{children:"Info"}),a.jsx(N,{children:"Chemicals"}),a.jsx(N,{children:"Country"}),a.jsx(N,{children:"Website"})]}),a.jsxs(f,{className:"bg-gray-50",children:[a.jsx(y,{}),a.jsx(y,{children:a.jsx("input",{type:"text",placeholder:"Filter by name, email or mobile",className:"p-2 rounded w-full border border-gray-300",value:k.name,onChange:e=>J("name",e.target.value)})}),a.jsx(y,{}),a.jsx(y,{children:a.jsx("input",{type:"text",placeholder:"Filter by country",className:"p-2 rounded w-full border border-gray-300",value:k.country,onChange:e=>J("country",e.target.value)})}),a.jsx(y,{children:a.jsx("input",{type:"text",placeholder:"Filter by website",className:"p-2 rounded w-full border border-gray-300",value:k.website,onChange:e=>J("website",e.target.value)})})]})]}),a.jsx(v,{children:V.map((e=>a.jsx(p.Fragment,{children:a.jsxs(f,{className:"hover:bg-gray-50 border-b border-gray-300",children:[a.jsx(y,{className:"p-2",children:a.jsxs(O,{children:[a.jsx(T,{asChild:!0,children:a.jsx("button",{className:"p-3",children:a.jsx($,{className:"w-4 h-4"})})}),a.jsxs(E,{align:"end",children:[a.jsx(F,{onClick:()=>(e=>{S(e),C(!0)})(e),children:"Add Chemical"}),a.jsx(F,{onClick:()=>D(`/edit-supplier-form/${e._id}`),children:"Edit"}),a.jsx(F,{onClick:()=>(async e=>{try{await H(e)}catch(s){}})(e._id),children:"Delete"})]})]})}),a.jsx(y,{children:a.jsxs("div",{className:"flex flex-col",children:[a.jsx("span",{className:"font-medium",children:e.name}),a.jsx("span",{className:"text-sm text-gray-600",children:e.email}),a.jsx("span",{className:"text-sm text-gray-600",children:e.mobile})]})}),a.jsx(y,{children:a.jsxs(c,{variant:"default",size:"sm",onClick:()=>(e=>{A(e),z(!0)})(e),className:"bg-[#3b1f91] text-white px-4 py-2 rounded hover:bg-[#3b1f91] transition-colors duration-300",children:["Chemicals",a.jsx(P,{variant:"secondary",className:"ml-2 bg-gray-200 text-black px-2 py-1 rounded",children:e.totalChemicalIds||0})]})}),a.jsx(y,{children:e.country}),a.jsx(y,{children:a.jsx(Link,{to:e.website,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline",children:e.website})})]})},e._id)))})]})}),a.jsxs("div",{className:"flex justify-between items-center mt-4",children:[a.jsxs("div",{children:[a.jsx("label",{htmlFor:"items-per-page",className:"mr-2",children:"Items per page:"}),a.jsxs("select",{id:"items-per-page",className:"p-2  border border-gray-300 rounded",value:d,onChange:e=>{o(parseInt(e.target.value)),t(1)},children:[a.jsx("option",{value:10,children:"10"}),a.jsx("option",{value:20,children:"20"}),a.jsx("option",{value:30,children:"30"}),a.jsx("option",{value:40,children:"40"}),a.jsx("option",{value:50,children:"50"})]})]}),a.jsxs("div",{children:[a.jsx("button",{onClick:()=>t((e=>Math.max(e-1,1))),className:"px-3 py-1 border border-gray-300 rounded mr-2",disabled:1===n,children:"Previous"}),a.jsxs("span",{children:["Page ",n," of ",U]}),a.jsx("button",{onClick:()=>t((e=>Math.min(e+1,U))),className:"px-3 py-1 border border-gray-300 rounded ml-2",disabled:n===U,children:"Next"})]})]}),j&&a.jsx(B,{open:j,onClose:()=>C(!1),supplier:w,supplierId:w?._id,chemicalName:w?.name}),a.jsx(r,{open:I,onOpenChange:z,children:a.jsx(l,{className:"max-w-4xl max-h-[80vh] overflow-y-auto",children:I&&_&&a.jsx(R,{supplier:_._id,supplierName:_.name,allData:M})})})]})},J=({purchaseOrders:e})=>a.jsxs(b,{children:[a.jsx(g,{children:a.jsxs(f,{children:[a.jsx(N,{children:"Created Date"}),a.jsx(N,{children:"Order Number"}),a.jsx(N,{children:"Payment Status"}),a.jsx(N,{children:"Total Tax"}),a.jsx(N,{children:"Total Discount"}),a.jsx(N,{children:"Total Amount"})]})}),a.jsx(v,{children:e.map(((e,s)=>a.jsxs(f,{children:[a.jsx(y,{children:e.createdDate}),a.jsx(y,{children:e.orderNumber}),a.jsx(y,{children:e.paymentStatus}),a.jsxs(y,{children:["$",e.totalTax]}),a.jsxs(y,{children:["$",e.totalDiscount]}),a.jsxs(y,{children:["$",e.totalAmount]})]},s)))})]}),Q=[{label:"Dashboard",href:"/dashboard"},{label:"Supplier Table",href:null}];function U(){const[e,s]=x.useState({}),[i,n]=x.useState(!1),[t,d]=x.useState(null),[o,m]=x.useState(1),[u,p]=x.useState(5),{data:b=[],isLoading:g,error:f,refetch:N}=h(),[v,y]=x.useState({});if(g)return a.jsx("p",{children:"Loading suppliers..."});if(f)return a.jsx("p",{children:"Failed to load suppliers"});return a.jsxs("div",{className:"",children:[a.jsx(z,{items:Q}),a.jsxs("div",{className:"flex justify-between mt-4 items-center mb-6",children:[a.jsx("h1",{className:"text-2xl font-medium text-[#3b1f91] ",children:"Suppliers"}),a.jsx(j,{to:"/supplier-form",children:a.jsxs(c,{children:[a.jsx(M,{className:"w-4 h-4 mr-2"}),"Add Supplier"]})})]}),a.jsx(H,{suppliers:b,showPurchaseOrders:e,setShowPurchaseOrders:s,setSelectedSupplier:d,setShowChemicalsModal:n,filters:v,handleFilterChange:(e,s)=>{y((a=>({...a,[e]:s})))},currentPage:o,itemsPerPage:u,paginatedData:b.slice((o-1)*u,o*u),selectedSupplier:t,refetch:N,onChemicalClick:e=>{d(e),n(!0)}}),e[t?.id]&&t&&a.jsxs("div",{className:"mt-6",children:[a.jsxs("h2",{className:"text-xl font-bold mb-4",children:["Purchase Orders for ",t.name]}),a.jsx(J,{purchaseOrders:[]}),"  "]}),a.jsx(r,{open:i,onOpenChange:e=>{n(e)},children:a.jsx(l,{className:"max-w-2xl h-1/2",children:a.jsx(R,{supplier:t?._id,supplierName:t?.name,allData:N})})})]})}export{U as default};
//# sourceMappingURL=SupplierTablePage-BkPJ5i9P.js.map
