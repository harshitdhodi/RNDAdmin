import{k as j,b0 as g,j as e,B as d}from"./main-D1Nesbqm.js";import{f,R as c,L as N}from"./vendor-CxfDVdnA.js";const T=()=>{const{data:s,error:n,isLoading:l}=j(),[x]=g(),m=f(),t=c.useMemo(()=>{if(!s)return[];if(Array.isArray(s))return s;if(s.data&&Array.isArray(s.data))return s.data;for(const r in s)if(Array.isArray(s[r]))return s[r];return console.warn("Unexpected API response format:",s),[]},[s]);console.log("Processed templates:",t);const[o,p]=c.useState({}),h=r=>{p(a=>({...a,[r]:!a[r]}))},y=(r,a=100)=>{if(!r)return"";const i=r.replace(/<[^>]+>/g,"");return i.length<=a?r:i.substring(0,a)+"..."};if(l)return e.jsx("p",{children:"Loading templates..."});if(n)return e.jsxs("p",{children:["Error loading templates: ",n.message]});if(!t.length)return e.jsx("p",{children:"No templates found."});const u=r=>{m(`/edit-template/${r}`)},b=async r=>{if(window.confirm("Are you sure you want to delete this template?"))try{await x(r).unwrap(),alert("Template deleted successfully!")}catch(a){alert("Failed to delete template: "+(a.message||"Unknown error"))}};return e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h1",{className:"text-xl font-bold",children:"Email Templates"}),e.jsx(N,{to:"/add-template",children:e.jsx(d,{className:"bg-[#3b1f91] text-white hover:bg-purple-700",variant:"primary",children:"Add Template"})})]}),e.jsx("hr",{className:"mb-5"}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full border-collapse border border-gray-300",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray-200",children:[e.jsx("th",{className:"border border-gray-300 px-4 py-2",children:"Name"}),e.jsx("th",{className:"border border-gray-300 px-4 py-2",children:"Subject"}),e.jsx("th",{className:"border border-gray-300 px-4 py-2",children:"Body"}),e.jsx("th",{className:"border border-gray-300 px-4 py-2",children:"Actions"})]})}),e.jsx("tbody",{children:t.map(r=>e.jsxs("tr",{className:"hover:bg-gray-100",children:[e.jsx("td",{className:"border border-gray-300 px-4 py-2",children:r.name||"Unnamed Template"}),e.jsx("td",{className:"border border-gray-300 px-4 py-2",children:r.subject||"No Subject"}),e.jsxs("td",{className:"border border-gray-300 px-4 py-2",children:[e.jsx("div",{dangerouslySetInnerHTML:{__html:o[r._id]?r.body:y(r.body)}}),r.body&&r.body.length>100&&e.jsx(d,{variant:"link",className:"text-[#3b1f91] p-0 h-auto font-medium",onClick:()=>h(r._id),children:o[r._id]?"Show Less":"Read More"})]}),e.jsx("td",{className:"border border-gray-300 px-4 py-2",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx(d,{variant:"secondary",className:"hover:bg-[#4f359c]",size:"sm",onClick:()=>u(r._id),children:"Edit"}),e.jsx(d,{variant:"destructive",size:"sm",onClick:()=>b(r._id),children:"Delete"})]})})]},r._id))})]})}),t.length===0&&!l&&e.jsx("div",{className:"text-center py-4",children:e.jsx("p",{children:'No templates found. Create your first template by clicking "Add Template".'})})]})};export{T as default};
