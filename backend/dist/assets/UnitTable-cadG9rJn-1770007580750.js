import{j as e,am as T,ao as D,ap as S,aq as O,aJ as A,I,B as m,ay as _,aI as k,aS as P,aT as B,aU as F,r as c}from"./index-Bx7n1Wn1-1770007580750.js";import{T as H,a as L,b as f,c as N,d as M,e as U}from"./table-DyDAxuLI-1770007580750.js";import{P as z}from"./pencil-J3orB1xm-1770007580750.js";import{C as R}from"./circle-plus-3FJcy44o-1770007580750.js";function b({isOpen:t,onOpenChange:i,unitName:l,setUnitName:a,handleSubmit:h,title:d}){return e.jsx(T,{open:t,onOpenChange:i,children:e.jsxs(D,{children:[e.jsx(S,{children:e.jsx(O,{children:d})}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(A,{htmlFor:"name",children:"Unit Name"}),e.jsx(I,{id:"name",value:l,onChange:x=>a(x.target.value),placeholder:"Enter unit name"})]}),e.jsx(m,{onClick:h,children:d})]})]})})}function q({units:t,openEditDialog:i,handleDelete:l}){return e.jsx("div",{className:"w-full max-w-4xl border shadow-md",children:e.jsxs(H,{children:[e.jsx(L,{children:e.jsxs(f,{children:[e.jsx(N,{className:"w-[200px]",children:"Action"}),e.jsx(N,{children:"Name"})]})}),e.jsx(M,{children:t.map(a=>e.jsxs(f,{children:[e.jsx(U,{children:e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(m,{onClick:()=>i(a),className:"bg-green-500 hover:bg-green-600",size:"sm",children:[e.jsx(z,{className:"h-4 w-4"}),"Edit"]}),e.jsxs(m,{onClick:()=>l(a._id),variant:"destructive",size:"sm",children:[e.jsx(_,{className:"h-4 w-4"}),"Delete"]})]})}),e.jsx(U,{children:a.name})]},a.id))})]})})}function V(){const{data:t=[],isLoading:i,isError:l,refetch:a}=k(),[h]=P(),[d]=B(),[x]=F(),[v,u]=c.useState(!1),[w,p]=c.useState(!1),[n,j]=c.useState(null),[r,o]=c.useState(""),g=async()=>{try{if(r){const s={name:r};console.log("Saving unit:",{id:n==null?void 0:n._id,updatedUnit:s}),n!=null&&n._id?(console.log(r),await d({id:n._id,updatedUnit:s}).unwrap()):await h(s).unwrap(),o(""),j(null),u(!1),p(!1),a()}else console.error("Unit name is empty")}catch(s){console.error("Failed to save unit:",s)}},C=s=>{s&&s._id?(o(s.name),j(s),p(!0)):console.error("Invalid unit selected:",s)},E=async s=>{try{await x(s).unwrap(),a()}catch(y){console.error("Failed to delete unit:",y)}};return i?e.jsx("div",{children:"Loading..."}):l?e.jsx("div",{children:"Error loading units"}):e.jsxs("div",{className:"container",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold text-primary",children:"Units"}),e.jsx(b,{isOpen:v,onOpenChange:u,unitName:r,setUnitName:o,handleSubmit:g,title:"Add New Unit"}),e.jsxs(m,{className:"bg-purple-600 hover:bg-purple-700",onClick:()=>u(!0),children:[e.jsx(R,{className:"mr-2 h-4 w-4"}),"Add Unit"]})]}),e.jsx(q,{units:t,openEditDialog:C,handleDelete:E}),e.jsx(b,{isOpen:w,onOpenChange:p,unitName:r,setUnitName:o,handleSubmit:g,title:"Edit Unit"})]})}export{V as default};
