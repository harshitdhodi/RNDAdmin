{"version":3,"file":"WorldWideForm-Ch0sBuMG.js","sources":["../../src/websiteBackend/worldwideTables/WorldWideForm.jsx"],"sourcesContent":["import React, { useEffect } from 'react';\r\nimport { useNavigate, useParams } from 'react-router-dom';\r\nimport { useForm } from 'react-hook-form';\r\nimport { toast } from 'react-toastify';\r\n\r\n// shadcn components\r\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Input } from '@/components/ui/input';\r\nimport { Textarea } from '@/components/ui/textarea';\r\nimport { \r\n  Form, \r\n  FormControl, \r\n  FormField, \r\n  FormItem, \r\n  FormLabel, \r\n  FormMessage \r\n} from '@/components/ui/form';\r\nimport {\r\n  Select,\r\n  SelectContent,\r\n  SelectItem,\r\n  SelectTrigger,\r\n  SelectValue,\r\n} from '@/components/ui/select';\r\nimport { Breadcrumb, BreadcrumbItem, BreadcrumbLink } from '@/components/ui/breadcrumb';\r\n\r\n// API hooks\r\nimport { \r\n  useCreateWorldwideMutation,\r\n  useUpdateWorldwideMutation,\r\n  useGetWorldwideByIdQuery\r\n} from '../../slice/worldwide/worldwide';\r\n\r\nconst WorldwideForm = () => {\r\n  const navigate = useNavigate();\r\n  const { id } = useParams();\r\n  const isEditMode = !!id;\r\n\r\n  const form = useForm({\r\n    defaultValues: {\r\n      category: 'international',\r\n      name: '',\r\n      state: '',\r\n      cities: ''\r\n    }\r\n  });\r\n\r\n  const [createWorldwide, { isLoading: isCreating }] = useCreateWorldwideMutation();\r\n  const [updateWorldwide, { isLoading: isUpdating }] = useUpdateWorldwideMutation();\r\n  const { data: editData, isLoading: isLoadingEdit } = useGetWorldwideByIdQuery(id, {\r\n    skip: !isEditMode\r\n  });\r\n\r\n  // Set form values when editing\r\n  useEffect(() => {\r\n    if (isEditMode && editData?.data) {\r\n      // Handle cities array conversion to string for textarea\r\n      const formData = { ...editData.data };\r\n      if (Array.isArray(formData.cities)) {\r\n        formData.cities = formData.cities.join('\\n');\r\n      }\r\n      form.reset(formData);\r\n    }\r\n  }, [editData, form, isEditMode]);\r\n\r\n  const onSubmit = async (values) => {\r\n    try {\r\n      // Transform cities from textarea string to array\r\n      const formattedValues = { ...values };\r\n      if (formattedValues.cities) {\r\n        formattedValues.cities = formattedValues.cities\r\n          .split('\\n')\r\n          .filter(city => city.trim() !== '')\r\n          .slice(0, 5);\r\n      }\r\n\r\n      if (isEditMode) {\r\n        await updateWorldwide({ id, data: formattedValues }).unwrap();\r\n        toast.success('Location updated successfully!');\r\n      } else {\r\n        await createWorldwide(formattedValues).unwrap();\r\n        toast.success('Location added successfully!');\r\n      }\r\n      navigate('/worldwide-table');\r\n    } catch (error) {\r\n      toast.error(error.message || 'Something went wrong');\r\n    }\r\n  };\r\n\r\n  const isLoading = isCreating || isUpdating || isLoadingEdit;\r\n\r\n  const watchCategory = form.watch('category');\r\n  const showIndiaFields = watchCategory === 'india';\r\n\r\n  return (\r\n    <div className=\"p-6\">\r\n      <Breadcrumb className=\"mb-4\">\r\n        <BreadcrumbItem>\r\n          <BreadcrumbLink onClick={() => navigate('/dashboard')} className=\"cursor-pointer\">\r\n            Dashboard\r\n          </BreadcrumbLink>\r\n        </BreadcrumbItem>\r\n        <BreadcrumbItem>\r\n          <BreadcrumbLink onClick={() => navigate('/worldwide-table')} className=\"cursor-pointer\">\r\n            Worldwide Locations\r\n          </BreadcrumbLink>\r\n        </BreadcrumbItem>\r\n        <BreadcrumbItem>\r\n          {isEditMode ? 'Edit Location' : 'Add Location'}\r\n        </BreadcrumbItem>\r\n      </Breadcrumb>\r\n\r\n      <Card>\r\n        <CardHeader>\r\n          <CardTitle>{isEditMode ? 'Edit Location' : 'Add New Location'}</CardTitle>\r\n        </CardHeader>\r\n        <CardContent>\r\n          <Form {...form}>\r\n            <form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-6\">\r\n              <FormField\r\n                control={form.control}\r\n                name=\"category\"\r\n                render={({ field }) => (\r\n                  <FormItem>\r\n                    <FormLabel>Category</FormLabel>\r\n                    <Select\r\n                      onValueChange={field.onChange}\r\n                      defaultValue={field.value}\r\n                      value={field.value}\r\n                    >\r\n                      <FormControl>\r\n                        <SelectTrigger>\r\n                          <SelectValue placeholder=\"Select category\" />\r\n                        </SelectTrigger>\r\n                      </FormControl>\r\n                      <SelectContent>\r\n                        <SelectItem value=\"international\">International</SelectItem>\r\n                        <SelectItem value=\"india\">India</SelectItem>\r\n                      </SelectContent>\r\n                    </Select>\r\n                    <FormMessage />\r\n                  </FormItem>\r\n                )}\r\n              />\r\n\r\n              <FormField\r\n                control={form.control}\r\n                name=\"name\"\r\n                rules={{ required: \"Please enter country name\" }}\r\n                render={({ field }) => (\r\n                  <FormItem>\r\n                    <FormLabel>Country Name</FormLabel>\r\n                    <FormControl>\r\n                      <Input placeholder=\"Enter country name\" {...field} />\r\n                    </FormControl>\r\n                    <FormMessage />\r\n                  </FormItem>\r\n                )}\r\n              />\r\n\r\n              {showIndiaFields && (\r\n                <>\r\n                  <FormField\r\n                    control={form.control}\r\n                    name=\"state\"\r\n                    rules={{ required: \"Please enter state\" }}\r\n                    render={({ field }) => (\r\n                      <FormItem>\r\n                        <FormLabel>State</FormLabel>\r\n                        <FormControl>\r\n                          <Input placeholder=\"Enter state\" {...field} />\r\n                        </FormControl>\r\n                        <FormMessage />\r\n                      </FormItem>\r\n                    )}\r\n                  />\r\n\r\n                  <FormField\r\n                    control={form.control}\r\n                    name=\"cities\"\r\n                    rules={{ required: \"Please enter at least one city\" }}\r\n                    render={({ field }) => (\r\n                      <FormItem>\r\n                        <FormLabel>Cities (Enter up to 5 cities, one per line)</FormLabel>\r\n                        <FormControl>\r\n                          <Textarea \r\n                            placeholder=\"Enter cities, one per line\"\r\n                            className=\"min-h-32\"\r\n                            {...field}\r\n                          />\r\n                        </FormControl>\r\n                        <FormMessage />\r\n                      </FormItem>\r\n                    )}\r\n                  />\r\n                </>\r\n              )}\r\n\r\n              <div className=\"flex gap-2\">\r\n                <Button type=\"submit\" disabled={isLoading}>\r\n                  {isEditMode ? 'Update' : 'Submit'}\r\n                </Button>\r\n                <Button \r\n                  variant=\"outline\" \r\n                  type=\"button\"\r\n                  onClick={() => navigate('/worldwide-table')}\r\n                >\r\n                  Cancel\r\n                </Button>\r\n              </div>\r\n            </form>\r\n          </Form>\r\n        </CardContent>\r\n      </Card>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default WorldwideForm;"],"names":["WorldwideForm","navigate","useNavigate","id","useParams","isEditMode","form","useForm","defaultValues","category","name","state","cities","createWorldwide","isLoading","isCreating","useCreateWorldwideMutation","updateWorldwide","isUpdating","useUpdateWorldwideMutation","data","editData","isLoadingEdit","useGetWorldwideByIdQuery","skip","useEffect","formData","Array","isArray","join","reset","showIndiaFields","watch","jsxs","className","children","Breadcrumb","jsx","BreadcrumbItem","BreadcrumbLink","onClick","Card","CardHeader","CardTitle","CardContent","Form","onSubmit","handleSubmit","async","values","formattedValues","split","filter","city","trim","slice","unwrap","toast","success","error","message","FormField","control","render","field","FormItem","FormLabel","Select","onValueChange","onChange","defaultValue","value","FormControl","SelectTrigger","SelectValue","placeholder","SelectContent","SelectItem","FormMessage","rules","required","Input","Fragment","Textarea","Button","type","disabled","variant"],"mappings":"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"}