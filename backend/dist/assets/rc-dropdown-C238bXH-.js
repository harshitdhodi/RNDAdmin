import{k as e,c as t,g as o,b as n}from"./@babel-BfC2A0EA.js";import{T as r}from"./@rc-component-BB24pTyE.js";import{c as i}from"./classnames-C3ovBj6j.js";import{x as a,K as s,e as l,h as c,s as f}from"./rc-util-CQtTJgfq.js";import{r as u,a as p}from"./react-BfBsRgn0.js";var v=s.ESC,m=s.TAB;var d=u.forwardRef((function(e,t){var o=e.overlay,n=e.arrow,r=e.prefixCls,i=u.useMemo((function(){return"function"==typeof o?o():o}),[o]),a=l(t,c(i));return p.createElement(p.Fragment,null,n&&p.createElement("div",{className:"".concat(r,"-arrow")}),p.cloneElement(i,{ref:f(i)?a:void 0}))})),g={adjustX:1,adjustY:1},b=[0,0],w={topLeft:{points:["bl","tl"],overflow:g,offset:[0,-4],targetOffset:b},top:{points:["bc","tc"],overflow:g,offset:[0,-4],targetOffset:b},topRight:{points:["br","tr"],overflow:g,offset:[0,-4],targetOffset:b},bottomLeft:{points:["tl","bl"],overflow:g,offset:[0,4],targetOffset:b},bottom:{points:["tc","bc"],overflow:g,offset:[0,4],targetOffset:b},bottomRight:{points:["tr","br"],overflow:g,offset:[0,4],targetOffset:b}},h=["arrow","prefixCls","transitionName","animation","align","placement","placements","getPopupContainer","showAction","hideAction","overlayClassName","overlayStyle","visible","trigger","autoFocus","overlay","children","onVisibleChange"];function y(s,g){var b,y=s.arrow,C=void 0!==y&&y,R=s.prefixCls,E=void 0===R?"rc-dropdown":R,N=s.transitionName,O=s.animation,x=s.align,A=s.placement,k=void 0===A?"bottomLeft":A,P=s.placements,j=void 0===P?w:P,V=s.getPopupContainer,F=s.showAction,L=s.hideAction,S=s.overlayClassName,T=s.overlayStyle,M=s.visible,W=s.trigger,D=void 0===W?["hover"]:W,B=s.autoFocus,H=s.overlay,I=s.children,K=s.onVisibleChange,X=e(s,h),Y=p.useState(),q=t(Y,2),z=q[0],G=q[1],J="visible"in s?M:z,Q=p.useRef(null),U=p.useRef(null),Z=p.useRef(null);p.useImperativeHandle(g,(function(){return Q.current}));var $=function(e){G(e),null==K||K(e)};!function(e){var t=e.visible,o=e.triggerRef,n=e.onVisibleChange,r=e.autoFocus,i=e.overlayRef,s=u.useRef(!1),l=function(){var e,r;t&&(null===(e=o.current)||void 0===e||null===(r=e.focus)||void 0===r||r.call(e),null==n||n(!1))},c=function(){var e;return!(null===(e=i.current)||void 0===e||!e.focus||(i.current.focus(),s.current=!0,0))},f=function(e){switch(e.keyCode){case v:l();break;case m:var t=!1;s.current||(t=c()),t?e.preventDefault():l()}};u.useEffect((function(){return t?(window.addEventListener("keydown",f),r&&a(c,3),function(){window.removeEventListener("keydown",f),s.current=!1}):function(){s.current=!1}}),[t])}({visible:J,triggerRef:Z,onVisibleChange:$,autoFocus:B,overlayRef:U});var _,ee,te,oe=function(){return p.createElement(d,{ref:U,overlay:H,prefixCls:E,arrow:C})},ne=p.cloneElement(I,{className:i(null===(b=I.props)||void 0===b?void 0:b.className,J&&(_=s.openClassName,void 0!==_?_:"".concat(E,"-open"))),ref:f(I)?l(Z,c(I)):void 0}),re=L;return re||-1===D.indexOf("contextMenu")||(re=["click"]),p.createElement(r,o({builtinPlacements:j},X,{prefixCls:E,ref:Q,popupClassName:i(S,n({},"".concat(E,"-show-arrow"),C)),popupStyle:T,action:D,showAction:F,hideAction:re,popupPlacement:k,popupAlign:x,popupTransitionName:N,popupAnimation:O,popupVisible:J,stretch:(ee=s.minOverlayWidthMatchTrigger,te=s.alignPoint,("minOverlayWidthMatchTrigger"in s?ee:!te)?"minWidth":""),popup:"function"==typeof H?oe:oe(),onPopupVisibleChange:$,onPopupClick:function(e){var t=s.onOverlayClick;G(!1),t&&t(e)},getPopupContainer:V}),ne)}const C=p.forwardRef(y);export{C as D};
