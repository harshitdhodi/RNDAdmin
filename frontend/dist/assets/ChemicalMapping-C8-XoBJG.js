import{r as e,j as t,a as s}from"./react-BfBsRgn0.js";import{l as r,I as i,B as o,p as a,P as l,Q as c}from"./index-cVSOkL6A.js";import{a as n}from"./axios-BoylL8Pu.js";import{F as m,P as p,M as d,B as u}from"./antd-UGvrC4Tl.js";import"./classnames-C3ovBj6j.js";import"./react-dom-DwrudmHt.js";import"./scheduler-BFk34ZWe.js";import"./react-redux-DbBiFgqA.js";import"./use-sync-external-store-DdeJV4gQ.js";import"./@reduxjs-UCSEaN3g.js";import"./redux-C5Huw2aR.js";import"./immer-DgfQkf_7.js";import"./redux-thunk-B3S1iNVp.js";import"./reselect-BSOs5pU1.js";import"./js-cookie-BXEMiIsG.js";import"./react-router-DUJjWq5j.js";import"./cookie-BUTH-fPQ.js";import"./@radix-ui-BWjeGzol.js";import"./aria-hidden-BHUiN-rI.js";import"./react-remove-scroll-yauc81_r.js";import"./tslib-Bc9CN1Ef.js";import"./react-remove-scroll-bar-BcxDecei.js";import"./react-style-singleton-C1QVuB2c.js";import"./get-nonce-BYiZHLe3.js";import"./use-sidecar-BA4C4RS7.js";import"./use-callback-ref-Cvx1xcTX.js";import"./@floating-ui-BSChQBl3.js";import"./class-variance-authority-DeOWI0hf.js";import"./clsx-BeLtu-UY.js";import"./tailwind-merge-D2VJQb_v.js";import"./lucide-D6BDVLHE.js";import"./@syncfusion-CXokIO9o.js";import"./@ant-design-DttPmOfw.js";import"./rc-util-CQtTJgfq.js";import"./@babel-BfC2A0EA.js";import"./react-is-BaRe0U6l.js";import"./@emotion-Czw0TW3x.js";import"./stylis-IVPcsLSI.js";import"./@ctrl-B2IeE8ye.js";import"./rc-motion-Cs3GDHoo.js";import"./@rc-component-BRPzBFoO.js";import"./rc-resize-observer-pLBfxqzk.js";import"./resize-observer-polyfill-CzGuHLZU.js";import"./ant-design-icons-DoIDTG1a.js";import"./rc-dialog-BZYed8xW.js";import"./rc-table-Cyp0j0g2.js";import"./rc-virtual-list-DeG6VQAs.js";import"./rc-tree-Ct99pdeQ.js";import"./rc-checkbox-bMXfL26q.js";import"./rc-pagination-CiqGXVR2.js";import"./rc-select-j7aSw-6E.js";import"./rc-overflow-CN2VNozo.js";import"./throttle-debounce-w9OM8Bxz.js";import"./rc-input-ByOKN0-r.js";import"./rc-tooltip-C0SbzfR_.js";import"./rc-notification-D3ebMW8F.js";import"./rc-image-CGWTMT4q.js";import"./rc-textarea-DZAOw23I.js";import"./copy-to-clipboard-Bgp_G7Oq.js";import"./toggle-selection-DUsDmMsR.js";import"./rc-upload-ClZE7meS.js";import"./rc-progress-bbq4uvV3.js";import"./rc-dropdown-DRLVnlhP.js";import"./rc-menu-CY_ke4Oh.js";import"./rc-field-form-C7q369ye.js";import"./scroll-into-view-if-needed-cNB78-hM.js";import"./compute-scroll-into-view-CJmtT4lq.js";import"./rc-picker-B5UDvhgZ.js";import"./rc-tabs-DirvITx8.js";function j({selectedSupplier:s,onAddChemical:a}){const[l,c]=e.useState(""),[m,p]=e.useState(""),[d,u]=e.useState(null),[j,h]=e.useState([]),[g,x]=e.useState(!1),[f,{isLoading:v}]=r();return t.jsxs("div",{className:"mt-4",children:[t.jsxs("div",{className:"relative",children:[t.jsx(i,{placeholder:"Search Chemical",value:l,onChange:e=>{const t=e.target.value;c(t),t.trim()?(p(t),(async e=>{if(e){x(!0);try{const t=await n.get(`/api/chemical/getChemicalByCategoryAndAlphabet?alphabet=${e}`);h(t.data)}catch(t){h([])}finally{x(!1)}}})(t.charAt(0))):(p(""),h([]))},className:"w-full mb-4",disabled:!s}),g&&t.jsx("div",{className:"absolute top-2 right-4 text-sm text-gray-500",children:"Loading..."})]}),m&&(null==j?void 0:j.length)>0&&t.jsx("ul",{className:"border bg-white rounded max-h-40 overflow-y-auto",children:j.map((e=>t.jsx("li",{onClick:()=>(e=>{u(e),c(e.name),p("")})(e),className:"p-2 hover:bg-gray-200 cursor-pointer border-b last:border-b-0",children:e.name},e._id)))}),0===(null==j?void 0:j.length)&&!g&&m&&t.jsx("div",{className:"p-2 text-gray-500",children:"No chemicals found"}),t.jsx(o,{onClick:async()=>{if(d&&s)try{const e=d._id,t=s._id;await f({supplierId:t,chemical_ids:[e]}).unwrap(),u(null),c(""),a&&a()}catch(e){alert(`Failed to add chemical: ${e.message||"Unknown error occurred"}`)}},disabled:v||!d||!s,className:"mt-4 w-fit py-2 bg-blue-500 text-white rounded hover:bg-blue-600 "+(v?"opacity-50 cursor-not-allowed":""),children:v?"Adding...":"Add Chemical"})]})}function h({chemicals:s,refetch:r,supplierId:i,onRemoveChemical:o}){const[l,c]=e.useState(1),[n,j]=e.useState(10),[h]=a(),[g,x]=e.useState(null),[f,v]=e.useState(!1);Math.ceil(s.length/n);const b=(l-1)*n,y=b+n,S=s.slice(b,y),C=[{title:"Action",dataIndex:"action",render:(e,s)=>t.jsx(u,{danger:!0,size:"small",onClick:()=>(e=>{x(e),v(!0)})(s),children:"Delete"})},{title:"Chemical Name",dataIndex:"name"},{title:"CAS Number",dataIndex:"cas_number"}];return t.jsxs("div",{className:"border rounded-md mt-4 p-4",children:[t.jsx(m,{dataSource:S,columns:C,rowKey:"_id",pagination:!1}),t.jsx(p,{current:l,total:s.length,pageSize:n,onChange:e=>c(e),showSizeChanger:!0,onShowSizeChange:(e,t)=>j(t),className:"mt-4 float-end pt-5"}),t.jsx(d,{title:"Confirm Deletion",open:f,onCancel:()=>v(!1),onOk:async()=>{if(i&&g)try{await h({supplierId:i,chemicalId:g._id}),o(g),r(),v(!1),x(null),1===S.length&&l>1&&c(1)}catch(e){}},okText:"Delete",okButtonProps:{danger:!0},children:t.jsxs("p",{children:['Are you sure you want to delete "',null==g?void 0:g.name,'"?']})})]})}function g({onSelectSupplier:s}){const[r,o]=e.useState(""),[a,n]=e.useState(""),[m,p]=e.useState(null),{data:d,isLoading:u}=l(a.charAt(0),{skip:0===a.length}),{data:g,refetch:x,isFetching:f}=c(null==m?void 0:m._id,{skip:!m});e.useEffect((()=>{g&&!f&&(p(g),"function"==typeof s&&s(g))}),[g,f,s]);const v=()=>{x()};return t.jsxs("div",{className:"mt-4",children:[t.jsx(i,{placeholder:"Search Supplier",value:r,onChange:e=>{const t=e.target.value;o(t),n(t)},className:"w-full mb-4"}),u?t.jsx("div",{children:"Loading..."}):a&&d&&d.length>0&&t.jsx("ul",{className:"border bg-white rounded max-h-40 overflow-y-auto",children:d.map((e=>t.jsx("li",{onClick:()=>(e=>{p(e),o(e.name),n(""),"function"==typeof s&&s(e)})(e),className:"p-2 hover:bg-gray-200 cursor-pointer",children:e.name},e.id)))}),0===(null==d?void 0:d.length)&&!u&&a&&t.jsx("div",{className:"p-2 text-gray-500",children:"No Supplier found"}),f&&t.jsx("div",{className:"p-2 text-gray-500",children:"Refreshing supplier data..."}),t.jsx(j,{selectedSupplier:m,onAddChemical:v}),t.jsx("div",{className:"mt-4",children:t.jsx(h,{chemicals:(null==m?void 0:m.chemical_ids)||[],refetch:x,onRemoveChemical:v,supplierId:null==m?void 0:m._id})})]})}function x(){const[e,r]=s.useState(null),[i,o]=s.useState([]);return t.jsxs("div",{className:"p-6 space-y-6",children:[t.jsx("h1",{className:"text-2xl font-bold text-purple-700",children:"Assign Chemicals to Supplier"}),t.jsx("div",{className:"space-y-4",children:t.jsx(g,{onSelectCustomer:e=>{r(e),o([])}})})]})}export{x as default};
