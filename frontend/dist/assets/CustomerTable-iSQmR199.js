import{r as g,j as e}from"./react-DKICu8bO.js";import{T as E,a as I,b as u,c as i,d as L,e as a}from"./table-BxxugdeG.js";import{D as G,a as H,b as Q,c as F}from"./dropdown-menu-DT6_CG0w.js";import{F as $,D as A,i as k,j as T,k as _,I as f,B as b,R as q,s as U,S as W,q as O}from"./index-CDFtkn6X.js";import{a as V}from"./axios-DXsv3KKR.js";import{h as M,r as J,s as K,C as X,E as Y}from"./lucide-D7hRWJEP.js";import{B as Z}from"./BreadCrumb-C1ZZs22B.js";import{L as B}from"./react-router-B9QVkYva.js";import"./classnames-Bv6oJzD9.js";import"./@radix-ui-BlrBCj0C.js";import"./react-dom-BBS6HuAW.js";import"./scheduler-CKyTKYc2.js";import"./aria-hidden-DQ5UC2Eg.js";import"./react-remove-scroll-fXbmorz6.js";import"./tslib-CDuPK5Eb.js";import"./react-remove-scroll-bar-C9fmXXva.js";import"./react-style-singleton-DKBZmuKg.js";import"./get-nonce-C-Z93AgS.js";import"./use-sidecar-C10EJNOT.js";import"./use-callback-ref-BoKxM4XI.js";import"./@floating-ui-8J-daYO3.js";import"./react-redux-BrRfTdeB.js";import"./use-sync-external-store-D0ivhzzy.js";import"./@reduxjs-B5J9SSA5.js";import"./redux-DITMfSWq.js";import"./immer-fBqQtvEc.js";import"./redux-thunk-ClJT1hhx.js";import"./reselect-C27TLnWV.js";import"./js-cookie-Cz0CWeBA.js";import"./class-variance-authority-Dp3B9jqt.js";import"./clsx-B-dksMZM.js";import"./tailwind-merge-D696Ktp4.js";import"./@syncfusion-BIAkhmGL.js";import"./cookie--_YQFYBD.js";const P=({open:h,onOpenChange:t,customerId:x,onAddChemical:j,customerRefatch:c,refetch:C})=>{const[n,p]=g.useState(""),[d,N]=g.useState([]),{data:o,isLoading:w,error:S}=$(n,{skip:!n||n.length<2}),v=async()=>{const s=d.map(m=>m._id),r={id:x,chemicalId:s};try{await V.put(`/api/customer/addChemicalIdsToCustomer?id=${x}`,r,{headers:{"Content-Type":"application/json"}}),t(!1),j&&j(d),c(),C()}catch(m){console.error("Error adding chemicals:",m)}},D=s=>{d.some(r=>r._id===s._id)||N(r=>{const m=[...r,s];return p(""),m})},y=s=>{N(r=>r.filter(m=>m._id!==s)),C()};return e.jsx(A,{open:h,onOpenChange:s=>!s&&t(!1),children:e.jsxs(k,{className:"max-w-lg p-6",children:[e.jsx(T,{children:e.jsx(_,{className:"text-lg font-semibold text-[#3b1f91]",children:"Add Chemicals to Customer"})}),e.jsxs("div",{className:"mt-4",children:[e.jsx(f,{placeholder:"Search chemicals",value:n,onChange:s=>p(s.target.value),className:"w-full mb-4"}),w?e.jsx("div",{children:"Loading..."}):n&&o&&o.length>0&&e.jsx("ul",{className:"border bg-white rounded max-h-40 overflow-y-auto",children:o.filter(s=>!d.some(r=>r._id===s._id)).map(s=>e.jsx("li",{onClick:()=>D(s),className:"p-2 hover:bg-gray-200 cursor-pointer",children:s.name},s._id))}),(o==null?void 0:o.length)===0&&!w&&n&&e.jsx("div",{className:"p-2 text-gray-500",children:"No chemicals found"}),e.jsx("div",{className:"mt-4",children:d.length>0&&e.jsx("div",{className:"space-y-2",children:d.map(s=>e.jsxs("div",{className:"flex justify-between items-center bg-gray-100 p-2 rounded",children:[e.jsx("span",{children:s.name}),e.jsx(b,{variant:"outline",size:"sm",onClick:()=>y(s._id),className:"text-red-500",children:"Remove"})]},s._id))})}),e.jsxs("div",{className:"flex justify-between mt-4",children:[e.jsx(b,{onClick:v,className:"bg-[#3b1f91] hover:bg-purple-700",disabled:d.length===0,children:"+ Add Chemicals"}),e.jsx(b,{onClick:()=>t(!1),className:"bg-red-600 hover:bg-red-700",children:"Cancel"})]})]})]})})},ee=({customerId:h,customerName:t,open:x,onOpenChange:j,customerRefatch:c})=>{var s;const[C,n]=g.useState(!1),{data:p,isLoading:d,isError:N,refetch:o}=q(h,{skip:!x}),[w,{isLoading:S}]=U(),v=r=>{console.log("Adding chemical:",r),n(!1)},D=async r=>{try{await w({customerId:h,chemicalId:r}),o()}catch(m){console.error("Error deleting chemical:",m)}};if(d)return e.jsx(A,{open:x,onOpenChange:j,children:e.jsxs(k,{children:[e.jsx(T,{children:e.jsx(_,{children:"Loading Chemicals..."})}),e.jsx("p",{children:"Fetching chemical data..."})]})});if(N)return e.jsx(A,{open:x,onOpenChange:j,children:e.jsxs(k,{children:[e.jsx(T,{children:e.jsx(_,{children:"Error Loading Chemicals"})}),e.jsx("p",{children:"Unable to fetch chemical data. Please try again."})]})});const y=((s=p==null?void 0:p.data)==null?void 0:s.chemicalId)||[];return e.jsxs(e.Fragment,{children:[e.jsx(A,{open:x,onOpenChange:j,children:e.jsxs(k,{className:"max-w-3xl",children:[e.jsx(T,{children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs(_,{children:["Chemicals for ",t]}),e.jsxs(b,{className:"m-3",onClick:()=>n(!0),children:[e.jsx(M,{className:"mr-2 h-4 w-4"})," Add Chemical"]})]})}),y.length>0?e.jsxs(E,{children:[e.jsx(I,{children:e.jsxs(u,{children:[e.jsx(i,{children:"Name"}),e.jsx(i,{children:"CAS Number"}),e.jsx(i,{children:"Actions"})," "]})}),e.jsx(L,{children:y.map(r=>e.jsxs(u,{children:[e.jsx(a,{children:r.name}),e.jsx(a,{children:r.cas_number}),e.jsx(a,{children:e.jsx(b,{variant:"destructive",size:"sm",onClick:()=>D(r._id),disabled:S,children:e.jsx(J,{})})})]},r._id))})]}):e.jsx("p",{className:"text-center py-4",children:"No chemicals found for this customer"})]})}),e.jsx(P,{open:C,onOpenChange:n,customerId:h,onAddChemical:v,customerRefatch:c,refetch:o})]})},se=({salesOrders:h=[]})=>e.jsxs(E,{children:[e.jsx(I,{children:e.jsxs(u,{children:[e.jsx(i,{children:"Created Date"}),e.jsx(i,{children:"Order Number"}),e.jsx(i,{children:"Payment Status"}),e.jsx(i,{children:"Total Discount"}),e.jsx(i,{children:"Total Tax"}),e.jsx(i,{children:"Total Amount"})]})}),e.jsx(L,{children:h.length===0?e.jsx(u,{children:e.jsx(a,{colSpan:6,className:"text-center",children:"No Data Found"})}):h.map(t=>e.jsxs(u,{children:[e.jsx(a,{children:t.createdDate}),e.jsx(a,{children:t.orderNumber}),e.jsx(a,{children:t.paymentStatus}),e.jsx(a,{children:t.totalDiscount}),e.jsx(a,{children:t.totalTax}),e.jsx(a,{children:t.totalAmount})]},t.orderNumber))})]}),ae=[{label:"Dashboard",href:"/dashboard"},{label:"Customer Table",href:"/supplier-table"}],Me=()=>{const[h,t]=g.useState(null),[x,j]=g.useState(!1),[c,C]=g.useState(null),[n]=W(),[p,d]=g.useState(!1),[N,o]=g.useState(!1),{data:w,isLoading:S,error:v,refetch:D}=O(),y=w||[];if(S)return e.jsx("div",{children:"Loading..."});if(v)return e.jsx("div",{children:"Error loading customers"});const s=l=>{t(R=>R===l?null:l)},r=l=>{console.log(`Adding chemical: ${l}`)},m=l=>{C(l),j(!0)},z=async l=>{try{d(!0),await n(l),alert("Customer deleted successfully")}catch{alert("Failed to delete customer")}finally{d(!1)}};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"ml-1",children:e.jsx(Z,{items:ae})}),e.jsxs("div",{className:"space-y-4 mt-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h2",{className:"text-xl font-medium text-[#3b1f91]",children:"Customers"}),e.jsx(B,{to:"/customer-form",children:e.jsxs(b,{children:[e.jsx(M,{className:"mr-2 h-4 w-4 "}),"Add Customer"]})})]}),e.jsx("hr",{className:"border-[#3b1f91] border my-4"}),e.jsx("div",{className:"rounded-md border",children:e.jsxs(E,{children:[e.jsx(I,{className:"bg-gray-100 ",children:e.jsxs(u,{children:[e.jsx(i,{className:"w-[50px] border-r-gray-300 bg-gray-100"}),e.jsx(i,{className:"text-black border-r-gray-300 font-semibold",children:"Name"}),e.jsx(i,{className:"text-black border-r-gray-300 font-semibold",children:"Contact Person"}),e.jsx(i,{className:"text-black border-r-gray-300 font-semibold",children:"Email"}),e.jsx(i,{className:"text-black border-r-gray-300 font-semibold",children:"Mobile/Phone"}),e.jsx(i,{className:"text-black border-r-gray-300 font-semibold",children:"Website"}),e.jsx(i,{className:"text-black  font-semibold",children:"Chemicals Count"})]})}),e.jsxs(L,{children:[e.jsxs(u,{className:"bg-gray-100",children:[e.jsx(a,{}),e.jsx(a,{children:e.jsx(f,{placeholder:"Filter name...",className:"max-w-sm"})}),e.jsx(a,{children:e.jsx(f,{placeholder:"Filter contact...",className:"max-w-sm"})}),e.jsx(a,{children:e.jsx(f,{placeholder:"Filter email...",className:"max-w-sm"})}),e.jsx(a,{children:e.jsx(f,{placeholder:"Filter phone...",className:"max-w-sm"})}),e.jsx(a,{children:e.jsx(f,{placeholder:"Filter website...",className:"max-w-sm"})}),e.jsx(a,{children:e.jsx(f,{placeholder:"Filter chemicals...",className:"max-w-sm"})})]}),y.map(l=>e.jsxs(e.Fragment,{children:[e.jsxs(u,{children:[e.jsx(a,{children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(b,{variant:"ghost",size:"sm",onClick:()=>s(l.id),children:h===l.id?e.jsx(K,{className:"h-4 w-4"}):e.jsx(X,{className:"h-4 w-4"})}),e.jsxs(G,{children:[e.jsx(H,{asChild:!0,children:e.jsx(b,{variant:"ghost",size:"sm",children:e.jsx(Y,{className:"h-4 w-4"})})}),e.jsxs(Q,{align:"end",children:[e.jsx(B,{to:`/edit-customer-form/${l._id}`,children:e.jsx(F,{children:"Edit"})}),e.jsx(F,{className:"text-red-600",onClick:()=>z(l._id),disabled:p,children:p?"Deleting...":"Delete"}),e.jsx(F,{onClick:()=>{C(l),o(!0)},children:"Add Chemical"})]})]})]})}),e.jsx(a,{children:l.name}),e.jsx(a,{children:l.contactPerson}),e.jsx(a,{children:l.email}),e.jsx(a,{children:l.phone}),e.jsx(a,{children:l.website}),e.jsx(a,{children:e.jsxs(b,{className:"hover:bg-[#4f359c]",variant:"secondary",size:"sm",onClick:()=>m(l),children:["Chemicals (",l.chemicalId.length,")"]})})]},l.id),h===l.id&&e.jsx(u,{children:e.jsx(a,{colSpan:9,children:e.jsx("div",{className:"p-4",children:e.jsx(se,{customerId:l._id})})})})]}))]})]})}),e.jsx(ee,{open:x,onOpenChange:j,customerName:c==null?void 0:c.name,customerId:c==null?void 0:c._id,onAddChemical:r,customerRefatch:D}),e.jsx(P,{open:N,onOpenChange:o,onAddChemical:r,customerId:c==null?void 0:c._id})]})]})};export{Me as default};
