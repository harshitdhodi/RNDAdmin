import{bK as E,bL as w,j as a,b as q}from"./main-BqSaw_sq.js";import{i as R,f as C,c as n,L as x}from"./vendor-DNXw0_ws.js";import{R as M}from"./index-CZ4jclvw.js";/* empty css                   */import{F as r}from"./index-Cw0H4GsE.js";import{B as o}from"./Breadcrumb-2KrIFCzH.js";import{R as U}from"./HomeOutlined-B2VBQP_C.js";import{S as N}from"./index-D2nVi2Dm.js";import{U as D,R as T}from"./index-D7cNkm7o.js";import{B as j}from"./index-Dx4ajweK.js";import{I as g}from"./index-Dn1mbgUD.js";import{s}from"./index-Nfv-4U3a.js";import"./isEqual-SRXYztYb.js";import"./toArray-CgZcBx3z.js";import"./CheckCircleFilled-B9cYDV8S.js";import"./ExclamationCircleFilled-Dpe_HOR5.js";import"./dropdown-CuRJ2VRe.js";import"./EllipsisOutlined-Czar8QPM.js";import"./TextArea-x7XPQzQf.js";import"./CheckOutlined-DiRhtld1.js";import"./fade-EN-OZS4J.js";import"./useForceUpdate-CFd9TtZN.js";import"./DeleteOutlined-BKV-co7l.js";import"./DownloadOutlined-BQKgUPjT.js";import"./InfoCircleFilled-Ce7fYp6d.js";const{Option:V}=N,oe=()=>{const{id:p}=R(),I=C(),[l]=r.useForm(),[d,S]=n.useState(!1),[y,B]=n.useState([]),{data:e,isLoading:F}=E(p),[L]=w();n.useEffect(()=>{(async()=>{try{const m=await q.get("/api/menulist/get-menu");m.data.success&&B(m.data.data)}catch(m){console.error("Error fetching menu list:",m),s.error("Failed to fetch menu list")}})()},[]),n.useEffect(()=>{e&&l.setFieldsValue({title:e.title,altName:e.altName,details:e.details,imgName:e.imgName,pageSlug:e.pageSlug||"",image:e.image?[{name:e.imgName,url:`/api/image/download/${e.image}`}]:[]})},[e,l]);const b=t=>{S(!0),l.setFieldsValue({imgName:t.file.name,image:t.fileList})},P=async t=>{var m,c,u,h,f;try{if(!((m=t.title)!=null&&m.trim())){s.error("Title is required");return}if(!((c=t.altName)!=null&&c.trim())){s.error("Alt Name is required");return}if(!t.pageSlug){s.error("Page Slug is required");return}const i=new FormData;d&&((h=(u=t.image)==null?void 0:u[0])!=null&&h.originFileObj)?(i.append("image",t.image[0].originFileObj),i.append("imgName",t.image[0].name)):i.append("imgName",t.imgName||e.imgName),i.append("title",t.title.trim()),i.append("altName",t.altName.trim()),i.append("details",((f=t.details)==null?void 0:f.trim())||""),i.append("pageSlug",t.pageSlug),await L({id:p,bannerData:i}),s.success("Banner updated successfully"),I("/banner-table")}catch(i){console.error(i),s.error("Failed to update banner")}};return F?a.jsx("div",{children:"Loading..."}):a.jsxs("div",{children:[a.jsxs(o,{style:{padding:"16px 24px"},children:[a.jsx(o.Item,{children:a.jsxs(x,{to:"/dashboard",children:[a.jsx(U,{})," Dashboard"]})}),a.jsx(o.Item,{children:a.jsx(x,{to:"/banner-table",children:"Banner Management"})}),a.jsx(o.Item,{children:"Edit Banner"})]}),a.jsxs("div",{style:{padding:"24px"},children:[a.jsx("h1",{className:"text-2xl font-bold mb-6",children:"Edit Banner"}),a.jsxs(r,{form:l,layout:"vertical",onFinish:P,initialValues:{title:(e==null?void 0:e.title)||"",altName:(e==null?void 0:e.altName)||"",details:(e==null?void 0:e.details)||"",imgName:(e==null?void 0:e.imgName)||"",pageSlug:(e==null?void 0:e.pageSlug)||"",image:e!=null&&e.image?[{name:e.imgName,url:`/api/image/download/${e.image}`}]:[]},children:[a.jsx(r.Item,{name:"pageSlug",label:"Page Slug",rules:[{required:!0,message:"Please select a Page Slug!"}],children:a.jsx(N,{placeholder:"Select Page Slug",children:y.map(t=>a.jsx(V,{value:t.parent.path,children:t.parent.name},t._id))})}),a.jsx(r.Item,{name:"image",label:"Banner Image",valuePropName:"fileList",getValueFromEvent:t=>t&&t.fileList,children:a.jsx(D,{maxCount:1,listType:"picture",beforeUpload:()=>!1,onChange:b,defaultFileList:e!=null&&e.image?[{name:e.imgName,url:`/api/image/download/${e.image}`}]:[],children:a.jsx(j,{icon:a.jsx(T,{}),children:d?"Change Image":"Upload New Image"})})}),a.jsx(r.Item,{name:"imgName",label:"Image Name",rules:[{required:!0,message:"Please input image name!"}],children:a.jsx(g,{disabled:d})}),a.jsx(r.Item,{name:"title",label:"Title",rules:[{required:!0,message:"Please input title!"}],children:a.jsx(g,{})}),a.jsx(r.Item,{name:"altName",label:"Alt Name",rules:[{required:!0,message:"Please input alt name!"}],children:a.jsx(g,{})}),a.jsx(r.Item,{name:"details",label:"Details",rules:[{message:"Please input details!"}],children:a.jsx(M,{theme:"snow"})}),a.jsx(r.Item,{children:a.jsx(j,{type:"primary",htmlType:"submit",children:"Update"})})]})]})]})};export{oe as default};
