import{d as e,e as i,S as a,U as t,B as r,f as s,s as l}from"./antd-UGvrC4Tl.js";import{r as m,j as o}from"./react-BfBsRgn0.js";import{aV as n,aW as p}from"./index-cVSOkL6A.js";import{R as d}from"./react-quill-O9LY_HeH.js";import{a as c}from"./axios-BoylL8Pu.js";import{Q as j,P as u}from"./ant-design-icons-DoIDTG1a.js";import{b as g,a as x,L as h}from"./react-router-DUJjWq5j.js";import"./@ant-design-DttPmOfw.js";import"./rc-util-CQtTJgfq.js";import"./@babel-BfC2A0EA.js";import"./react-is-BaRe0U6l.js";import"./react-dom-DwrudmHt.js";import"./classnames-C3ovBj6j.js";import"./scheduler-BFk34ZWe.js";import"./@emotion-Czw0TW3x.js";import"./stylis-IVPcsLSI.js";import"./@ctrl-B2IeE8ye.js";import"./rc-motion-Cs3GDHoo.js";import"./@rc-component-BRPzBFoO.js";import"./rc-resize-observer-pLBfxqzk.js";import"./resize-observer-polyfill-CzGuHLZU.js";import"./rc-dialog-BZYed8xW.js";import"./rc-table-Cyp0j0g2.js";import"./rc-virtual-list-DeG6VQAs.js";import"./rc-tree-Ct99pdeQ.js";import"./rc-checkbox-bMXfL26q.js";import"./rc-pagination-CiqGXVR2.js";import"./rc-select-j7aSw-6E.js";import"./rc-overflow-CN2VNozo.js";import"./throttle-debounce-w9OM8Bxz.js";import"./rc-input-ByOKN0-r.js";import"./rc-tooltip-C0SbzfR_.js";import"./rc-notification-D3ebMW8F.js";import"./rc-image-CGWTMT4q.js";import"./rc-textarea-DZAOw23I.js";import"./copy-to-clipboard-Bgp_G7Oq.js";import"./toggle-selection-DUsDmMsR.js";import"./rc-upload-ClZE7meS.js";import"./rc-progress-bbq4uvV3.js";import"./rc-dropdown-DRLVnlhP.js";import"./rc-menu-CY_ke4Oh.js";import"./rc-field-form-C7q369ye.js";import"./scroll-into-view-if-needed-cNB78-hM.js";import"./compute-scroll-into-view-CJmtT4lq.js";import"./rc-picker-B5UDvhgZ.js";import"./rc-tabs-DirvITx8.js";import"./react-redux-DbBiFgqA.js";import"./use-sync-external-store-DdeJV4gQ.js";import"./@reduxjs-UCSEaN3g.js";import"./redux-C5Huw2aR.js";import"./immer-DgfQkf_7.js";import"./redux-thunk-B3S1iNVp.js";import"./reselect-BSOs5pU1.js";import"./js-cookie-BXEMiIsG.js";import"./@radix-ui-BWjeGzol.js";import"./aria-hidden-BHUiN-rI.js";import"./react-remove-scroll-yauc81_r.js";import"./tslib-Bc9CN1Ef.js";import"./react-remove-scroll-bar-BcxDecei.js";import"./react-style-singleton-C1QVuB2c.js";import"./get-nonce-BYiZHLe3.js";import"./use-sidecar-BA4C4RS7.js";import"./use-callback-ref-Cvx1xcTX.js";import"./@floating-ui-BSChQBl3.js";import"./class-variance-authority-DeOWI0hf.js";import"./clsx-BeLtu-UY.js";import"./tailwind-merge-D2VJQb_v.js";import"./lucide-D6BDVLHE.js";import"./@syncfusion-CXokIO9o.js";import"./cookie-BUTH-fPQ.js";import"./lodash-CtK3uT03.js";import"./quill-CMG--X-K.js";const{Option:f}=a,b=()=>{const{id:b}=g(),v=x(),[N]=e.useForm(),[y,S]=m.useState(!1),[I,w]=m.useState([]),{data:F,isLoading:P}=n(b),[q]=p();m.useEffect((()=>{(async()=>{try{const e=await c.get("/api/menulist/get-menu");e.data.success&&w(e.data.data)}catch(e){l.error("Failed to fetch menu list")}})()}),[]),m.useEffect((()=>{F&&N.setFieldsValue({title:F.title,altName:F.altName,details:F.details,imgName:F.imgName,pageSlug:F.pageSlug||"",image:F.image?[{name:F.imgName,url:`/api/image/download/${F.image}`}]:[]})}),[F,N]);return P?o.jsx("div",{children:"Loading..."}):o.jsxs("div",{children:[o.jsxs(i,{style:{padding:"16px 24px"},children:[o.jsx(i.Item,{children:o.jsxs(h,{to:"/dashboard",children:[o.jsx(j,{})," Dashboard"]})}),o.jsx(i.Item,{children:o.jsx(h,{to:"/banner-table",children:"Banner Management"})}),o.jsx(i.Item,{children:"Edit Banner"})]}),o.jsxs("div",{style:{padding:"24px"},children:[o.jsx("h1",{className:"text-2xl font-bold mb-6",children:"Edit Banner"}),o.jsxs(e,{form:N,layout:"vertical",onFinish:async e=>{var i,a,t,r,s;try{if(!(null==(i=e.title)?void 0:i.trim()))return void l.error("Title is required");if(!(null==(a=e.altName)?void 0:a.trim()))return void l.error("Alt Name is required");if(!e.pageSlug)return void l.error("Page Slug is required");const m=new FormData;y&&(null==(r=null==(t=e.image)?void 0:t[0])?void 0:r.originFileObj)?(m.append("image",e.image[0].originFileObj),m.append("imgName",e.image[0].name)):m.append("imgName",e.imgName||F.imgName),m.append("title",e.title.trim()),m.append("altName",e.altName.trim()),m.append("details",(null==(s=e.details)?void 0:s.trim())||""),m.append("pageSlug",e.pageSlug),await q({id:b,bannerData:m}),l.success("Banner updated successfully"),v("/banner-table")}catch(m){l.error("Failed to update banner")}},initialValues:{title:(null==F?void 0:F.title)||"",altName:(null==F?void 0:F.altName)||"",details:(null==F?void 0:F.details)||"",imgName:(null==F?void 0:F.imgName)||"",pageSlug:(null==F?void 0:F.pageSlug)||"",image:(null==F?void 0:F.image)?[{name:F.imgName,url:`/api/image/download/${F.image}`}]:[]},children:[o.jsx(e.Item,{name:"pageSlug",label:"Page Slug",rules:[{required:!0,message:"Please select a Page Slug!"}],children:o.jsx(a,{placeholder:"Select Page Slug",children:I.map((e=>o.jsx(f,{value:e.parent.path,children:e.parent.name},e._id)))})}),o.jsx(e.Item,{name:"image",label:"Banner Image",valuePropName:"fileList",getValueFromEvent:e=>e&&e.fileList,children:o.jsx(t,{maxCount:1,listType:"picture",beforeUpload:()=>!1,onChange:e=>{S(!0),N.setFieldsValue({imgName:e.file.name,image:e.fileList})},defaultFileList:(null==F?void 0:F.image)?[{name:F.imgName,url:`/api/image/download/${F.image}`}]:[],children:o.jsx(r,{icon:o.jsx(u,{}),children:y?"Change Image":"Upload New Image"})})}),o.jsx(e.Item,{name:"imgName",label:"Image Name",rules:[{required:!0,message:"Please input image name!"}],children:o.jsx(s,{disabled:y})}),o.jsx(e.Item,{name:"title",label:"Title",rules:[{required:!0,message:"Please input title!"}],children:o.jsx(s,{})}),o.jsx(e.Item,{name:"altName",label:"Alt Name",rules:[{required:!0,message:"Please input alt name!"}],children:o.jsx(s,{})}),o.jsx(e.Item,{name:"details",label:"Details",rules:[{message:"Please input details!"}],children:o.jsx(d,{theme:"snow"})}),o.jsx(e.Item,{children:o.jsx(r,{type:"primary",htmlType:"submit",children:"Update"})})]})]})]})};export{b as default};
