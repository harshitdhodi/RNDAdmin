import{r as e,j as s}from"./react-BfBsRgn0.js";import{c as r}from"./react-hook-form-Dn0Bw783.js";import{Q as a,aL as i,I as l,T as n,B as t}from"./index-cVSOkL6A.js";import{C as o,b as c,c as d,a as m}from"./card-DP-8QC8I.js";import{F as j,a as x,b as p,c as h,d as u,e as f}from"./form-CnKjwTYl.js";import{B as b}from"./BreadCrumb-D0swuSFA.js";import{S as g,a as y,b as v,c as C,d as N}from"./select-DKOOCAeT.js";import{C as S,a as w}from"./country-state-city-BE-JKyhi.js";import{a as E,b as k}from"./react-router-DUJjWq5j.js";import"./classnames-C3ovBj6j.js";import"./react-dom-DwrudmHt.js";import"./scheduler-BFk34ZWe.js";import"./react-redux-DbBiFgqA.js";import"./use-sync-external-store-DdeJV4gQ.js";import"./@reduxjs-UCSEaN3g.js";import"./redux-C5Huw2aR.js";import"./immer-DgfQkf_7.js";import"./redux-thunk-B3S1iNVp.js";import"./reselect-BSOs5pU1.js";import"./js-cookie-BXEMiIsG.js";import"./@radix-ui-BWjeGzol.js";import"./aria-hidden-BHUiN-rI.js";import"./react-remove-scroll-yauc81_r.js";import"./tslib-Bc9CN1Ef.js";import"./react-remove-scroll-bar-BcxDecei.js";import"./react-style-singleton-C1QVuB2c.js";import"./get-nonce-BYiZHLe3.js";import"./use-sidecar-BA4C4RS7.js";import"./use-callback-ref-Cvx1xcTX.js";import"./@floating-ui-BSChQBl3.js";import"./class-variance-authority-DeOWI0hf.js";import"./clsx-BeLtu-UY.js";import"./tailwind-merge-D2VJQb_v.js";import"./lucide-D6BDVLHE.js";import"./axios-BoylL8Pu.js";import"./@syncfusion-CXokIO9o.js";import"./cookie-BUTH-fPQ.js";const D=()=>s.jsx("div",{className:"flex items-center justify-center p-4",children:s.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-gray-900"})}),F=[{label:"Dashboard",href:"/dashboard"},{label:"Supplier Table",href:"/supplier-table"},{label:"Edit Supplier Form",href:null}];function L(){const L=E(),{id:U}=k(),{data:V,isLoading:_}=a(U),[A]=i(),[B,I]=e.useState(!1),[O,P]=e.useState(null),[R,M]=e.useState(null),[T,J]=e.useState([]),[Q,W]=e.useState([]),[X,Z]=e.useState(!0),$=r({defaultValues:{name:"",mobile:"",email:"",website:"",contact_person:"",address:"",country:"",city:"",description:"",image:null}});e.useEffect((()=>{(async()=>{Z(!0);const e=w.getAllCountries();J(e),Z(!1)})()}),[]);const q=e.useCallback((e=>{Z(!0);const s=S.getCitiesOfCountry(e)||[];W(s),$.setValue("city",""),Z(!1)}),[$]);e.useEffect((()=>{if(V&&($.reset({name:V.name||"",mobile:V.mobile||"",email:V.email||"",website:V.website||"",contact_person:V.contact_person||"",address:V.address||"",country:V.country||"",city:V.city||"",description:V.description||""}),V.image&&M(`/api/image/download/${V.image}`),V.country)){const e=T.find((e=>e.name===V.country));e&&q(e.isoCode)}}),[V,$,T]);const z=e=>{const s=e.target.files[0];s&&M(URL.createObjectURL(s)),$.setValue("image",e.target.files)};return e.useMemo((()=>w.getAllCountries()),[]),_||X?s.jsx("div",{className:"flex items-center justify-center min-h-screen",children:s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-gray-900"})}):s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"ml-1",children:s.jsx(b,{items:F})}),s.jsxs(o,{className:"max-w-8xl mt-3 mx-auto",children:[s.jsx(c,{children:s.jsx(d,{className:"text-xl font-semibold",children:"Update Supplier"})}),s.jsxs(m,{children:[O&&s.jsx("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4",children:O}),s.jsx(j,{...$,children:s.jsxs("form",{onSubmit:$.handleSubmit((async function(e){var s;if(U){I(!0),P(null);try{let s={...e};if(delete s.image,e.image&&e.image[0]){const r=new FormData;Object.keys(s).forEach((e=>{r.append(e,s[e])})),r.append("image",e.image[0]),await A({updatedSupplier:r,id:U}).unwrap()}else await A({updatedSupplier:s,id:U}).unwrap();L("/supplier-table")}catch(r){P((null==(s=r.data)?void 0:s.message)||"Failed to update supplier. Please try again.")}finally{I(!1)}}else P("No supplier ID found")})),className:"space-y-6",children:[s.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[s.jsx(x,{control:$.control,name:"name",render:({field:e})=>s.jsxs(p,{children:[s.jsxs(h,{children:["Supplier Name ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx(u,{children:s.jsx(l,{placeholder:"Enter supplier name",...e})}),s.jsx(f,{})]})}),s.jsx(x,{control:$.control,name:"contact_person",render:({field:e})=>s.jsxs(p,{children:[s.jsx(h,{children:"Contact Person"}),s.jsx(u,{children:s.jsx(l,{placeholder:"Enter contact person",...e})}),s.jsx(f,{})]})}),s.jsx(x,{control:$.control,name:"email",render:({field:e})=>s.jsxs(p,{children:[s.jsxs(h,{children:["Email ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx(u,{children:s.jsx(l,{placeholder:"Enter email address",...e})}),s.jsx(f,{})]})}),s.jsx(x,{control:$.control,name:"website",render:({field:e})=>s.jsxs(p,{children:[s.jsx(h,{children:"Website"}),s.jsx(u,{children:s.jsx(l,{placeholder:"Enter website URL",...e})}),s.jsx(f,{})]})}),s.jsx(x,{control:$.control,name:"mobile",render:({field:e})=>s.jsxs(p,{children:[s.jsxs(h,{children:["Mobile Number ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx(u,{children:s.jsx(l,{placeholder:"Enter mobile number",...e})}),s.jsx(f,{})]})})]}),s.jsx(x,{control:$.control,name:"address",render:({field:e})=>s.jsxs(p,{children:[s.jsx(h,{children:"Address"}),s.jsx(u,{children:s.jsx(n,{placeholder:"Enter address",...e})}),s.jsx(f,{})]})}),s.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[s.jsx(x,{control:$.control,name:"country",render:({field:r})=>{var a;return s.jsxs(p,{children:[s.jsx(h,{children:"Country"}),s.jsxs(g,{onValueChange:e=>{const s=T.find((s=>s.isoCode===e));r.onChange(s.name),q(e)},value:(null==(a=T.find((e=>e.name===r.value)))?void 0:a.isoCode)||"",children:[s.jsx(u,{children:s.jsx(y,{children:s.jsx(v,{placeholder:"Select country"})})}),s.jsx(e.Suspense,{fallback:s.jsx(D,{}),children:s.jsx(C,{children:T.map((e=>s.jsx(N,{value:e.isoCode,children:e.name},e.isoCode)))})})]}),s.jsx(f,{})]})}}),s.jsx(x,{control:$.control,name:"city",render:({field:e})=>s.jsxs(p,{children:[s.jsx(h,{children:"City"}),s.jsxs(g,{onValueChange:e.onChange,value:e.value||"",disabled:!$.watch("country"),children:[s.jsx(u,{children:s.jsx(y,{children:s.jsx(v,{placeholder:"Select city"})})}),s.jsx(C,{children:Q.map((e=>s.jsx(N,{value:e.name,children:e.name},e.name)))})]}),s.jsx(f,{})]})})]}),s.jsx(x,{control:$.control,name:"description",render:({field:e})=>s.jsxs(p,{children:[s.jsx(h,{children:"Description"}),s.jsx(u,{children:s.jsx(n,{placeholder:"Enter description",...e})}),s.jsx(f,{})]})}),s.jsx(x,{control:$.control,name:"image",render:({field:e})=>s.jsxs(p,{children:[s.jsx(h,{children:"Upload Image"}),s.jsx(u,{children:s.jsx(l,{type:"file",onChange:z,accept:"image/*"})}),s.jsx(f,{}),R&&s.jsx("div",{className:"mt-4",children:s.jsx("img",{src:R,alt:"Preview",className:"h-32 w-32 object-cover border"})})]})}),s.jsx("div",{className:"flex gap-4",children:s.jsx(t,{type:"submit",className:"bg-green-500 hover:bg-green-600",disabled:B,children:B?"Saving...":"Save Changes"})})]})})]})]})]})}export{L as default};
