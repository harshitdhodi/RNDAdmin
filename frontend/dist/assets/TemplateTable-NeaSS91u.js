import{a as c,j as e}from"./react-DKICu8bO.js";import{g as j,$ as g,B as o}from"./index-CDFtkn6X.js";import{a as f,L as N}from"./react-router-B9QVkYva.js";import"./classnames-Bv6oJzD9.js";import"./react-dom-BBS6HuAW.js";import"./scheduler-CKyTKYc2.js";import"./react-redux-BrRfTdeB.js";import"./use-sync-external-store-D0ivhzzy.js";import"./@reduxjs-B5J9SSA5.js";import"./redux-DITMfSWq.js";import"./immer-fBqQtvEc.js";import"./redux-thunk-ClJT1hhx.js";import"./reselect-C27TLnWV.js";import"./js-cookie-Cz0CWeBA.js";import"./@radix-ui-BlrBCj0C.js";import"./aria-hidden-DQ5UC2Eg.js";import"./react-remove-scroll-fXbmorz6.js";import"./tslib-CDuPK5Eb.js";import"./react-remove-scroll-bar-C9fmXXva.js";import"./react-style-singleton-DKBZmuKg.js";import"./get-nonce-C-Z93AgS.js";import"./use-sidecar-C10EJNOT.js";import"./use-callback-ref-BoKxM4XI.js";import"./@floating-ui-8J-daYO3.js";import"./class-variance-authority-Dp3B9jqt.js";import"./clsx-B-dksMZM.js";import"./tailwind-merge-D696Ktp4.js";import"./lucide-D7hRWJEP.js";import"./axios-DXsv3KKR.js";import"./@syncfusion-BIAkhmGL.js";import"./cookie--_YQFYBD.js";const Z=()=>{const{data:s,error:i,isLoading:d}=j(),[m]=g(),p=f(),a=c.useMemo(()=>{if(!s)return[];if(Array.isArray(s))return s;if(s.data&&Array.isArray(s.data))return s.data;for(const r in s)if(Array.isArray(s[r]))return s[r];return console.warn("Unexpected API response format:",s),[]},[s]);console.log("Processed templates:",a);const[n,x]=c.useState({}),h=r=>{x(t=>({...t,[r]:!t[r]}))},y=(r,t=100)=>{if(!r)return"";const l=r.replace(/<[^>]+>/g,"");return l.length<=t?r:l.substring(0,t)+"..."};if(d)return e.jsx("p",{children:"Loading templates..."});if(i)return e.jsxs("p",{children:["Error loading templates: ",i.message]});if(!a.length)return e.jsx("p",{children:"No templates found."});const u=r=>{p(`/edit-template/${r}`)},b=async r=>{if(window.confirm("Are you sure you want to delete this template?"))try{await m(r).unwrap(),alert("Template deleted successfully!")}catch(t){alert("Failed to delete template: "+(t.message||"Unknown error"))}};return e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h1",{className:"text-xl font-bold",children:"Email Templates"}),e.jsx(N,{to:"/add-template",children:e.jsx(o,{className:"bg-[#3b1f91] text-white hover:bg-purple-700",variant:"primary",children:"Add Template"})})]}),e.jsx("hr",{className:"mb-5"}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full border-collapse border border-gray-300",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray-200",children:[e.jsx("th",{className:"border border-gray-300 px-4 py-2",children:"Name"}),e.jsx("th",{className:"border border-gray-300 px-4 py-2",children:"Subject"}),e.jsx("th",{className:"border border-gray-300 px-4 py-2",children:"Body"}),e.jsx("th",{className:"border border-gray-300 px-4 py-2",children:"Actions"})]})}),e.jsx("tbody",{children:a.map(r=>e.jsxs("tr",{className:"hover:bg-gray-100",children:[e.jsx("td",{className:"border border-gray-300 px-4 py-2",children:r.name||"Unnamed Template"}),e.jsx("td",{className:"border border-gray-300 px-4 py-2",children:r.subject||"No Subject"}),e.jsxs("td",{className:"border border-gray-300 px-4 py-2",children:[e.jsx("div",{dangerouslySetInnerHTML:{__html:n[r._id]?r.body:y(r.body)}}),r.body&&r.body.length>100&&e.jsx(o,{variant:"link",className:"text-[#3b1f91] p-0 h-auto font-medium",onClick:()=>h(r._id),children:n[r._id]?"Show Less":"Read More"})]}),e.jsx("td",{className:"border border-gray-300 px-4 py-2",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx(o,{variant:"secondary",className:"hover:bg-[#4f359c]",size:"sm",onClick:()=>u(r._id),children:"Edit"}),e.jsx(o,{variant:"destructive",size:"sm",onClick:()=>b(r._id),children:"Delete"})]})})]},r._id))})]})}),a.length===0&&!d&&e.jsx("div",{className:"text-center py-4",children:e.jsx("p",{children:'No templates found. Create your first template by clicking "Add Template".'})})]})};export{Z as default};
