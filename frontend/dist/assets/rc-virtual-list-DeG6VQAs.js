import{e,b as t,g as n,c as r,d as o,_ as i,a as u,k as a}from"./@babel-BfC2A0EA.js";import{c}from"./classnames-C3ovBj6j.js";import{R as l}from"./rc-resize-observer-pLBfxqzk.js";import{x as s,P as f,u as v,d}from"./rc-util-CQtTJgfq.js";import{r as h}from"./react-BfBsRgn0.js";import{r as m}from"./react-dom-DwrudmHt.js";var g=h.forwardRef((function(r,o){var i=r.height,u=r.offsetY,a=r.offsetX,s=r.children,f=r.prefixCls,v=r.onInnerResize,d=r.innerProps,m=r.rtl,g=r.extra,p={},E={display:"flex",flexDirection:"column"};return void 0!==u&&(p={height:i,position:"relative",overflow:"hidden"},E=e(e({},E),{},t(t(t(t(t({transform:"translateY(".concat(u,"px)")},m?"marginRight":"marginLeft",-a),"position","absolute"),"left",0),"right",0),"top",0))),h.createElement("div",{style:p},h.createElement(l,{onResize:function(e){e.offsetHeight&&v&&v()}},h.createElement("div",n({style:E,className:c(t({},"".concat(f,"-holder-inner"),f)),ref:o},d),s,g)))}));function p(e){var t=e.children,n=e.setRef,r=h.useCallback((function(e){n(e)}),[]);return h.cloneElement(t,{ref:r})}function E(e,t,n){var o=h.useState(e),i=r(o,2),u=i[0],a=i[1],c=h.useState(null),l=r(c,2),s=l[0],f=l[1];return h.useEffect((function(){var n=function(e,t,n){var r,o,i=e.length,u=t.length;if(0===i&&0===u)return null;i<u?(r=e,o=t):(r=t,o=e);var a={__EMPTY_ITEM__:!0};function c(e){return void 0!==e?n(e):a}for(var l=null,s=1!==Math.abs(i-u),f=0;f<o.length;f+=1){var v=c(r[f]);if(v!==c(o[f])){l=f,s=s||v!==c(o[f+1]);break}}return null===l?null:{index:l,multiple:s}}(u||[],e||[],t);void 0!==(null==n?void 0:n.index)&&f(e[n.index]),a(e)}),[e]),[s]}g.displayName="Filler";var M="object"===("undefined"==typeof navigator?"undefined":o(navigator))&&/Firefox/i.test(navigator.userAgent);const w=function(e,t,n,r){var o=h.useRef(!1),i=h.useRef(null);var u=h.useRef({top:e,bottom:t,left:n,right:r});return u.current.top=e,u.current.bottom=t,u.current.left=n,u.current.right=r,function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=e?t<0&&u.current.left||t>0&&u.current.right:t<0&&u.current.top||t>0&&u.current.bottom;return n&&r?(clearTimeout(i.current),o.current=!1):r&&!o.current||(clearTimeout(i.current),o.current=!0,i.current=setTimeout((function(){o.current=!1}),50)),!o.current&&r}};function b(e,t,n,r,o,i,u){var a=h.useRef(0),c=h.useRef(null),l=h.useRef(null),f=h.useRef(!1),v=w(t,n,r,o);var d=h.useRef(null),m=h.useRef(null);return[function(t){if(e){s.cancel(m.current),m.current=s((function(){d.current=null}),2);var n=t.deltaX,r=t.deltaY,o=t.shiftKey,h=n,g=r;("sx"===d.current||!d.current&&o&&r&&!n)&&(h=r,g=0,d.current="sx");var p=Math.abs(h),E=Math.abs(g);null===d.current&&(d.current=i&&p>E?"x":"y"),"y"===d.current?function(e,t){if(s.cancel(c.current),!v(!1,t)){var n=e;n._virtualHandled||(n._virtualHandled=!0,a.current+=t,l.current=t,M||n.preventDefault(),c.current=s((function(){var e=f.current?10:1;u(a.current*e,!1),a.current=0})))}}(t,g):function(e,t){u(t,!0),M||e.preventDefault()}(t,h)}},function(t){e&&(f.current=t.detail===l.current)}]}var R=function(){function e(){u(this,e),t(this,"maps",void 0),t(this,"id",0),this.maps=Object.create(null)}return i(e,[{key:"set",value:function(e,t){this.maps[e]=t,this.id+=1}},{key:"get",value:function(e){return this.maps[e]}}]),e}();function S(e){var t=parseFloat(e);return isNaN(t)?0:t}var y=14/15;function x(e){return Math.floor(Math.pow(e,.5))}function L(e,t){return("touches"in e?e.touches[0]:e)[t?"pageX":"pageY"]-window[t?"scrollX":"scrollY"]}var H=h.forwardRef((function(n,o){var i=n.prefixCls,u=n.rtl,a=n.scrollOffset,l=n.scrollRange,f=n.onStartMove,v=n.onStopMove,d=n.onScroll,m=n.horizontal,g=n.spinSize,p=n.containerSize,E=n.style,M=n.thumbStyle,w=h.useState(!1),b=r(w,2),R=b[0],S=b[1],y=h.useState(null),x=r(y,2),H=x[0],T=x[1],z=h.useState(null),D=r(z,2),N=D[0],Y=D[1],k=!u,C=h.useRef(),_=h.useRef(),j=h.useState(!1),I=r(j,2),P=I[0],X=I[1],B=h.useRef(),O=function(){clearTimeout(B.current),X(!0),B.current=setTimeout((function(){X(!1)}),3e3)},A=l-p||0,K=p-g||0,V=h.useMemo((function(){return 0===a||0===A?0:a/A*K}),[a,A,K]),W=h.useRef({top:V,dragging:R,pageY:H,startTop:N});W.current={top:V,dragging:R,pageY:H,startTop:N};var F=function(e){S(!0),T(L(e,m)),Y(W.current.top),f(),e.stopPropagation(),e.preventDefault()};h.useEffect((function(){var e=function(e){e.preventDefault()},t=C.current,n=_.current;return t.addEventListener("touchstart",e,{passive:!1}),n.addEventListener("touchstart",F,{passive:!1}),function(){t.removeEventListener("touchstart",e),n.removeEventListener("touchstart",F)}}),[]);var q=h.useRef();q.current=A;var G=h.useRef();G.current=K,h.useEffect((function(){if(R){var e,t=function(t){var n=W.current,r=n.dragging,o=n.pageY,i=n.startTop;s.cancel(e);var u=C.current.getBoundingClientRect(),a=p/(m?u.width:u.height);if(r){var c=(L(t,m)-o)*a,l=i;!k&&m?l-=c:l+=c;var f=q.current,v=G.current,h=v?l/v:0,g=Math.ceil(h*f);g=Math.max(g,0),g=Math.min(g,f),e=s((function(){d(g,m)}))}},n=function(){S(!1),v()};return window.addEventListener("mousemove",t,{passive:!0}),window.addEventListener("touchmove",t,{passive:!0}),window.addEventListener("mouseup",n,{passive:!0}),window.addEventListener("touchend",n,{passive:!0}),function(){window.removeEventListener("mousemove",t),window.removeEventListener("touchmove",t),window.removeEventListener("mouseup",n),window.removeEventListener("touchend",n),s.cancel(e)}}}),[R]),h.useEffect((function(){return O(),function(){clearTimeout(B.current)}}),[a]),h.useImperativeHandle(o,(function(){return{delayHidden:O}}));var J="".concat(i,"-scrollbar"),Q={position:"absolute",visibility:P?null:"hidden"},U={position:"absolute",background:"rgba(0, 0, 0, 0.5)",borderRadius:99,cursor:"pointer",userSelect:"none"};return m?(Q.height=8,Q.left=0,Q.right=0,Q.bottom=0,U.height="100%",U.width=g,k?U.left=V:U.right=V):(Q.width=8,Q.top=0,Q.bottom=0,k?Q.right=0:Q.left=0,U.width="100%",U.height=g,U.top=V),h.createElement("div",{ref:C,className:c(J,t(t(t({},"".concat(J,"-horizontal"),m),"".concat(J,"-vertical"),!m),"".concat(J,"-visible"),P)),style:e(e({},Q),E),onMouseDown:function(e){e.stopPropagation(),e.preventDefault()},onMouseMove:O},h.createElement("div",{ref:_,className:c("".concat(J,"-thumb"),t({},"".concat(J,"-thumb-moving"),R)),style:e(e({},U),M),onMouseDown:F}))}));function T(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=e/(arguments.length>1&&void 0!==arguments[1]?arguments[1]:0)*e;return isNaN(t)&&(t=0),t=Math.max(t,20),Math.floor(t)}var z=["prefixCls","className","height","itemHeight","fullHeight","style","data","children","itemKey","virtual","direction","scrollWidth","component","onScroll","onVirtualScroll","onVisibleChange","innerProps","extraRender","styles"],D=[],N={overflowY:"auto",overflowAnchor:"none"};function Y(i,u){var M=i.prefixCls,Y=void 0===M?"rc-virtual-list":M,k=i.className,C=i.height,_=i.itemHeight,j=i.fullHeight,I=void 0===j||j,P=i.style,X=i.data,B=i.children,O=i.itemKey,A=i.virtual,K=i.direction,V=i.scrollWidth,W=i.component,F=void 0===W?"div":W,q=i.onScroll,G=i.onVirtualScroll,J=i.onVisibleChange,Q=i.innerProps,U=i.extraRender,Z=i.styles,$=a(i,z),ee=h.useCallback((function(e){return"function"==typeof O?O(e):null==e?void 0:e[O]}),[O]),te=function(e){var t=h.useState(0),n=r(t,2),o=n[0],i=n[1],u=h.useRef(new Map),a=h.useRef(new R),c=h.useRef();function l(){s.cancel(c.current)}function v(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];l();var t=function(){u.current.forEach((function(e,t){if(e&&e.offsetParent){var n=f(e),r=n.offsetHeight,o=getComputedStyle(n),i=o.marginTop,u=o.marginBottom,c=r+S(i)+S(u);a.current.get(t)!==c&&a.current.set(t,c)}})),i((function(e){return e+1}))};e?t():c.current=s(t)}return h.useEffect((function(){return l}),[]),[function(t,n){var r=e(t);u.current.get(r),n?(u.current.set(r,n),v()):u.current.delete(r)},v,a.current,o]}(ee),ne=r(te,4),re=ne[0],oe=ne[1],ie=ne[2],ue=ne[3],ae=!(!1===A||!C||!_),ce=h.useMemo((function(){return Object.values(ie.maps).reduce((function(e,t){return e+t}),0)}),[ie.id,ie.maps]),le=ae&&X&&(Math.max(_*X.length,ce)>C||!!V),se="rtl"===K,fe=c(Y,t({},"".concat(Y,"-rtl"),se),k),ve=X||D,de=h.useRef(),he=h.useRef(),me=h.useRef(),ge=h.useState(0),pe=r(ge,2),Ee=pe[0],Me=pe[1],we=h.useState(0),be=r(we,2),Re=be[0],Se=be[1],ye=h.useState(!1),xe=r(ye,2),Le=xe[0],He=xe[1],Te=function(){He(!0)},ze=function(){He(!1)},De={getKey:ee};function Ne(e){Me((function(t){var n=function(e){var t=e;Number.isNaN(Qe.current)||(t=Math.min(t,Qe.current));return t=Math.max(t,0),t}("function"==typeof e?e(t):e);return de.current.scrollTop=n,n}))}var Ye=h.useRef({start:0,end:ve.length}),ke=h.useRef(),Ce=E(ve,ee),_e=r(Ce,1)[0];ke.current=_e;var je=h.useMemo((function(){if(!ae)return{scrollHeight:void 0,start:0,end:ve.length-1,offset:void 0};var e;if(!le)return{scrollHeight:(null===(e=he.current)||void 0===e?void 0:e.offsetHeight)||0,start:0,end:ve.length-1,offset:void 0};for(var t,n,r,o=0,i=ve.length,u=0;u<i;u+=1){var a=ve[u],c=ee(a),l=ie.get(c),s=o+(void 0===l?_:l);s>=Ee&&void 0===t&&(t=u,n=o),s>Ee+C&&void 0===r&&(r=u),o=s}return void 0===t&&(t=0,n=0,r=Math.ceil(C/_)),void 0===r&&(r=ve.length-1),{scrollHeight:o,start:t,end:r=Math.min(r+1,ve.length-1),offset:n}}),[le,ae,Ee,ve,ue,C]),Ie=je.scrollHeight,Pe=je.start,Xe=je.end,Be=je.offset;Ye.current.start=Pe,Ye.current.end=Xe;var Oe=h.useState({width:0,height:C}),Ae=r(Oe,2),Ke=Ae[0],Ve=Ae[1],We=h.useRef(),Fe=h.useRef(),qe=h.useMemo((function(){return T(Ke.width,V)}),[Ke.width,V]),Ge=h.useMemo((function(){return T(Ke.height,Ie)}),[Ke.height,Ie]),Je=Ie-C,Qe=h.useRef(Je);Qe.current=Je;var Ue=Ee<=0,Ze=Ee>=Je,$e=Re<=0,et=Re>=V,tt=w(Ue,Ze,$e,et),nt=function(){return{x:se?-Re:Re,y:Ee}},rt=h.useRef(nt()),ot=d((function(t){if(G){var n=e(e({},nt()),t);rt.current.x===n.x&&rt.current.y===n.y||(G(n),rt.current=n)}}));function it(e,t){var n=e;t?(m.flushSync((function(){Se(n)})),ot()):Ne(n)}var ut=function(e){var t=e,n=V?V-Ke.width:0;return t=Math.max(t,0),t=Math.min(t,n)},at=d((function(e,t){t?(m.flushSync((function(){Se((function(t){return ut(t+(se?-e:e))}))})),ot()):Ne((function(t){return t+e}))})),ct=b(ae,Ue,Ze,$e,et,!!V,at),lt=r(ct,2),st=lt[0],ft=lt[1];!function(e,t,n){var r,o=h.useRef(!1),i=h.useRef(0),u=h.useRef(0),a=h.useRef(null),c=h.useRef(null),l=function(e){if(o.current){var t=Math.ceil(e.touches[0].pageX),r=Math.ceil(e.touches[0].pageY),a=i.current-t,l=u.current-r,s=Math.abs(a)>Math.abs(l);s?i.current=t:u.current=r;var f=n(s,s?a:l,!1,e);f&&e.preventDefault(),clearInterval(c.current),f&&(c.current=setInterval((function(){s?a*=y:l*=y;var e=Math.floor(s?a:l);(!n(s,e,!0)||Math.abs(e)<=.1)&&clearInterval(c.current)}),16))}},s=function(){o.current=!1,r()},f=function(e){r(),1!==e.touches.length||o.current||(o.current=!0,i.current=Math.ceil(e.touches[0].pageX),u.current=Math.ceil(e.touches[0].pageY),a.current=e.target,a.current.addEventListener("touchmove",l,{passive:!1}),a.current.addEventListener("touchend",s,{passive:!0}))};r=function(){a.current&&(a.current.removeEventListener("touchmove",l),a.current.removeEventListener("touchend",s))},v((function(){return e&&t.current.addEventListener("touchstart",f,{passive:!0}),function(){var e;null===(e=t.current)||void 0===e||e.removeEventListener("touchstart",f),r(),clearInterval(c.current)}}),[e])}(ae,de,(function(e,t,n,r){var o=r;return!tt(e,t,n)&&((!o||!o._virtualHandled)&&(o&&(o._virtualHandled=!0),st({preventDefault:function(){},deltaX:e?t:0,deltaY:e?0:t}),!0))})),function(e,t,n){h.useEffect((function(){var r=t.current;if(e&&r){var o,i,u=!1,a=function(){s.cancel(o)},c=function e(){a(),o=s((function(){n(i),e()}))},l=function(e){var t=e;t._virtualHandled||(t._virtualHandled=!0,u=!0)},f=function(){u=!1,a()},v=function(e){if(u){var t=L(e,!1),n=r.getBoundingClientRect(),o=n.top,l=n.bottom;t<=o?(i=-x(o-t),c()):t>=l?(i=x(t-l),c()):a()}};return r.addEventListener("mousedown",l),r.ownerDocument.addEventListener("mouseup",f),r.ownerDocument.addEventListener("mousemove",v),function(){r.removeEventListener("mousedown",l),r.ownerDocument.removeEventListener("mouseup",f),r.ownerDocument.removeEventListener("mousemove",v),a()}}}),[e])}(le,de,(function(e){Ne((function(t){return t+e}))})),v((function(){function e(e){var t=Ue&&e.detail<0,n=Ze&&e.detail>0;!ae||t||n||e.preventDefault()}var t=de.current;return t.addEventListener("wheel",st,{passive:!1}),t.addEventListener("DOMMouseScroll",ft,{passive:!0}),t.addEventListener("MozMousePixelScroll",e,{passive:!1}),function(){t.removeEventListener("wheel",st),t.removeEventListener("DOMMouseScroll",ft),t.removeEventListener("MozMousePixelScroll",e)}}),[ae,Ue,Ze]),v((function(){if(V){var e=ut(Re);Se(e),ot({x:e})}}),[Ke.width,V]);var vt=function(){var e,t;null===(e=We.current)||void 0===e||e.delayHidden(),null===(t=Fe.current)||void 0===t||t.delayHidden()},dt=function(t,n,i,u,a,c,l,f){var d=h.useRef(),m=h.useState(null),g=r(m,2),p=g[0],E=g[1];return v((function(){if(p&&p.times<10){if(!t.current)return void E((function(t){return e({},t)}));c();var r=p.targetAlign,o=p.originAlign,s=p.index,f=p.offset,v=t.current.clientHeight,d=!1,h=r,m=null;if(v){for(var g=r||o,M=0,w=0,b=0,R=Math.min(n.length-1,s),S=0;S<=R;S+=1){var y=a(n[S]);w=M;var x=i.get(y);M=b=w+(void 0===x?u:x)}for(var L="top"===g?f:v-f,H=R;H>=0;H-=1){var T=a(n[H]),z=i.get(T);if(void 0===z){d=!0;break}if((L-=z)<=0)break}switch(g){case"top":m=w-f;break;case"bottom":m=b-v+f;break;default:var D=t.current.scrollTop;w<D?h="top":b>D+v&&(h="bottom")}null!==m&&l(m),m!==p.lastTop&&(d=!0)}d&&E(e(e({},p),{},{times:p.times+1,targetAlign:h,lastTop:m}))}}),[p,t.current]),function(e){if(null!=e){if(s.cancel(d.current),"number"==typeof e)l(e);else if(e&&"object"===o(e)){var t,r=e.align;t="index"in e?e.index:n.findIndex((function(t){return a(t)===e.key}));var i=e.offset;E({times:0,index:t,offset:void 0===i?0:i,originAlign:r})}}else f()}}(de,ve,ie,_,ee,(function(){return oe(!0)}),Ne,vt);h.useImperativeHandle(u,(function(){return{nativeElement:me.current,getScrollInfo:nt,scrollTo:function(e){var t;(t=e)&&"object"===o(t)&&("left"in t||"top"in t)?(void 0!==e.left&&Se(ut(e.left)),dt(e.top)):dt(e)}}})),v((function(){if(J){var e=ve.slice(Pe,Xe+1);J(e,ve)}}),[Pe,Xe,ve]);var ht=function(e,t,n,o){var i=h.useMemo((function(){return[new Map,[]]}),[e,n.id,o]),u=r(i,2),a=u[0],c=u[1];return function(r){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:r,u=a.get(r),l=a.get(i);if(void 0===u||void 0===l)for(var s=e.length,f=c.length;f<s;f+=1){var v,d=e[f],h=t(d);a.set(h,f);var m=null!==(v=n.get(h))&&void 0!==v?v:o;if(c[f]=(c[f-1]||0)+m,h===r&&(u=f),h===i&&(l=f),void 0!==u&&void 0!==l)break}return{top:c[u-1]||0,bottom:c[l]}}}(ve,ee,ie,_),mt=null==U?void 0:U({start:Pe,end:Xe,virtual:le,offsetX:Re,offsetY:Be,rtl:se,getSize:ht}),gt=function(e,t,n,r,o,i,u,a){var c=a.getKey;return e.slice(t,n+1).map((function(e,n){var a=u(e,t+n,{style:{width:r},offsetX:o}),l=c(e);return h.createElement(p,{key:l,setRef:function(t){return i(e,t)}},a)}))}(ve,Pe,Xe,V,Re,re,B,De),pt=null;C&&(pt=e(t({},I?"height":"maxHeight",C),N),ae&&(pt.overflowY="hidden",V&&(pt.overflowX="hidden"),Le&&(pt.pointerEvents="none")));var Et={};return se&&(Et.dir="rtl"),h.createElement("div",n({ref:me,style:e(e({},P),{},{position:"relative"}),className:fe},Et,$),h.createElement(l,{onResize:function(e){Ve({width:e.offsetWidth,height:e.offsetHeight})}},h.createElement(F,{className:"".concat(Y,"-holder"),style:pt,ref:de,onScroll:function(e){var t=e.currentTarget.scrollTop;t!==Ee&&Ne(t),null==q||q(e),ot()},onMouseEnter:vt},h.createElement(g,{prefixCls:Y,height:Ie,offsetX:Re,offsetY:Be,scrollWidth:V,onInnerResize:oe,ref:he,innerProps:Q,rtl:se,extra:mt},gt))),le&&Ie>C&&h.createElement(H,{ref:We,prefixCls:Y,scrollOffset:Ee,scrollRange:Ie,rtl:se,onScroll:it,onStartMove:Te,onStopMove:ze,spinSize:Ge,containerSize:Ke.height,style:null==Z?void 0:Z.verticalScrollBar,thumbStyle:null==Z?void 0:Z.verticalScrollBarThumb}),le&&V>Ke.width&&h.createElement(H,{ref:Fe,prefixCls:Y,scrollOffset:Re,scrollRange:V,rtl:se,onScroll:it,onStartMove:Te,onStopMove:ze,spinSize:qe,containerSize:Ke.width,horizontal:!0,style:null==Z?void 0:Z.horizontalScrollBar,thumbStyle:null==Z?void 0:Z.horizontalScrollBarThumb}))}var k=h.forwardRef(Y);k.displayName="List";export{k as L};
